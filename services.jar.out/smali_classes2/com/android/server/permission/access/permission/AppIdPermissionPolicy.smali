.class public final Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
.super Lcom/android/server/permission/access/SchemePolicy;
.source "AppIdPermissionPolicy.kt"


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$Companion;,
        Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;
    }
.end annotation

.annotation system Ldalvik/annotation/SourceDebugExtension;
    value = "SMAP\nAppIdPermissionPolicy.kt\nKotlin\n*S Kotlin\n*F\n+ 1 AppIdPermissionPolicy.kt\ncom/android/server/permission/access/permission/AppIdPermissionPolicy\n+ 2 IndexedListSetExtensions.kt\ncom/android/server/permission/access/immutable/IndexedListSetExtensionsKt\n+ 3 _Maps.kt\nkotlin/collections/MapsKt___MapsKt\n+ 4 IntReferenceMapExtensions.kt\ncom/android/server/permission/access/immutable/IntReferenceMapExtensionsKt\n+ 5 ListExtensions.kt\ncom/android/server/permission/access/collection/ListExtensionsKt\n+ 6 IndexedSetExtensions.kt\ncom/android/server/permission/access/immutable/IndexedSetExtensionsKt\n+ 7 IntSetExtensions.kt\ncom/android/server/permission/access/immutable/IntSetExtensionsKt\n+ 8 _Collections.kt\nkotlin/collections/CollectionsKt___CollectionsKt\n+ 9 Permission.kt\ncom/android/server/permission/access/permission/Permission\n+ 10 IndexedMapExtensions.kt\ncom/android/server/permission/access/immutable/IndexedMapExtensionsKt\n+ 11 SparseArrayExtensions.kt\ncom/android/server/permission/access/collection/SparseArrayExtensionsKt\n+ 12 PermissionInfoExtensions.kt\ncom/android/server/permission/access/util/PermissionInfoExtensionsKt\n+ 13 IndexedListExtensions.kt\ncom/android/server/permission/access/immutable/IndexedListExtensionsKt\n+ 14 fake.kt\nkotlin/jvm/internal/FakeKt\n*L\n1#1,1882:1\n1440#1,7:1937\n1447#1,2:1955\n1467#1,8:1963\n1475#1,5:1975\n1440#1,7:1982\n1447#1,2:2000\n1440#1,7:2008\n1447#1,2:2026\n1452#1,7:2166\n1459#1,5:2175\n1464#1:2181\n1445#1,2:2190\n1447#1,2:2203\n1473#1,2:2207\n1475#1,5:2213\n1473#1,2:2220\n1475#1,5:2226\n1445#1,2:2233\n1447#1,2:2246\n1445#1,2:2250\n1447#1,2:2263\n1440#1,7:2279\n1447#1,2:2297\n1452#1,7:2475\n1459#1,5:2484\n1464#1:2490\n38#2,4:1883\n29#2,11:1944\n41#2:1957\n34#2:1958\n72#2,2:1971\n38#2,2:1973\n41#2:1980\n74#2:1981\n29#2,11:1989\n41#2:2002\n34#2:2003\n29#2,11:2015\n41#2:2028\n34#2:2029\n38#2,2:2173\n41#2:2180\n29#2,11:2192\n41#2:2205\n34#2:2206\n72#2,2:2209\n38#2,2:2211\n41#2:2218\n74#2:2219\n72#2,2:2222\n38#2,2:2224\n41#2:2231\n74#2:2232\n29#2,11:2235\n41#2:2248\n34#2:2249\n29#2,11:2252\n41#2:2265\n34#2:2266\n29#2,11:2286\n41#2:2299\n34#2:2300\n38#2,2:2309\n41#2:2313\n29#2,11:2422\n41#2:2435\n34#2:2436\n38#2,2:2482\n41#2:2489\n38#2,4:2495\n29#2,13:2508\n38#2,4:2521\n72#2,2:2525\n38#2,4:2527\n74#2:2531\n72#2,2:2532\n38#2,4:2534\n74#2:2538\n38#2,4:2606\n215#3,2:1887\n44#4,4:1889\n44#4,4:1893\n44#4,4:2064\n44#4,2:2077\n47#4:2080\n44#4,4:2155\n44#4,2:2182\n47#4:2189\n44#4,2:2267\n47#4:2274\n44#4,2:2277\n47#4:2301\n75#4,4:2601\n38#5,4:1897\n38#5,4:1905\n38#5,2:1909\n41#5:1915\n38#5,2:2031\n41#5:2039\n38#5,2:2050\n41#5:2054\n38#5,2:2055\n41#5:2099\n50#5:2104\n38#5,2:2105\n51#5,4:2107\n41#5:2111\n55#5:2112\n29#5,13:2113\n50#5:2131\n38#5,2:2132\n51#5,4:2134\n41#5:2138\n55#5:2139\n29#5,13:2140\n44#6,4:1901\n44#6,4:1916\n44#6,4:1924\n80#6,2:2036\n80#6,2:2097\n80#6,2:2160\n44#6,2:2491\n47#6:2499\n38#7,4:1911\n38#7,4:1920\n38#7,2:2062\n41#7:2068\n38#7,2:2075\n41#7:2081\n38#7,2:2153\n41#7:2159\n38#7,2:2275\n41#7:2302\n38#7,4:2303\n1855#8:1928\n1856#8:1959\n1855#8:2004\n1856#8:2030\n1855#8,2:2307\n141#9:1929\n132#9,7:1930\n33#9:1960\n132#9:1961\n138#9:1962\n57#9:2005\n48#9:2006\n135#9:2007\n36#9:2035\n36#9:2057\n33#9:2058\n36#9:2059\n36#9:2060\n36#9:2061\n39#9:2069\n57#9:2070\n48#9:2071\n51#9:2073\n48#9:2074\n39#9:2079\n36#9:2086\n45#9:2087\n60#9:2088\n48#9:2089\n90#9:2090\n63#9:2091\n147#9:2092\n57#9:2093\n48#9:2094\n39#9:2095\n39#9:2096\n36#9:2103\n36#9:2130\n42#9:2163\n33#9:2164\n36#9:2165\n54#9:2314\n48#9:2315\n66#9:2342\n63#9:2343\n60#9:2344\n48#9,4:2345\n105#9:2349\n63#9:2350\n60#9:2364\n48#9:2365\n66#9:2392\n63#9:2393\n78#9:2394\n63#9:2395\n114#9:2396\n63#9:2397\n57#9:2398\n48#9:2399\n117#9:2407\n63#9:2408\n57#9:2433\n48#9:2434\n141#9:2450\n132#9,7:2451\n132#9:2458\n138#9:2459\n45#9:2473\n33#9:2474\n57#9:2493\n48#9:2494\n36#9:2500\n36#9:2501\n33#9:2502\n33#9:2503\n33#9:2504\n36#9:2505\n33#9:2506\n33#9:2507\n105#9:2539\n63#9:2540\n96#9:2541\n63#9:2542\n33#9:2543\n99#9:2544\n63#9:2545\n84#9:2546\n63#9:2547\n129#9:2548\n63#9:2549\n102#9:2550\n63#9:2551\n90#9:2552\n63#9:2553\n147#9:2554\n120#9:2555\n63#9:2556\n123#9:2557\n63#9:2558\n75#9:2559\n63#9:2560\n81#9:2561\n63#9:2562\n69#9:2563\n63#9:2564\n72#9:2565\n63#9:2566\n108#9:2567\n63#9:2568\n93#9:2569\n63#9:2570\n33#9:2571\n105#9:2572\n63#9:2573\n126#9:2574\n63#9:2575\n96#9:2576\n63#9:2577\n33#9:2592\n33#9:2595\n33#9:2598\n47#10,2:2033\n50#10:2038\n126#10,2:2052\n126#10,2:2082\n126#10,2:2084\n53#10:2100\n65#10:2101\n54#10:2102\n56#10:2126\n53#10:2127\n65#10:2128\n54#10:2129\n56#10:2162\n53#10:2184\n65#10:2185\n54#10,3:2186\n53#10:2269\n65#10:2270\n54#10,3:2271\n38#10,13:2579\n126#10,2:2593\n126#10,2:2596\n101#10,2:2599\n22#11:2040\n40#11:2041\n100#11:2042\n41#11:2043\n23#11,4:2044\n43#11:2048\n27#11:2049\n25#12:2072\n84#13,2:2311\n29#13,13:2316\n29#13,13:2329\n29#13,13:2351\n29#13,13:2366\n29#13,13:2379\n72#13,2:2400\n38#13,4:2402\n74#13:2406\n29#13,13:2409\n29#13,13:2437\n29#13,13:2460\n1#14:2578\n1#14:2605\n*S KotlinDebug\n*F\n+ 1 AppIdPermissionPolicy.kt\ncom/android/server/permission/access/permission/AppIdPermissionPolicy\n*L\n191#1:1937,7\n191#1:1955,2\n235#1:1963,8\n235#1:1975,5\n246#1:1982,7\n246#1:2000,2\n289#1:2008,7\n289#1:2026,2\n689#1:2166,7\n689#1:2175,5\n689#1:2181\n711#1:2190,2\n711#1:2203,2\n723#1:2207,2\n723#1:2213,5\n729#1:2220,2\n729#1:2226,5\n743#1:2233,2\n743#1:2246,2\n747#1:2250,2\n747#1:2263,2\n791#1:2279,7\n791#1:2297,2\n1133#1:2475,7\n1133#1:2484,5\n1133#1:2490\n77#1:1883,4\n191#1:1944,11\n191#1:1957\n191#1:1958\n235#1:1971,2\n235#1:1973,2\n235#1:1980\n235#1:1981\n246#1:1989,11\n246#1:2002\n246#1:2003\n289#1:2015,11\n289#1:2028\n289#1:2029\n689#1:2173,2\n689#1:2180\n711#1:2192,11\n711#1:2205\n711#1:2206\n723#1:2209,2\n723#1:2211,2\n723#1:2218\n723#1:2219\n729#1:2222,2\n729#1:2224,2\n729#1:2231\n729#1:2232\n743#1:2235,11\n743#1:2248\n743#1:2249\n747#1:2252,11\n747#1:2265\n747#1:2266\n791#1:2286,11\n791#1:2299\n791#1:2300\n841#1:2309,2\n841#1:2313\n1000#1:2422,11\n1000#1:2435\n1000#1:2436\n1133#1:2482,2\n1133#1:2489\n1155#1:2495,4\n1446#1:2508,13\n1458#1:2521,4\n1474#1:2525,2\n1474#1:2527,4\n1474#1:2531\n1474#1:2532,2\n1474#1:2534,4\n1474#1:2538\n1769#1:2606,4\n81#1:1887,2\n87#1:1889,4\n93#1:1893,4\n517#1:2064,4\n531#1:2077,2\n531#1:2080\n661#1:2155,4\n699#1:2182,2\n699#1:2189\n757#1:2267,2\n757#1:2274\n789#1:2277,2\n789#1:2301\n1764#1:2601,4\n107#1:1897,4\n122#1:1905,4\n128#1:1909,2\n128#1:1915\n323#1:2031,2\n323#1:2039\n398#1:2050,2\n398#1:2054\n458#1:2055,2\n458#1:2099\n625#1:2104\n625#1:2105,2\n625#1:2107,4\n625#1:2111\n625#1:2112\n628#1:2113,13\n648#1:2131\n648#1:2132,2\n648#1:2134,4\n648#1:2138\n648#1:2139\n651#1:2140,13\n118#1:1901,4\n145#1:1916,4\n164#1:1924,4\n355#1:2036,2\n599#1:2097,2\n666#1:2160,2\n1137#1:2491,2\n1137#1:2499\n131#1:1911,4\n149#1:1920,4\n516#1:2062,2\n516#1:2068\n530#1:2075,2\n530#1:2081\n660#1:2153,2\n660#1:2159\n788#1:2275,2\n788#1:2302\n805#1:2303,4\n185#1:1928\n185#1:1959\n283#1:2004\n283#1:2030\n819#1:2307,2\n187#1:1929\n187#1:1930,7\n214#1:1960\n221#1:1961\n233#1:1962\n285#1:2005\n285#1:2006\n285#1:2007\n332#1:2035\n477#1:2057\n481#1:2058\n482#1:2059\n488#1:2060\n489#1:2061\n525#1:2069\n527#1:2070\n527#1:2071\n528#1:2073\n528#1:2074\n541#1:2079\n589#1:2086\n590#1:2087\n592#1:2088\n592#1:2089\n593#1:2090\n593#1:2091\n594#1:2092\n595#1:2093\n595#1:2094\n596#1:2095\n597#1:2096\n623#1:2103\n646#1:2130\n672#1:2163\n675#1:2164\n680#1:2165\n867#1:2314\n867#1:2315\n895#1:2342\n895#1:2343\n902#1:2344\n902#1:2345,4\n911#1:2349\n911#1:2350\n916#1:2364\n916#1:2365\n933#1:2392\n933#1:2393\n942#1:2394\n942#1:2395\n945#1:2396\n945#1:2397\n951#1:2398\n951#1:2399\n962#1:2407\n962#1:2408\n1006#1:2433\n1006#1:2434\n1078#1:2450\n1078#1:2451,7\n1098#1:2458\n1105#1:2459\n1123#1:2473\n1124#1:2474\n1142#1:2493\n1142#1:2494\n1218#1:2500\n1242#1:2501\n1253#1:2502\n1262#1:2503\n1266#1:2504\n1338#1:2505\n1342#1:2506\n1356#1:2507\n1491#1:2539\n1491#1:2540\n1491#1:2541\n1491#1:2542\n1500#1:2543\n1509#1:2544\n1509#1:2545\n1516#1:2546\n1516#1:2547\n1525#1:2548\n1525#1:2549\n1531#1:2550\n1531#1:2551\n1536#1:2552\n1536#1:2553\n1537#1:2554\n1544#1:2555\n1544#1:2556\n1551#1:2557\n1551#1:2558\n1558#1:2559\n1558#1:2560\n1565#1:2561\n1565#1:2562\n1573#1:2563\n1573#1:2564\n1580#1:2565\n1580#1:2566\n1586#1:2567\n1586#1:2568\n1590#1:2569\n1590#1:2570\n1601#1:2571\n1604#1:2572\n1604#1:2573\n1611#1:2574\n1611#1:2575\n1624#1:2576\n1624#1:2577\n1687#1:2592\n1703#1:2595\n1707#1:2598\n328#1:2033,2\n328#1:2038\n442#1:2052,2\n584#1:2082,2\n586#1:2084,2\n618#1:2100\n618#1:2101\n618#1:2102\n618#1:2126\n636#1:2127\n636#1:2128\n636#1:2129\n636#1:2162\n700#1:2184\n700#1:2185\n700#1:2186,3\n758#1:2269\n758#1:2270\n758#1:2271,3\n1671#1:2579,13\n1687#1:2593,2\n1703#1:2596,2\n1707#1:2599,2\n389#1:2040\n389#1:2041\n389#1:2042\n389#1:2043\n389#1:2044,4\n389#1:2048\n389#1:2049\n528#1:2072\n846#1:2311,2\n876#1:2316,13\n878#1:2329,13\n912#1:2351,13\n917#1:2366,13\n921#1:2379,13\n955#1:2400,2\n955#1:2402,4\n955#1:2406\n994#1:2409,13\n1064#1:2437,13\n1107#1:2460,13\n1764#1:2605\n*E\n"
.end annotation


# static fields
.field public static final Companion:Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$Companion;
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private static final LOG_TAG:Ljava/lang/String;

.field private static final NEARBY_DEVICES_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/permission/access/immutable/IndexedSet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private static final NOTIFICATIONS_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/permission/access/immutable/IndexedSet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private static final NO_IMPLICIT_FLAG_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/permission/access/immutable/IndexedSet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private static final STORAGE_AND_MEDIA_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/permission/access/immutable/IndexedSet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field


# instance fields
.field private volatile isSignaturePermissionAllowlistForceEnforced:Z

.field private final migration:Lcom/android/server/permission/access/permission/AppIdPermissionMigration;
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private volatile onPermissionFlagsChangedListeners:Lcom/android/server/permission/access/immutable/IndexedListSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/permission/access/immutable/IndexedListSet<",
            "Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private final onPermissionFlagsChangedListenersLock:Ljava/lang/Object;
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private final persistence:Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private final privilegedPermissionAllowlistViolations:Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Lcom/android/server/permission/access/immutable/MutableIndexedSet<",
            "Ljava/lang/String;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field

.field private final upgrade:Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation
.end field


# direct methods
.method static constructor <clinit>()V
    .locals 8

    new-instance v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$Companion;

    const/4 v1, 0x0

    invoke-direct {v0, v1}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$Companion;-><init>(Lcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    sput-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->Companion:Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$Companion;

    .line 1804
    const-class v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;

    invoke-virtual {v0}, Ljava/lang/Class;->getSimpleName()Ljava/lang/String;

    move-result-object v0

    sput-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1810
    nop

    .line 1811
    nop

    .line 1812
    nop

    .line 1811
    nop

    .line 1813
    nop

    .line 1811
    nop

    .line 1814
    nop

    .line 1811
    nop

    .line 1815
    nop

    .line 1811
    nop

    .line 1816
    const-string v6, "android.permission.READ_MEDIA_VISUAL_USER_SELECTED"

    const-string v1, "android.permission.ACCESS_MEDIA_LOCATION"

    const-string v2, "android.permission.ACTIVITY_RECOGNITION"

    const-string v3, "android.permission.READ_MEDIA_AUDIO"

    const-string v4, "android.permission.READ_MEDIA_IMAGES"

    const-string v5, "android.permission.READ_MEDIA_VIDEO"

    filled-new-array/range {v1 .. v6}, [Ljava/lang/String;

    move-result-object v0

    .line 1811
    nop

    .line 1810
    invoke-static {v0}, Lcom/android/server/permission/access/immutable/IndexedSetExtensionsKt;->indexedSetOf([Ljava/lang/Object;)Lcom/android/server/permission/access/immutable/IndexedSet;

    move-result-object v0

    sput-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->NO_IMPLICIT_FLAG_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    .line 1820
    nop

    .line 1821
    nop

    .line 1822
    nop

    .line 1821
    nop

    .line 1823
    nop

    .line 1821
    nop

    .line 1824
    const-string v0, "android.permission.NEARBY_WIFI_DEVICES"

    const-string v1, "android.permission.BLUETOOTH_ADVERTISE"

    const-string v2, "android.permission.BLUETOOTH_CONNECT"

    const-string v3, "android.permission.BLUETOOTH_SCAN"

    filled-new-array {v1, v2, v3, v0}, [Ljava/lang/String;

    move-result-object v0

    .line 1821
    nop

    .line 1820
    invoke-static {v0}, Lcom/android/server/permission/access/immutable/IndexedSetExtensionsKt;->indexedSetOf([Ljava/lang/Object;)Lcom/android/server/permission/access/immutable/IndexedSet;

    move-result-object v0

    sput-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->NEARBY_DEVICES_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    .line 1827
    const-string v0, "android.permission.POST_NOTIFICATIONS"

    filled-new-array {v0}, [Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/access/immutable/IndexedSetExtensionsKt;->indexedSetOf([Ljava/lang/Object;)Lcom/android/server/permission/access/immutable/IndexedSet;

    move-result-object v0

    sput-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->NOTIFICATIONS_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    .line 1830
    nop

    .line 1831
    nop

    .line 1832
    nop

    .line 1831
    nop

    .line 1833
    nop

    .line 1831
    nop

    .line 1834
    nop

    .line 1831
    nop

    .line 1835
    nop

    .line 1831
    nop

    .line 1836
    nop

    .line 1831
    nop

    .line 1837
    const-string v7, "android.permission.READ_MEDIA_VISUAL_USER_SELECTED"

    const-string v1, "android.permission.READ_EXTERNAL_STORAGE"

    const-string v2, "android.permission.WRITE_EXTERNAL_STORAGE"

    const-string v3, "android.permission.READ_MEDIA_AUDIO"

    const-string v4, "android.permission.READ_MEDIA_VIDEO"

    const-string v5, "android.permission.READ_MEDIA_IMAGES"

    const-string v6, "android.permission.ACCESS_MEDIA_LOCATION"

    filled-new-array/range {v1 .. v7}, [Ljava/lang/String;

    move-result-object v0

    .line 1831
    nop

    .line 1830
    invoke-static {v0}, Lcom/android/server/permission/access/immutable/IndexedSetExtensionsKt;->indexedSetOf([Ljava/lang/Object;)Lcom/android/server/permission/access/immutable/IndexedSet;

    move-result-object v0

    sput-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->STORAGE_AND_MEDIA_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    return-void
.end method

.method public constructor <init>()V
    .locals 3

    .line 52
    invoke-direct {p0}, Lcom/android/server/permission/access/SchemePolicy;-><init>()V

    .line 53
    new-instance v0, Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;

    invoke-direct {v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;-><init>()V

    iput-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->persistence:Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;

    .line 55
    new-instance v0, Lcom/android/server/permission/access/permission/AppIdPermissionMigration;

    invoke-direct {v0}, Lcom/android/server/permission/access/permission/AppIdPermissionMigration;-><init>()V

    iput-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->migration:Lcom/android/server/permission/access/permission/AppIdPermissionMigration;

    .line 57
    new-instance v0, Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;

    invoke-direct {v0, p0}, Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;-><init>(Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;)V

    iput-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->upgrade:Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;

    .line 62
    new-instance v0, Lcom/android/server/permission/access/immutable/MutableIndexedListSet;

    const/4 v1, 0x0

    const/4 v2, 0x1

    invoke-direct {v0, v1, v2, v1}, Lcom/android/server/permission/access/immutable/MutableIndexedListSet;-><init>(Ljava/util/ArrayList;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    iput-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListeners:Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 63
    new-instance v0, Ljava/lang/Object;

    invoke-direct {v0}, Ljava/lang/Object;-><init>()V

    iput-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListenersLock:Ljava/lang/Object;

    .line 65
    new-instance v0, Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    invoke-direct {v0, v1, v2, v1}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;-><init>(Landroid/util/ArraySet;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    iput-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->privilegedPermissionAllowlistViolations:Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    .line 52
    return-void
.end method

.method private final addPermissionGroups(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;)V
    .locals 16
    .param p1, "$this$addPermissionGroups"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;

    .line 389
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getUserStates()Landroid/util/SparseArray;

    move-result-object v0

    .local v0, "$this$allIndexed$iv":Landroid/util/SparseArray;
    const/4 v1, 0x0

    .line 22
    .local v1, "$i$f$allIndexed":I
    move-object v2, v0

    .local v2, "$this$forEachIndexed$iv$iv":Landroid/util/SparseArray;
    const/4 v3, 0x0

    .line 40
    .local v3, "$i$f$forEachIndexed":I
    const/4 v4, 0x0

    .local v4, "index$iv$iv":I
    move-object v5, v2

    .local v5, "$this$size$iv$iv$iv":Landroid/util/SparseArray;
    const/4 v6, 0x0

    .line 100
    .local v6, "$i$f$getSize":I
    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    .line 40
    .end local v5    # "$this$size$iv$iv$iv":Landroid/util/SparseArray;
    .end local v6    # "$i$f$getSize":I
    nop

    :goto_0
    const/4 v7, 0x1

    if-ge v4, v5, :cond_1

    .line 41
    invoke-virtual {v2, v4}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v8

    .local v8, "key$iv":I
    invoke-virtual {v2, v4}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v9

    .local v9, "value$iv":Ljava/lang/Object;
    move v10, v4

    .local v10, "index$iv":I
    const/4 v11, 0x0

    .line 23
    .local v11, "$i$a$-forEachIndexed-SparseArrayExtensionsKt$allIndexed$1$iv":I
    move-object v12, v9

    check-cast v12, Lcom/android/server/pm/pkg/PackageUserState;

    .local v12, "it":Lcom/android/server/pm/pkg/PackageUserState;
    const/4 v13, 0x0

    .line 389
    .local v13, "$i$a$-allIndexed-AppIdPermissionPolicy$addPermissionGroups$isInstantApp$1":I
    invoke-interface {v12}, Lcom/android/server/pm/pkg/PackageUserState;->isInstantApp()Z

    move-result v12

    .line 23
    .end local v12    # "it":Lcom/android/server/pm/pkg/PackageUserState;
    .end local v13    # "$i$a$-allIndexed-AppIdPermissionPolicy$addPermissionGroups$isInstantApp$1":I
    if-nez v12, :cond_0

    .line 24
    const/4 v0, 0x0

    goto :goto_1

    .line 26
    :cond_0
    nop

    .line 41
    .end local v8    # "key$iv":I
    .end local v9    # "value$iv":Ljava/lang/Object;
    .end local v10    # "index$iv":I
    .end local v11    # "$i$a$-forEachIndexed-SparseArrayExtensionsKt$allIndexed$1$iv":I
    nop

    .line 40
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_1
    nop

    .line 43
    .end local v4    # "index$iv$iv":I
    nop

    .line 27
    .end local v2    # "$this$forEachIndexed$iv$iv":Landroid/util/SparseArray;
    .end local v3    # "$i$f$forEachIndexed":I
    move v0, v7

    .line 389
    .end local v0    # "$this$allIndexed$iv":Landroid/util/SparseArray;
    .end local v1    # "$i$f$allIndexed":I
    :goto_1
    nop

    .line 390
    .local v0, "isInstantApp":Z
    if-eqz v0, :cond_2

    .line 392
    sget-object v1, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 394
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v2

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Ignoring permission groups declared in package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, ": instant apps cannot declare permission groups"

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    .line 391
    invoke-static {v1, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 396
    return-void

    .line 398
    :cond_2
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v1}, Lcom/android/server/pm/pkg/AndroidPackage;->getPermissionGroups()Ljava/util/List;

    move-result-object v1

    .local v1, "$this$forEachIndexed$iv":Ljava/util/List;
    const/4 v2, 0x0

    .line 38
    .local v2, "$i$f$forEachIndexed":I
    const/4 v3, 0x0

    .local v3, "index$iv":I
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v4

    :goto_2
    if-ge v3, v4, :cond_7

    .line 39
    invoke-interface {v1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/internal/pm/pkg/component/ParsedPermissionGroup;

    .local v5, "parsedPermissionGroup":Lcom/android/internal/pm/pkg/component/ParsedPermissionGroup;
    const/4 v8, 0x0

    .line 401
    .local v8, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissionGroups$1":I
    nop

    .line 402
    nop

    .line 400
    const-wide/16 v9, 0x80

    invoke-static {v5, v9, v10}, Lcom/android/server/pm/parsing/PackageInfoUtils;->generatePermissionGroupInfo(Lcom/android/internal/pm/pkg/component/ParsedPermissionGroup;J)Landroid/content/pm/PermissionGroupInfo;

    move-result-object v9

    .line 403
    invoke-static {v9}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    .line 399
    nop

    .line 405
    .local v9, "newPermissionGroup":Landroid/content/pm/PermissionGroupInfo;
    iget-object v10, v9, Landroid/content/pm/PermissionGroupInfo;->name:Ljava/lang/String;

    .line 406
    .local v10, "permissionGroupName":Ljava/lang/String;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v11

    invoke-virtual {v11}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v11

    invoke-virtual {v11}, Lcom/android/server/permission/access/SystemState;->getPermissionGroups()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v11

    invoke-virtual {v11, v10}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/content/pm/PermissionGroupInfo;

    .line 407
    .local v11, "oldPermissionGroup":Landroid/content/pm/PermissionGroupInfo;
    nop

    .line 408
    if-eqz v11, :cond_6

    .line 409
    iget-object v12, v9, Landroid/content/pm/PermissionGroupInfo;->packageName:Ljava/lang/String;

    iget-object v13, v11, Landroid/content/pm/PermissionGroupInfo;->packageName:Ljava/lang/String;

    invoke-static {v12, v13}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v12

    if-nez v12, :cond_6

    .line 411
    iget-object v12, v9, Landroid/content/pm/PermissionGroupInfo;->packageName:Ljava/lang/String;

    .line 412
    .local v12, "newPackageName":Ljava/lang/String;
    iget-object v13, v11, Landroid/content/pm/PermissionGroupInfo;->packageName:Ljava/lang/String;

    .line 417
    .local v13, "oldPackageName":Ljava/lang/String;
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v14

    const-string v15, "Ignoring permission group "

    if-nez v14, :cond_3

    .line 419
    sget-object v14, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 420
    nop

    .line 421
    nop

    .line 422
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, " declared in package "

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, ": already declared in another package "

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    .line 418
    invoke-static {v14, v6}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 424
    const/4 v13, 0x0

    goto/16 :goto_4

    .line 426
    :cond_3
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v6

    invoke-virtual {v6}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v6

    invoke-virtual {v6}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v6

    invoke-interface {v6, v13}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/pm/pkg/PackageState;

    if-eqz v6, :cond_4

    invoke-interface {v6}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v6

    if-ne v6, v7, :cond_4

    move v6, v7

    goto :goto_3

    :cond_4
    const/4 v6, 0x0

    :goto_3
    if-eqz v6, :cond_5

    .line 428
    sget-object v6, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 429
    nop

    .line 430
    nop

    .line 431
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, " declared in system package "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, ": already declared in another system package "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    .line 427
    invoke-static {v6, v14}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 433
    const/4 v13, 0x0

    goto :goto_4

    .line 436
    :cond_5
    sget-object v6, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 437
    nop

    .line 438
    nop

    .line 439
    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Overriding permission group "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, " with new declaration in system package "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v15, ": originally declared in another package "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v14

    .line 435
    invoke-static {v6, v14}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 442
    .end local v12    # "newPackageName":Ljava/lang/String;
    .end local v13    # "oldPackageName":Ljava/lang/String;
    :cond_6
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v6

    const/4 v12, 0x0

    const/4 v13, 0x0

    invoke-static {v6, v13, v7, v12}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v6

    invoke-virtual {v6}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissionGroups()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v6

    .local v6, "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    const/4 v12, 0x0

    .line 126
    .local v12, "$i$f$set":I
    invoke-virtual {v6, v10, v9}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 127
    nop

    .line 444
    .end local v6    # "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .end local v12    # "$i$f$set":I
    nop

    .line 39
    .end local v5    # "parsedPermissionGroup":Lcom/android/internal/pm/pkg/component/ParsedPermissionGroup;
    .end local v8    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissionGroups$1":I
    .end local v9    # "newPermissionGroup":Landroid/content/pm/PermissionGroupInfo;
    .end local v10    # "permissionGroupName":Ljava/lang/String;
    .end local v11    # "oldPermissionGroup":Landroid/content/pm/PermissionGroupInfo;
    :goto_4
    nop

    .line 38
    add-int/lit8 v3, v3, 0x1

    goto/16 :goto_2

    :cond_7
    nop

    .line 41
    .end local v3    # "index$iv":I
    nop

    .line 445
    .end local v1    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v2    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final addPermissions(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V
    .locals 36
    .param p1, "$this$addPermissions"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "changedPermissionNames"    # Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/MutateStateScope;",
            "Lcom/android/server/pm/pkg/PackageState;",
            "Lcom/android/server/permission/access/immutable/MutableIndexedSet<",
            "Ljava/lang/String;",
            ">;)V"
        }
    .end annotation

    .line 451
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    .line 455
    .local v0, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getOldState()Lcom/android/server/permission/access/AccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v2

    invoke-interface {v1, v2}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    if-eqz v1, :cond_0

    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v1

    goto :goto_0

    :cond_0
    const/4 v1, 0x0

    .line 454
    :goto_0
    nop

    .line 457
    .local v1, "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    if-eqz v1, :cond_1

    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getSigningDetails()Landroid/content/pm/SigningDetails;

    move-result-object v5

    invoke-interface {v1}, Lcom/android/server/pm/pkg/AndroidPackage;->getSigningDetails()Landroid/content/pm/SigningDetails;

    move-result-object v6

    invoke-static {v5, v6}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_1

    const/4 v5, 0x1

    goto :goto_1

    :cond_1
    const/4 v5, 0x0

    .line 456
    :goto_1
    nop

    .line 458
    .local v5, "isPackageSigningChanged":Z
    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getPermissions()Ljava/util/List;

    move-result-object v6

    .local v6, "$this$forEachIndexed$iv":Ljava/util/List;
    const/4 v7, 0x0

    .line 38
    .local v7, "$i$f$forEachIndexed":I
    const/4 v8, 0x0

    .local v8, "index$iv":I
    invoke-interface {v6}, Ljava/util/List;->size()I

    move-result v9

    :goto_2
    if-ge v8, v9, :cond_29

    .line 39
    invoke-interface {v6, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/internal/pm/pkg/component/ParsedPermission;

    .local v10, "parsedPermission":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    const/4 v11, 0x0

    .line 461
    .local v11, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    nop

    .line 462
    nop

    .line 460
    const-wide/16 v12, 0x80

    invoke-static {v10, v12, v13}, Lcom/android/server/pm/parsing/PackageInfoUtils;->generatePermissionInfo(Lcom/android/internal/pm/pkg/component/ParsedPermission;J)Landroid/content/pm/PermissionInfo;

    move-result-object v12

    .line 463
    invoke-static {v12}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    .line 459
    nop

    .line 464
    .local v12, "newPermissionInfo":Landroid/content/pm/PermissionInfo;
    iget-object v15, v12, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 466
    .local v15, "permissionName":Ljava/lang/String;
    invoke-interface {v10}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v13

    if-eqz v13, :cond_2

    .line 467
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/permission/access/SystemState;->getPermissionTrees()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v13

    invoke-virtual {v13, v15}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/permission/access/permission/Permission;

    goto :goto_3

    .line 469
    :cond_2
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v13

    invoke-virtual {v13, v15}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/permission/access/permission/Permission;

    .line 466
    :goto_3
    nop

    .line 465
    move-object/from16 v20, v13

    .line 475
    .local v20, "oldPermission":Lcom/android/server/permission/access/permission/Permission;
    move-object/from16 v14, p0

    move-object/from16 v13, p1

    invoke-virtual {v14, v13, v15}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->findPermissionTree(Lcom/android/server/permission/access/GetStateScope;Ljava/lang/String;)Lcom/android/server/permission/access/permission/Permission;

    move-result-object v21

    .line 476
    .local v21, "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    iget-object v2, v12, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 477
    .local v2, "newPackageName":Ljava/lang/String;
    const-string v3, " declared in package "

    const-string v4, "Ignoring permission "

    if-eqz v21, :cond_4

    move-object/from16 v16, v21

    .local v16, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v17, 0x0

    .line 36
    .local v17, "$i$f$getPackageName":I
    move-object/from16 v22, v0

    .end local v0    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v22, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v0

    iget-object v0, v0, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 477
    .end local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v17    # "$i$f$getPackageName":I
    invoke-static {v2, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_3

    .line 479
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 480
    nop

    .line 481
    move-object/from16 v16, v21

    .restart local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v17, 0x0

    .line 33
    .local v17, "$i$f$getName":I
    move-object/from16 v23, v1

    .end local v1    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v23, "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 482
    .end local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v17    # "$i$f$getName":I
    nop

    .restart local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v17, 0x0

    .line 36
    .local v17, "$i$f$getPackageName":I
    move-object/from16 v24, v6

    .end local v6    # "$this$forEachIndexed$iv":Ljava/util/List;
    .local v24, "$this$forEachIndexed$iv":Ljava/util/List;
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v6

    iget-object v6, v6, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    move/from16 v25, v7

    .end local v7    # "$i$f$forEachIndexed":I
    .end local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v17    # "$i$f$getPackageName":I
    .local v25, "$i$f$forEachIndexed":I
    new-instance v7, Ljava/lang/StringBuilder;

    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v7, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": base permission tree "

    invoke-virtual {v7, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " is declared in another package "

    invoke-virtual {v7, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 478
    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 484
    move/from16 v32, v8

    move/from16 v34, v9

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v13, 0x1

    goto/16 :goto_19

    .line 477
    .end local v23    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v24    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v25    # "$i$f$forEachIndexed":I
    .restart local v1    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v6    # "$this$forEachIndexed$iv":Ljava/util/List;
    .restart local v7    # "$i$f$forEachIndexed":I
    :cond_3
    move-object/from16 v23, v1

    move-object/from16 v24, v6

    move/from16 v25, v7

    .end local v1    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v6    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v7    # "$i$f$forEachIndexed":I
    .restart local v23    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v24    # "$this$forEachIndexed$iv":Ljava/util/List;
    .restart local v25    # "$i$f$forEachIndexed":I
    goto :goto_4

    .end local v22    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v23    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v24    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v25    # "$i$f$forEachIndexed":I
    .restart local v0    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v1    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v6    # "$this$forEachIndexed$iv":Ljava/util/List;
    .restart local v7    # "$i$f$forEachIndexed":I
    :cond_4
    move-object/from16 v22, v0

    move-object/from16 v23, v1

    move-object/from16 v24, v6

    move/from16 v25, v7

    .line 487
    .end local v0    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v1    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v6    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v7    # "$i$f$forEachIndexed":I
    .restart local v22    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v23    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v24    # "$this$forEachIndexed$iv":Ljava/util/List;
    .restart local v25    # "$i$f$forEachIndexed":I
    :goto_4
    if-eqz v20, :cond_19

    .line 488
    move-object/from16 v0, v20

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 36
    .local v1, "$i$f$getPackageName":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v6

    iget-object v0, v6, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 488
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$getPackageName":I
    invoke-static {v2, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_a

    .line 489
    move-object/from16 v0, v20

    .restart local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 36
    .restart local v1    # "$i$f$getPackageName":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v6

    iget-object v0, v6, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 489
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$getPackageName":I
    nop

    .line 491
    .local v0, "oldPackageName":Ljava/lang/String;
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v1

    if-nez v1, :cond_5

    .line 493
    sget-object v1, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 494
    nop

    .line 495
    nop

    .line 496
    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": already declared in another package "

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 492
    invoke-static {v1, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 498
    move/from16 v32, v8

    move/from16 v34, v9

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v13, 0x1

    goto/16 :goto_19

    .line 500
    :cond_5
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface {v1, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    if-eqz v1, :cond_6

    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v1

    const/4 v3, 0x1

    if-ne v1, v3, :cond_6

    const/4 v1, 0x1

    goto :goto_5

    :cond_6
    const/4 v1, 0x0

    :goto_5
    if-eqz v1, :cond_7

    .line 502
    sget-object v1, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 503
    nop

    .line 504
    nop

    .line 505
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " declared in system package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, ": already declared in another system package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 501
    invoke-static {v1, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 507
    move/from16 v32, v8

    move/from16 v34, v9

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v13, 0x1

    goto/16 :goto_19

    .line 510
    :cond_7
    sget-object v1, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 511
    nop

    .line 512
    nop

    .line 513
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Overriding permission "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " with new declaration in system package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, ": originally declared in another package "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 509
    invoke-static {v1, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 516
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v1

    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v3, 0x0

    .line 38
    .local v3, "$i$f$forEachIndexed":I
    const/4 v4, 0x0

    .local v4, "index$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v6

    :goto_6
    if-ge v4, v6, :cond_9

    .line 39
    invoke-virtual {v1, v4}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v7

    .local v7, "userId":I
    const/16 v19, 0x0

    .line 517
    .local v19, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$1":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v16

    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v16

    move-object/from16 v26, v0

    .end local v0    # "oldPackageName":Ljava/lang/String;
    .local v26, "oldPackageName":Ljava/lang/String;
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/16 v27, 0x0

    .line 44
    .local v27, "$i$f$forEachIndexed":I
    const/16 v16, 0x0

    move-object/from16 v28, v1

    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .local v16, "index$iv":I
    .local v28, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v1

    move/from16 v29, v3

    move/from16 v3, v16

    .end local v16    # "index$iv":I
    .local v3, "index$iv":I
    .local v29, "$i$f$forEachIndexed":I
    :goto_7
    if-ge v3, v1, :cond_8

    .line 45
    invoke-virtual {v0, v3}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v30

    .local v30, "appId":I
    invoke-virtual {v0, v3}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v16

    check-cast v16, Lcom/android/server/permission/access/immutable/IndexedListSet;

    const/16 v31, 0x0

    .line 518
    .local v31, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$1$1":I
    const/16 v18, 0x0

    move-object/from16 v13, p0

    move-object/from16 v14, p1

    move-object/from16 v32, v15

    .end local v15    # "permissionName":Ljava/lang/String;
    .local v32, "permissionName":Ljava/lang/String;
    move/from16 v15, v30

    move/from16 v16, v7

    move-object/from16 v17, v32

    invoke-virtual/range {v13 .. v18}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 519
    nop

    .line 45
    .end local v30    # "appId":I
    .end local v31    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$1$1":I
    nop

    .line 44
    add-int/lit8 v3, v3, 0x1

    move-object/from16 v14, p0

    move-object/from16 v13, p1

    move-object/from16 v15, v32

    goto :goto_7

    .end local v32    # "permissionName":Ljava/lang/String;
    .restart local v15    # "permissionName":Ljava/lang/String;
    :cond_8
    move-object/from16 v32, v15

    .line 47
    .end local v3    # "index$iv":I
    .end local v15    # "permissionName":Ljava/lang/String;
    .restart local v32    # "permissionName":Ljava/lang/String;
    nop

    .line 520
    .end local v0    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v27    # "$i$f$forEachIndexed":I
    nop

    .line 39
    .end local v7    # "userId":I
    .end local v19    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$1":I
    nop

    .line 38
    add-int/lit8 v4, v4, 0x1

    move-object/from16 v14, p0

    move-object/from16 v13, p1

    move-object/from16 v0, v26

    move-object/from16 v1, v28

    move/from16 v3, v29

    goto :goto_6

    .end local v26    # "oldPackageName":Ljava/lang/String;
    .end local v28    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v29    # "$i$f$forEachIndexed":I
    .end local v32    # "permissionName":Ljava/lang/String;
    .local v0, "oldPackageName":Ljava/lang/String;
    .restart local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .local v3, "$i$f$forEachIndexed":I
    .restart local v15    # "permissionName":Ljava/lang/String;
    :cond_9
    move-object/from16 v26, v0

    move-object/from16 v28, v1

    move/from16 v29, v3

    move-object/from16 v32, v15

    .line 41
    .end local v0    # "oldPackageName":Ljava/lang/String;
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v3    # "$i$f$forEachIndexed":I
    .end local v4    # "index$iv":I
    .end local v15    # "permissionName":Ljava/lang/String;
    .restart local v26    # "oldPackageName":Ljava/lang/String;
    .restart local v28    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v29    # "$i$f$forEachIndexed":I
    .restart local v32    # "permissionName":Ljava/lang/String;
    move/from16 v34, v9

    move/from16 v35, v11

    move-object/from16 v4, v32

    move/from16 v32, v8

    .end local v26    # "oldPackageName":Ljava/lang/String;
    .end local v28    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v29    # "$i$f$forEachIndexed":I
    goto/16 :goto_11

    .line 521
    .end local v32    # "permissionName":Ljava/lang/String;
    .restart local v15    # "permissionName":Ljava/lang/String;
    :cond_a
    move-object/from16 v32, v15

    .end local v15    # "permissionName":Ljava/lang/String;
    .restart local v32    # "permissionName":Ljava/lang/String;
    invoke-virtual/range {v20 .. v20}, Lcom/android/server/permission/access/permission/Permission;->isReconciled()Z

    move-result v0

    if-eqz v0, :cond_18

    .line 523
    invoke-virtual {v12}, Landroid/content/pm/PermissionInfo;->isRuntime()Z

    move-result v0

    if-eqz v0, :cond_b

    .line 524
    iget-object v0, v12, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    if-eqz v0, :cond_b

    .line 525
    iget-object v0, v12, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    move-object/from16 v1, v20

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 39
    .local v3, "$i$f$getGroupName":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v4

    iget-object v1, v4, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$getGroupName":I
    invoke-static {v0, v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_b

    const/4 v0, 0x1

    goto :goto_8

    :cond_b
    const/4 v0, 0x0

    .line 522
    :goto_8
    nop

    .line 527
    .local v0, "isPermissionGroupChanged":Z
    invoke-virtual {v12}, Landroid/content/pm/PermissionInfo;->isRuntime()Z

    move-result v1

    nop

    if-eqz v1, :cond_d

    move-object/from16 v1, v20

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 57
    .local v3, "$i$f$isRuntime":I
    move-object v4, v1

    .local v4, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 48
    .local v6, "$i$f$getProtection":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v7

    invoke-virtual {v7}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v4

    .line 57
    .end local v4    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$getProtection":I
    const/4 v6, 0x1

    if-ne v4, v6, :cond_c

    const/4 v1, 0x1

    goto :goto_9

    :cond_c
    const/4 v1, 0x0

    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$isRuntime":I
    :goto_9
    if-eqz v1, :cond_10

    .line 528
    :cond_d
    move-object v1, v12

    .local v1, "$this$isInternal$iv":Landroid/content/pm/PermissionInfo;
    const/4 v3, 0x0

    .line 25
    .local v3, "$i$f$isInternal":I
    invoke-virtual {v1}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v4

    const/4 v6, 0x4

    if-ne v4, v6, :cond_e

    const/4 v1, 0x1

    goto :goto_a

    :cond_e
    const/4 v1, 0x0

    .end local v1    # "$this$isInternal$iv":Landroid/content/pm/PermissionInfo;
    .end local v3    # "$i$f$isInternal":I
    :goto_a
    if-eqz v1, :cond_11

    .line 528
    move-object/from16 v1, v20

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 51
    .restart local v3    # "$i$f$isInternal":I
    move-object v4, v1

    .restart local v4    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v7, 0x0

    .line 48
    .local v7, "$i$f$getProtection":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v13

    invoke-virtual {v13}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v4

    .line 51
    .end local v4    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v7    # "$i$f$getProtection":I
    if-ne v4, v6, :cond_f

    const/4 v1, 0x1

    goto :goto_b

    :cond_f
    const/4 v1, 0x0

    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$isInternal":I
    :goto_b
    if-nez v1, :cond_11

    :cond_10
    const/4 v1, 0x1

    goto :goto_c

    :cond_11
    const/4 v1, 0x0

    .line 526
    :goto_c
    nop

    .line 529
    .local v1, "isPermissionProtectionChanged":Z
    if-nez v0, :cond_12

    if-eqz v1, :cond_13

    :cond_12
    goto :goto_d

    :cond_13
    move/from16 v34, v9

    move/from16 v35, v11

    move-object/from16 v4, v32

    move/from16 v32, v8

    goto/16 :goto_11

    .line 530
    :goto_d
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v3

    .local v3, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v4, 0x0

    .line 38
    .local v4, "$i$f$forEachIndexed":I
    const/4 v6, 0x0

    .local v6, "index$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v7

    :goto_e
    if-ge v6, v7, :cond_17

    .line 39
    invoke-virtual {v3, v6}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v15

    .local v15, "userId":I
    const/16 v19, 0x0

    .line 531
    .local v19, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$2":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v13

    invoke-virtual {v13}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v14

    .local v14, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/16 v26, 0x0

    .line 44
    .local v26, "$i$f$forEachIndexed":I
    const/4 v13, 0x0

    move-object/from16 v27, v3

    .end local v3    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .local v13, "index$iv":I
    .local v27, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    invoke-virtual {v14}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v3

    :goto_f
    if-ge v13, v3, :cond_16

    .line 45
    move/from16 v28, v3

    invoke-virtual {v14, v13}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v3

    .local v3, "appId":I
    invoke-virtual {v14, v13}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v16

    check-cast v16, Lcom/android/server/permission/access/immutable/IndexedListSet;

    const/16 v29, 0x0

    .line 532
    .local v29, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$2$1":I
    move/from16 v30, v4

    .end local v4    # "$i$f$forEachIndexed":I
    .local v30, "$i$f$forEachIndexed":I
    const-string v4, " and userId "

    move/from16 v31, v7

    const-string v7, " for appId "

    if-eqz v0, :cond_14

    .line 538
    move/from16 v33, v0

    .end local v0    # "isPermissionGroupChanged":Z
    .local v33, "isPermissionGroupChanged":Z
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 539
    nop

    .line 540
    nop

    .line 541
    move-object/from16 v16, v20

    .local v16, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v17, 0x0

    .line 39
    .local v17, "$i$f$getGroupName":I
    move/from16 v34, v9

    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    iget-object v9, v9, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    .line 542
    .end local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v17    # "$i$f$getGroupName":I
    move/from16 v35, v11

    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v35, "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    iget-object v11, v12, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    move/from16 v16, v13

    .end local v13    # "index$iv":I
    .local v16, "index$iv":I
    new-instance v13, Ljava/lang/StringBuilder;

    invoke-direct {v13}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v17, v14

    .end local v14    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v17, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const-string v14, "Revoking runtime permission "

    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-object/from16 v14, v32

    .end local v32    # "permissionName":Ljava/lang/String;
    .local v14, "permissionName":Ljava/lang/String;
    invoke-virtual {v13, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v15}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    move/from16 v32, v8

    .end local v8    # "index$iv":I
    .local v32, "index$iv":I
    const-string v8, " as the permission group changed from "

    invoke-virtual {v13, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v8, " to "

    invoke-virtual {v13, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    .line 537
    invoke-static {v0, v8}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_10

    .line 532
    .end local v16    # "index$iv":I
    .end local v17    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v33    # "isPermissionGroupChanged":Z
    .end local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .restart local v0    # "isPermissionGroupChanged":Z
    .restart local v8    # "index$iv":I
    .restart local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .restart local v13    # "index$iv":I
    .local v14, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v32, "permissionName":Ljava/lang/String;
    :cond_14
    move/from16 v33, v0

    move/from16 v34, v9

    move/from16 v35, v11

    move/from16 v16, v13

    move-object/from16 v17, v14

    move-object/from16 v14, v32

    move/from16 v32, v8

    .line 545
    .end local v0    # "isPermissionGroupChanged":Z
    .end local v8    # "index$iv":I
    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .end local v13    # "index$iv":I
    .local v14, "permissionName":Ljava/lang/String;
    .restart local v16    # "index$iv":I
    .restart local v17    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v32, "index$iv":I
    .restart local v33    # "isPermissionGroupChanged":Z
    .restart local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    :goto_10
    if-eqz v1, :cond_15

    .line 547
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 548
    nop

    .line 549
    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Revoking permission "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v14}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v3}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v15}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " as the permission protection changed."

    invoke-virtual {v8, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 546
    invoke-static {v0, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 553
    :cond_15
    const/16 v18, 0x0

    move/from16 v0, v16

    .end local v16    # "index$iv":I
    .local v0, "index$iv":I
    move-object/from16 v13, p0

    move-object v4, v14

    move-object/from16 v7, v17

    .end local v14    # "permissionName":Ljava/lang/String;
    .end local v17    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v4, "permissionName":Ljava/lang/String;
    .local v7, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    move-object/from16 v14, p1

    move v8, v15

    .end local v15    # "userId":I
    .local v8, "userId":I
    move v15, v3

    move/from16 v16, v8

    move-object/from16 v17, v4

    invoke-virtual/range {v13 .. v18}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 554
    nop

    .line 45
    .end local v3    # "appId":I
    .end local v29    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$2$1":I
    nop

    .line 44
    add-int/lit8 v13, v0, 0x1

    move-object v14, v7

    move v15, v8

    move/from16 v3, v28

    move/from16 v7, v31

    move/from16 v8, v32

    move/from16 v0, v33

    move/from16 v9, v34

    move/from16 v11, v35

    move-object/from16 v32, v4

    move/from16 v4, v30

    .end local v0    # "index$iv":I
    .restart local v13    # "index$iv":I
    goto/16 :goto_f

    .end local v7    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v30    # "$i$f$forEachIndexed":I
    .end local v33    # "isPermissionGroupChanged":Z
    .end local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v0, "isPermissionGroupChanged":Z
    .local v4, "$i$f$forEachIndexed":I
    .local v8, "index$iv":I
    .restart local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v14, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v15    # "userId":I
    .local v32, "permissionName":Ljava/lang/String;
    :cond_16
    move/from16 v33, v0

    move/from16 v30, v4

    move/from16 v31, v7

    move/from16 v34, v9

    move/from16 v35, v11

    move v0, v13

    move-object v7, v14

    move-object/from16 v4, v32

    move/from16 v32, v8

    move v8, v15

    .line 47
    .end local v0    # "isPermissionGroupChanged":Z
    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .end local v13    # "index$iv":I
    .end local v14    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v15    # "userId":I
    .local v4, "permissionName":Ljava/lang/String;
    .restart local v7    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v8, "userId":I
    .restart local v30    # "$i$f$forEachIndexed":I
    .local v32, "index$iv":I
    .restart local v33    # "isPermissionGroupChanged":Z
    .restart local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    nop

    .line 555
    .end local v7    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v26    # "$i$f$forEachIndexed":I
    nop

    .line 39
    .end local v8    # "userId":I
    .end local v19    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1$2":I
    nop

    .line 38
    add-int/lit8 v6, v6, 0x1

    move-object/from16 v3, v27

    move/from16 v7, v31

    move/from16 v8, v32

    move/from16 v0, v33

    move-object/from16 v32, v4

    move/from16 v4, v30

    goto/16 :goto_e

    .end local v27    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v30    # "$i$f$forEachIndexed":I
    .end local v33    # "isPermissionGroupChanged":Z
    .end local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .restart local v0    # "isPermissionGroupChanged":Z
    .local v3, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .local v4, "$i$f$forEachIndexed":I
    .local v8, "index$iv":I
    .restart local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v32, "permissionName":Ljava/lang/String;
    :cond_17
    move/from16 v33, v0

    move-object/from16 v27, v3

    move/from16 v30, v4

    move/from16 v34, v9

    move/from16 v35, v11

    move-object/from16 v4, v32

    move/from16 v32, v8

    .line 41
    .end local v0    # "isPermissionGroupChanged":Z
    .end local v3    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v6    # "index$iv":I
    .end local v8    # "index$iv":I
    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v4, "permissionName":Ljava/lang/String;
    .restart local v27    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v30    # "$i$f$forEachIndexed":I
    .local v32, "index$iv":I
    .restart local v33    # "isPermissionGroupChanged":Z
    .restart local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    goto :goto_11

    .line 521
    .end local v1    # "isPermissionProtectionChanged":Z
    .end local v4    # "permissionName":Ljava/lang/String;
    .end local v27    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v30    # "$i$f$forEachIndexed":I
    .end local v33    # "isPermissionGroupChanged":Z
    .end local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .restart local v8    # "index$iv":I
    .restart local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v32, "permissionName":Ljava/lang/String;
    :cond_18
    move/from16 v34, v9

    move/from16 v35, v11

    move-object/from16 v4, v32

    move/from16 v32, v8

    .end local v8    # "index$iv":I
    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .restart local v4    # "permissionName":Ljava/lang/String;
    .local v32, "index$iv":I
    .restart local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    goto :goto_11

    .line 487
    .end local v4    # "permissionName":Ljava/lang/String;
    .end local v32    # "index$iv":I
    .end local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .restart local v8    # "index$iv":I
    .restart local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .local v15, "permissionName":Ljava/lang/String;
    :cond_19
    move/from16 v32, v8

    move/from16 v34, v9

    move/from16 v35, v11

    move-object v4, v15

    .line 560
    .end local v8    # "index$iv":I
    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    .end local v15    # "permissionName":Ljava/lang/String;
    .restart local v4    # "permissionName":Ljava/lang/String;
    .restart local v32    # "index$iv":I
    .restart local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    :goto_11
    const/4 v0, 0x0

    .local v0, "gids":Ljava/lang/Object;
    sget-object v0, Llibcore/util/EmptyArray;->INT:[I

    .line 561
    const/4 v1, 0x0

    .line 562
    .local v1, "areGidsPerUser":Z
    invoke-interface {v10}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v3

    if-nez v3, :cond_1b

    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v3

    if-eqz v3, :cond_1b

    .line 563
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/ExternalState;->getConfigPermissions()Ljava/util/Map;

    move-result-object v3

    invoke-interface {v3, v4}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/SystemConfig$PermissionEntry;

    nop

    if-eqz v3, :cond_1b

    .local v3, "it":Lcom/android/server/SystemConfig$PermissionEntry;
    const/4 v6, 0x0

    .line 567
    .local v6, "$i$a$-let-AppIdPermissionPolicy$addPermissions$1$3":I
    iget-object v7, v3, Lcom/android/server/SystemConfig$PermissionEntry;->gids:[I

    if-eqz v7, :cond_1a

    .line 568
    iget-object v0, v3, Lcom/android/server/SystemConfig$PermissionEntry;->gids:[I

    .line 569
    iget-boolean v1, v3, Lcom/android/server/SystemConfig$PermissionEntry;->perUser:Z

    .line 571
    :cond_1a
    nop

    .line 563
    .end local v3    # "it":Lcom/android/server/SystemConfig$PermissionEntry;
    .end local v6    # "$i$a$-let-AppIdPermissionPolicy$addPermissions$1$3":I
    nop

    .line 574
    :cond_1b
    new-instance v3, Lcom/android/server/permission/access/permission/Permission;

    .line 575
    nop

    .line 576
    nop

    .line 577
    nop

    .line 578
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v17

    .line 579
    nop

    .line 580
    nop

    .line 574
    const/4 v15, 0x1

    const/16 v16, 0x0

    move-object v13, v3

    move-object v14, v12

    move-object/from16 v18, v0

    move/from16 v19, v1

    invoke-direct/range {v13 .. v19}, Lcom/android/server/permission/access/permission/Permission;-><init>(Landroid/content/pm/PermissionInfo;ZII[IZ)V

    .line 573
    nop

    .line 583
    .local v3, "newPermission":Lcom/android/server/permission/access/permission/Permission;
    invoke-interface {v10}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v6

    if-eqz v6, :cond_1c

    .line 584
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v6

    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x1

    invoke-static {v6, v7, v9, v8}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v6

    invoke-virtual {v6}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissionTrees()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v6

    .local v6, "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    const/4 v11, 0x0

    .line 126
    .local v11, "$i$f$set":I
    invoke-virtual {v6, v4, v3}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 127
    move v13, v9

    .end local v6    # "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .end local v11    # "$i$f$set":I
    goto/16 :goto_18

    .line 586
    :cond_1c
    const/4 v7, 0x0

    const/4 v8, 0x0

    const/4 v9, 0x1

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v6

    invoke-static {v6, v7, v9, v8}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v6

    invoke-virtual {v6}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissions()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v6

    .restart local v6    # "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    const/4 v9, 0x0

    .line 126
    .local v9, "$i$f$set":I
    invoke-virtual {v6, v4, v3}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 127
    nop

    .line 588
    .end local v6    # "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .end local v9    # "$i$f$set":I
    if-eqz v20, :cond_27

    .line 589
    move-object/from16 v6, v20

    .local v6, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 36
    .local v9, "$i$f$getPackageName":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget-object v6, v11, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getPackageName":I
    invoke-static {v2, v6}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_26

    .line 590
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 45
    .local v9, "$i$f$getProtectionLevel":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget v6, v11, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    .line 590
    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getProtectionLevel":I
    move-object/from16 v9, v20

    .local v9, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v11, 0x0

    .line 45
    .local v11, "$i$f$getProtectionLevel":I
    invoke-virtual {v9}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v13

    iget v9, v13, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    .end local v9    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v11    # "$i$f$getProtectionLevel":I
    if-ne v6, v9, :cond_25

    .line 591
    invoke-virtual/range {v20 .. v20}, Lcom/android/server/permission/access/permission/Permission;->isReconciled()Z

    move-result v6

    if-eqz v6, :cond_23

    .line 592
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 60
    .local v9, "$i$f$isSignature":I
    move-object v11, v6

    .local v11, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v13, 0x0

    .line 48
    .local v13, "$i$f$getProtection":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v14

    invoke-virtual {v14}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v11

    .line 60
    .end local v11    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v13    # "$i$f$getProtection":I
    const/4 v13, 0x2

    if-ne v11, v13, :cond_1d

    const/4 v6, 0x1

    goto :goto_12

    :cond_1d
    move v6, v7

    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$isSignature":I
    :goto_12
    if-eqz v6, :cond_1f

    .line 592
    if-nez v5, :cond_1e

    goto :goto_13

    :cond_1e
    const/4 v13, 0x1

    goto/16 :goto_16

    .line 593
    :cond_1f
    :goto_13
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 90
    .local v9, "$i$f$isKnownSigner":I
    move-object v11, v6

    .restart local v11    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v13, 0x0

    .line 63
    .local v13, "$i$f$getProtectionFlags":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v14

    invoke-virtual {v14}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v11

    .line 90
    .end local v11    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v13    # "$i$f$getProtectionFlags":I
    const/high16 v13, 0x8000000

    invoke-static {v11, v13}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v6

    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$isKnownSigner":I
    if-eqz v6, :cond_21

    .line 594
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 147
    .local v9, "$i$f$getKnownCerts":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget-object v6, v11, Landroid/content/pm/PermissionInfo;->knownCerts:Ljava/util/Set;

    .line 594
    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getKnownCerts":I
    move-object/from16 v9, v20

    .local v9, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v11, 0x0

    .line 147
    .local v11, "$i$f$getKnownCerts":I
    invoke-virtual {v9}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v13

    iget-object v9, v13, Landroid/content/pm/PermissionInfo;->knownCerts:Ljava/util/Set;

    .end local v9    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v11    # "$i$f$getKnownCerts":I
    invoke-static {v6, v9}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v6

    if-eqz v6, :cond_20

    goto :goto_14

    :cond_20
    const/4 v13, 0x1

    goto :goto_16

    .line 595
    :cond_21
    :goto_14
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 57
    .local v9, "$i$f$isRuntime":I
    move-object v11, v6

    .local v11, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v13, 0x0

    .line 48
    .local v13, "$i$f$getProtection":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v14

    invoke-virtual {v14}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v11

    .line 57
    .end local v11    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v13    # "$i$f$getProtection":I
    const/4 v13, 0x1

    if-ne v11, v13, :cond_22

    move v6, v13

    goto :goto_15

    :cond_22
    move v6, v7

    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$isRuntime":I
    :goto_15
    if-eqz v6, :cond_24

    .line 596
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 39
    .local v9, "$i$f$getGroupName":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget-object v6, v11, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getGroupName":I
    if-eqz v6, :cond_24

    .line 597
    move-object v6, v3

    .restart local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 39
    .restart local v9    # "$i$f$getGroupName":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget-object v6, v11, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    .line 597
    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getGroupName":I
    move-object/from16 v9, v20

    .local v9, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v11, 0x0

    .line 39
    .local v11, "$i$f$getGroupName":I
    invoke-virtual {v9}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v14

    iget-object v9, v14, Landroid/content/pm/PermissionInfo;->group:Ljava/lang/String;

    .end local v9    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v11    # "$i$f$getGroupName":I
    invoke-static {v6, v9}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v6

    if-nez v6, :cond_24

    goto :goto_16

    .line 591
    :cond_23
    const/4 v13, 0x1

    .line 39
    :cond_24
    move v6, v7

    goto :goto_17

    .line 45
    :cond_25
    const/4 v13, 0x1

    goto :goto_16

    .line 36
    :cond_26
    const/4 v13, 0x1

    goto :goto_16

    .line 588
    :cond_27
    const/4 v13, 0x1

    .line 39
    :goto_16
    move v6, v13

    .line 587
    :goto_17
    nop

    .line 598
    .local v6, "isPermissionChanged":Z
    if-eqz v6, :cond_28

    .line 599
    move-object/from16 v9, p3

    .local v9, "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    const/4 v11, 0x0

    .line 80
    .local v11, "$i$f$plusAssign":I
    invoke-virtual {v9, v4}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;->add(Ljava/lang/Object;)Z

    .line 81
    nop

    .line 602
    .end local v6    # "isPermissionChanged":Z
    .end local v9    # "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .end local v11    # "$i$f$plusAssign":I
    :cond_28
    :goto_18
    nop

    .line 39
    .end local v0    # "gids":Ljava/lang/Object;
    .end local v1    # "areGidsPerUser":Z
    .end local v2    # "newPackageName":Ljava/lang/String;
    .end local v3    # "newPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "permissionName":Ljava/lang/String;
    .end local v10    # "parsedPermission":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    .end local v12    # "newPermissionInfo":Landroid/content/pm/PermissionInfo;
    .end local v20    # "oldPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v21    # "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    .end local v35    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$addPermissions$1":I
    :goto_19
    nop

    .line 38
    add-int/lit8 v0, v32, 0x1

    move v8, v0

    move-object/from16 v0, v22

    move-object/from16 v1, v23

    move-object/from16 v6, v24

    move/from16 v7, v25

    move/from16 v9, v34

    .end local v32    # "index$iv":I
    .local v0, "index$iv":I
    goto/16 :goto_2

    .end local v22    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v23    # "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v24    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v25    # "$i$f$forEachIndexed":I
    .local v0, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v1, "oldNewPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v6, "$this$forEachIndexed$iv":Ljava/util/List;
    .local v7, "$i$f$forEachIndexed":I
    .restart local v8    # "index$iv":I
    :cond_29
    nop

    .line 41
    .end local v8    # "index$iv":I
    nop

    .line 603
    .end local v6    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v7    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final adoptPermissions(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V
    .locals 29
    .param p1, "$this$adoptPermissions"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "changedPermissionNames"    # Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/MutateStateScope;",
            "Lcom/android/server/pm/pkg/PackageState;",
            "Lcom/android/server/permission/access/immutable/MutableIndexedSet<",
            "Ljava/lang/String;",
            ">;)V"
        }
    .end annotation

    .line 322
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    .line 323
    .local v0, "package":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getAdoptPermissions()Ljava/util/List;

    move-result-object v1

    .local v1, "$this$forEachIndexed$iv":Ljava/util/List;
    const/4 v2, 0x0

    .line 38
    .local v2, "$i$f$forEachIndexed":I
    const/4 v3, 0x0

    .local v3, "index$iv":I
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v4

    :goto_0
    if-ge v3, v4, :cond_3

    .line 39
    invoke-interface {v1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Ljava/lang/String;

    .local v5, "originalPackageName":Ljava/lang/String;
    const/4 v6, 0x0

    .line 324
    .local v6, "$i$a$-forEachIndexed-AppIdPermissionPolicy$adoptPermissions$1":I
    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getPackageName()Ljava/lang/String;

    move-result-object v7

    .line 325
    .local v7, "packageName":Ljava/lang/String;
    move-object/from16 v8, p0

    move-object/from16 v9, p1

    invoke-direct {v8, v9, v7, v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->canAdoptPermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Ljava/lang/String;)Z

    move-result v10

    if-nez v10, :cond_0

    .line 326
    move-object/from16 v27, v0

    move-object/from16 v28, v1

    move/from16 v16, v2

    move/from16 v18, v4

    goto/16 :goto_3

    .line 328
    :cond_0
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v10

    .local v10, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v11, 0x0

    .line 47
    .local v11, "$i$f$forEachIndexed":I
    const/4 v12, 0x0

    .local v12, "index$iv":I
    invoke-virtual {v10}, Lcom/android/server/permission/access/immutable/IndexedMap;->getSize()I

    move-result v13

    :goto_1
    if-ge v12, v13, :cond_2

    .line 48
    invoke-virtual {v10, v12}, Lcom/android/server/permission/access/immutable/IndexedMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v14

    invoke-virtual {v10, v12}, Lcom/android/server/permission/access/immutable/IndexedMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v15

    check-cast v15, Lcom/android/server/permission/access/permission/Permission;

    .local v15, "oldPermission":Lcom/android/server/permission/access/permission/Permission;
    check-cast v14, Ljava/lang/String;

    .local v14, "permissionName":Ljava/lang/String;
    move/from16 v16, v12

    .local v16, "permissionIndex":I
    move/from16 v25, v16

    .end local v16    # "permissionIndex":I
    .local v25, "permissionIndex":I
    const/16 v26, 0x0

    .line 332
    .local v26, "$i$a$-forEachIndexed-AppIdPermissionPolicy$adoptPermissions$1$1":I
    move-object/from16 v16, v15

    .local v16, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v17, 0x0

    .line 36
    .local v17, "$i$f$getPackageName":I
    move-object/from16 v27, v0

    .end local v0    # "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v27, "package":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v0

    iget-object v0, v0, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 332
    .end local v16    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v17    # "$i$f$getPackageName":I
    invoke-static {v0, v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_1

    .line 333
    move-object/from16 v28, v1

    move/from16 v16, v2

    move/from16 v18, v4

    move-object/from16 v19, v5

    goto :goto_2

    .line 337
    :cond_1
    new-instance v17, Landroid/content/pm/PermissionInfo;

    invoke-direct/range {v17 .. v17}, Landroid/content/pm/PermissionInfo;-><init>()V

    move-object/from16 v0, v17

    .local v0, "$this$adoptPermissions_u24lambda_u2421_u24lambda_u2420_u24lambda_u2419":Landroid/content/pm/PermissionInfo;
    const/16 v16, 0x0

    .line 338
    .local v16, "$i$a$-apply-AppIdPermissionPolicy$adoptPermissions$1$1$newPermissionInfo$1":I
    move-object/from16 v28, v1

    .end local v1    # "$this$forEachIndexed$iv":Ljava/util/List;
    .local v28, "$this$forEachIndexed$iv":Ljava/util/List;
    invoke-virtual {v15}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v1

    iget-object v1, v1, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    iput-object v1, v0, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 339
    iput-object v7, v0, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 340
    invoke-virtual {v15}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v1

    iget v1, v1, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    iput v1, v0, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    .line 341
    nop

    .line 337
    .end local v0    # "$this$adoptPermissions_u24lambda_u2421_u24lambda_u2420_u24lambda_u2419":Landroid/content/pm/PermissionInfo;
    .end local v16    # "$i$a$-apply-AppIdPermissionPolicy$adoptPermissions$1$1$newPermissionInfo$1":I
    nop

    .line 336
    nop

    .line 346
    .local v17, "newPermissionInfo":Landroid/content/pm/PermissionInfo;
    nop

    .line 347
    nop

    .line 348
    nop

    .line 346
    nop

    .line 349
    nop

    .line 346
    const/16 v23, 0x34

    const/16 v24, 0x0

    const/16 v18, 0x0

    const/16 v19, 0x0

    const/16 v20, 0x0

    const/16 v21, 0x0

    const/16 v22, 0x0

    move-object/from16 v16, v15

    invoke-static/range {v16 .. v24}, Lcom/android/server/permission/access/permission/Permission;->copy$default(Lcom/android/server/permission/access/permission/Permission;Landroid/content/pm/PermissionInfo;ZII[IZILjava/lang/Object;)Lcom/android/server/permission/access/permission/Permission;

    move-result-object v0

    .line 345
    nop

    .line 351
    .local v0, "newPermission":Lcom/android/server/permission/access/permission/Permission;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    .line 352
    move/from16 v16, v2

    .end local v2    # "$i$f$forEachIndexed":I
    .local v16, "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    move/from16 v18, v4

    const/4 v4, 0x0

    move-object/from16 v19, v5

    .end local v5    # "originalPackageName":Ljava/lang/String;
    .local v19, "originalPackageName":Ljava/lang/String;
    const/4 v5, 0x1

    invoke-static {v1, v2, v5, v4}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v1

    .line 353
    invoke-virtual {v1}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissions()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v1

    .line 354
    move/from16 v2, v25

    .end local v25    # "permissionIndex":I
    .local v2, "permissionIndex":I
    invoke-virtual {v1, v2, v0}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->putAt(ILjava/lang/Object;)Ljava/lang/Object;

    .line 355
    move-object/from16 v1, p3

    .local v1, "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    const/4 v4, 0x0

    .line 80
    .local v4, "$i$f$plusAssign":I
    invoke-virtual {v1, v14}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;->add(Ljava/lang/Object;)Z

    .line 81
    nop

    .line 356
    .end local v1    # "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .end local v4    # "$i$f$plusAssign":I
    nop

    .line 48
    .end local v0    # "newPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "permissionIndex":I
    .end local v14    # "permissionName":Ljava/lang/String;
    .end local v15    # "oldPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v17    # "newPermissionInfo":Landroid/content/pm/PermissionInfo;
    .end local v26    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$adoptPermissions$1$1":I
    :goto_2
    nop

    .line 47
    add-int/lit8 v12, v12, 0x1

    move/from16 v2, v16

    move/from16 v4, v18

    move-object/from16 v5, v19

    move-object/from16 v0, v27

    move-object/from16 v1, v28

    goto/16 :goto_1

    .end local v16    # "$i$f$forEachIndexed":I
    .end local v19    # "originalPackageName":Ljava/lang/String;
    .end local v27    # "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v28    # "$this$forEachIndexed$iv":Ljava/util/List;
    .local v0, "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v1, "$this$forEachIndexed$iv":Ljava/util/List;
    .local v2, "$i$f$forEachIndexed":I
    .restart local v5    # "originalPackageName":Ljava/lang/String;
    :cond_2
    move-object/from16 v27, v0

    move-object/from16 v28, v1

    move/from16 v16, v2

    move/from16 v18, v4

    move-object/from16 v19, v5

    .line 50
    .end local v0    # "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v1    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v2    # "$i$f$forEachIndexed":I
    .end local v5    # "originalPackageName":Ljava/lang/String;
    .end local v12    # "index$iv":I
    .restart local v16    # "$i$f$forEachIndexed":I
    .restart local v19    # "originalPackageName":Ljava/lang/String;
    .restart local v27    # "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v28    # "$this$forEachIndexed$iv":Ljava/util/List;
    nop

    .line 357
    .end local v10    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v11    # "$i$f$forEachIndexed":I
    nop

    .line 39
    .end local v6    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$adoptPermissions$1":I
    .end local v7    # "packageName":Ljava/lang/String;
    .end local v19    # "originalPackageName":Ljava/lang/String;
    :goto_3
    nop

    .line 38
    add-int/lit8 v3, v3, 0x1

    move/from16 v2, v16

    move/from16 v4, v18

    move-object/from16 v0, v27

    move-object/from16 v1, v28

    goto/16 :goto_0

    .end local v16    # "$i$f$forEachIndexed":I
    .end local v27    # "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v28    # "$this$forEachIndexed$iv":Ljava/util/List;
    .restart local v0    # "package":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v1    # "$this$forEachIndexed$iv":Ljava/util/List;
    .restart local v2    # "$i$f$forEachIndexed":I
    :cond_3
    nop

    .line 41
    .end local v3    # "index$iv":I
    nop

    .line 358
    .end local v1    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v2    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final canAdoptPermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Ljava/lang/String;)Z
    .locals 6
    .param p1, "$this$canAdoptPermissions"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageName"    # Ljava/lang/String;
    .param p3, "originalPackageName"    # Ljava/lang/String;

    .line 365
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v0

    invoke-interface {v0, p3}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/pm/pkg/PackageState;

    const/4 v1, 0x0

    if-nez v0, :cond_0

    return v1

    .line 364
    :cond_0
    nop

    .line 366
    .local v0, "originalPackageState":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v0}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v2

    const-string v3, " to "

    const-string v4, "Unable to adopt permissions from "

    if-nez v2, :cond_1

    .line 368
    sget-object v2, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 369
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": original package not in system partition"

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 367
    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 372
    return v1

    .line 374
    :cond_1
    invoke-interface {v0}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v2

    if-eqz v2, :cond_2

    .line 376
    sget-object v2, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 377
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, ": original package still exists"

    invoke-virtual {v5, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 375
    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 380
    return v1

    .line 382
    :cond_2
    const/4 v1, 0x1

    return v1
.end method

.method private final checkPrivilegedPermissionAllowlist(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z
    .locals 8
    .param p1, "$this$checkPrivilegedPermissionAllowlist"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "permission"    # Lcom/android/server/permission/access/permission/Permission;

    .line 1328
    sget-boolean v0, Lcom/android/internal/os/RoSystemProperties;->CONTROL_PRIVAPP_PERMISSIONS_DISABLE:Z

    const/4 v1, 0x1

    if-eqz v0, :cond_0

    .line 1329
    return v1

    .line 1331
    :cond_0
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v0

    const-string v2, "android"

    invoke-static {v0, v2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_1

    .line 1332
    return v1

    .line 1334
    :cond_1
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v0

    if-eqz v0, :cond_2

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isPrivileged()Z

    move-result v0

    if-nez v0, :cond_3

    :cond_2
    goto/16 :goto_0

    .line 1337
    :cond_3
    nop

    .line 1338
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getPrivilegedPermissionAllowlistPackages()Lcom/android/server/permission/access/immutable/IndexedListSet;

    move-result-object v0

    move-object v2, p3

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 36
    .local v3, "$i$f$getPackageName":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v4

    iget-object v2, v4, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 1338
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$getPackageName":I
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IndexedListSet;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_4

    .line 1340
    return v1

    .line 1342
    :cond_4
    move-object v0, p3

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 33
    .local v2, "$i$f$getName":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v3

    iget-object v0, v3, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1342
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$getName":I
    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPrivilegedPermissionAllowlistState(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v0

    .line 1343
    .local v0, "allowlistState":Ljava/lang/Boolean;
    if-eqz v0, :cond_5

    .line 1344
    invoke-virtual {v0}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v1

    return v1

    .line 1347
    :cond_5
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isUpdatedSystemApp()Z

    move-result v2

    if-eqz v2, :cond_6

    .line 1348
    return v1

    .line 1351
    :cond_6
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/ExternalState;->isSystemReady()Z

    move-result v2

    if-nez v2, :cond_7

    .line 1353
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isApkInUpdatedApex()Z

    move-result v2

    if-nez v2, :cond_7

    .line 1355
    sget-object v2, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1356
    move-object v3, p3

    .local v3, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 33
    .local v4, "$i$f$getName":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    iget-object v3, v5, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1357
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getName":I
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v4

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPath()Ljava/io/File;

    move-result-object v5

    new-instance v6, Ljava/lang/StringBuilder;

    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V

    const-string v7, "Privileged permission "

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " for package "

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " ("

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v3, ") not in privileged permission allowlist"

    invoke-virtual {v6, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 1354
    invoke-static {v2, v3}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1360
    nop

    .line 1367
    :cond_7
    return v1

    .line 1335
    .end local v0    # "allowlistState":Ljava/lang/Boolean;
    :goto_0
    return v1
.end method

.method private final clearRestrictedPermissionImplicitExemption(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;I)V
    .locals 28
    .param p1, "$this$clearRestrictedPermissionImplicitExemption"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "userId"    # I

    .line 180
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 181
    return-void

    .line 183
    :cond_0
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v0

    if-nez v0, :cond_1

    return-void

    .line 184
    .local v0, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :cond_1
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v8

    .line 185
    .local v8, "appId":I
    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v1

    move-object v9, v1

    .local v9, "$this$forEach$iv":Ljava/lang/Iterable;
    const/4 v10, 0x0

    .line 1928
    .local v10, "$i$f$forEach":I
    invoke-interface {v9}, Ljava/lang/Iterable;->iterator()Ljava/util/Iterator;

    move-result-object v11

    :goto_0
    invoke-interface {v11}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_d

    invoke-interface {v11}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v12

    .local v12, "element$iv":Ljava/lang/Object;
    move-object v13, v12

    check-cast v13, Ljava/lang/String;

    .local v13, "permissionName":Ljava/lang/String;
    const/4 v14, 0x0

    .line 186
    .local v14, "$i$a$-forEach-AppIdPermissionPolicy$clearRestrictedPermissionImplicitExemption$1":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v1

    invoke-virtual {v1, v13}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    move-object v5, v1

    check-cast v5, Lcom/android/server/permission/access/permission/Permission;

    if-nez v5, :cond_2

    move-object/from16 v18, v0

    goto/16 :goto_7

    .line 187
    .local v5, "permission":Lcom/android/server/permission/access/permission/Permission;
    :cond_2
    move-object v1, v5

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 141
    .local v2, "$i$f$isHardOrSoftRestricted":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 132
    .local v4, "$i$f$isHardRestricted":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v6

    iget v6, v6, Landroid/content/pm/PermissionInfo;->flags:I

    const/4 v7, 0x4

    invoke-static {v6, v7}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$isHardRestricted":I
    if-nez v3, :cond_4

    .line 141
    move-object v3, v1

    .restart local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v7, 0x0

    .line 138
    .local v7, "$i$f$isSoftRestricted":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v15

    iget v15, v15, Landroid/content/pm/PermissionInfo;->flags:I

    const/16 v4, 0x8

    invoke-static {v15, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v7    # "$i$f$isSoftRestricted":I
    if-eqz v3, :cond_3

    goto :goto_1

    :cond_3
    const/4 v3, 0x0

    goto :goto_2

    :cond_4
    :goto_1
    const/4 v3, 0x1

    .line 141
    :goto_2
    nop

    .line 187
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isHardOrSoftRestricted":I
    if-nez v3, :cond_5

    .line 188
    move-object/from16 v18, v0

    goto/16 :goto_7

    .line 191
    :cond_5
    nop

    .line 1440
    nop

    .line 1442
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    .line 1440
    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v2, 0x0

    .line 1445
    .local v2, "$i$f$anyPackageInAppId":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v3

    invoke-virtual {v3, v8}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .local v3, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v4, v3

    .local v4, "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v7, 0x0

    .line 29
    .local v7, "$i$f$anyIndexed":I
    move-object v15, v4

    .local v15, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v16, 0x0

    .line 38
    .local v16, "$i$f$forEachIndexed":I
    const/16 v17, 0x0

    .local v17, "index$iv$iv$iv":I
    invoke-virtual {v15}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v6

    move-object/from16 v18, v0

    move/from16 v0, v17

    .end local v17    # "index$iv$iv$iv":I
    .local v0, "index$iv$iv$iv":I
    .local v18, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :goto_3
    if-ge v0, v6, :cond_b

    .line 39
    invoke-virtual {v15, v0}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v17

    .local v17, "element$iv$iv":Ljava/lang/Object;
    move/from16 v19, v0

    .local v19, "index$iv$iv":I
    const/16 v20, 0x0

    .line 30
    .local v20, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move/from16 v21, v2

    .end local v2    # "$i$f$anyPackageInAppId":I
    .local v21, "$i$f$anyPackageInAppId":I
    move-object/from16 v2, v17

    check-cast v2, Ljava/lang/String;

    .local v2, "packageName$iv":Ljava/lang/String;
    const/16 v22, 0x0

    .line 1447
    .local v22, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v23

    move-object/from16 v24, v1

    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v24, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v23 .. v23}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface {v1, v2}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v1, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v23

    if-eqz v23, :cond_8

    move-object/from16 v23, v1

    .local v23, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v25, 0x0

    .line 192
    .local v25, "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$clearRestrictedPermissionImplicitExemption$1$isRequestedBySystemPackage$1":I
    invoke-interface/range {v23 .. v23}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v26

    if-eqz v26, :cond_6

    invoke-interface/range {v23 .. v23}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v26

    invoke-static/range {v26 .. v26}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object/from16 v27, v1

    .end local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .local v27, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface/range {v26 .. v26}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1, v13}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_7

    const/4 v1, 0x1

    goto :goto_4

    .end local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_6
    move-object/from16 v27, v1

    .end local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_7
    const/4 v1, 0x0

    .line 1448
    .end local v23    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v25    # "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$clearRestrictedPermissionImplicitExemption$1$isRequestedBySystemPackage$1":I
    :goto_4
    if-eqz v1, :cond_9

    const/4 v1, 0x1

    goto :goto_5

    .end local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_8
    move-object/from16 v27, v1

    .end local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_9
    const/4 v1, 0x0

    .line 30
    .end local v2    # "packageName$iv":Ljava/lang/String;
    .end local v22    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    .end local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :goto_5
    if-eqz v1, :cond_a

    .line 31
    const/4 v4, 0x1

    goto :goto_6

    .line 33
    :cond_a
    nop

    .line 39
    .end local v17    # "element$iv$iv":Ljava/lang/Object;
    .end local v19    # "index$iv$iv":I
    .end local v20    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v0, v0, 0x1

    move/from16 v2, v21

    move-object/from16 v1, v24

    goto :goto_3

    .end local v21    # "$i$f$anyPackageInAppId":I
    .end local v24    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v2, "$i$f$anyPackageInAppId":I
    :cond_b
    move-object/from16 v24, v1

    move/from16 v21, v2

    .line 41
    .end local v0    # "index$iv$iv$iv":I
    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v2    # "$i$f$anyPackageInAppId":I
    .restart local v21    # "$i$f$anyPackageInAppId":I
    .restart local v24    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 34
    .end local v15    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v16    # "$i$f$forEachIndexed":I
    const/4 v4, 0x0

    .line 1446
    .end local v4    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v7    # "$i$f$anyIndexed":I
    :goto_6
    nop

    .line 191
    .end local v3    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v21    # "$i$f$anyPackageInAppId":I
    .end local v24    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 190
    move v0, v4

    .line 194
    .local v0, "isRequestedBySystemPackage":Z
    if-eqz v0, :cond_c

    .line 195
    goto :goto_7

    .line 197
    :cond_c
    nop

    .line 198
    nop

    .line 199
    nop

    .line 200
    nop

    .line 201
    nop

    .line 202
    nop

    .line 197
    const/high16 v6, 0x20000

    const/4 v7, 0x0

    move-object/from16 v1, p0

    move-object/from16 v2, p1

    move v3, v8

    move/from16 v4, p3

    invoke-virtual/range {v1 .. v7}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->updatePermissionExemptFlags(Lcom/android/server/permission/access/MutateStateScope;IILcom/android/server/permission/access/permission/Permission;II)V

    .line 204
    nop

    .line 1928
    .end local v0    # "isRequestedBySystemPackage":Z
    .end local v5    # "permission":Lcom/android/server/permission/access/permission/Permission;
    .end local v13    # "permissionName":Ljava/lang/String;
    .end local v14    # "$i$a$-forEach-AppIdPermissionPolicy$clearRestrictedPermissionImplicitExemption$1":I
    :goto_7
    move-object/from16 v0, v18

    .end local v12    # "element$iv":Ljava/lang/Object;
    goto/16 :goto_0

    .line 1959
    .end local v18    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v0, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :cond_d
    nop

    .line 205
    .end local v9    # "$this$forEach$iv":Ljava/lang/Iterable;
    .end local v10    # "$i$f$forEach":I
    return-void
.end method

.method private final evaluateAllPermissionStatesForPackage(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/pm/pkg/PackageState;)V
    .locals 6
    .param p1, "$this$evaluateAllPermissionStatesForPackage"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "installedPackageState"    # Lcom/android/server/pm/pkg/PackageState;

    .line 805
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v0

    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v1, 0x0

    .line 38
    .local v1, "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .local v2, "index$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v3

    :goto_0
    if-ge v2, v3, :cond_0

    .line 39
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v4

    .local v4, "userId":I
    const/4 v5, 0x0

    .line 806
    .local v5, "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluateAllPermissionStatesForPackage$1":I
    nop

    .line 807
    nop

    .line 808
    nop

    .line 809
    nop

    .line 806
    invoke-direct {p0, p1, p2, v4, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluateAllPermissionStatesForPackageAndUser(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;ILcom/android/server/pm/pkg/PackageState;)V

    .line 811
    nop

    .line 39
    .end local v4    # "userId":I
    .end local v5    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluateAllPermissionStatesForPackage$1":I
    nop

    .line 38
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_0
    nop

    .line 41
    .end local v2    # "index$iv":I
    nop

    .line 812
    .end local v0    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v1    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final evaluateAllPermissionStatesForPackageAndUser(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;ILcom/android/server/pm/pkg/PackageState;)V
    .locals 12
    .param p1, "$this$evaluateAllPermissionStatesForPackageAndUser"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "userId"    # I
    .param p4, "installedPackageState"    # Lcom/android/server/pm/pkg/PackageState;

    .line 819
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v0

    if-eqz v0, :cond_1

    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v0

    if-eqz v0, :cond_1

    .local v0, "$this$forEach$iv":Ljava/lang/Iterable;
    const/4 v1, 0x0

    .line 2307
    .local v1, "$i$f$forEach":I
    invoke-interface {v0}, Ljava/lang/Iterable;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_0

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    .local v3, "element$iv":Ljava/lang/Object;
    move-object v10, v3

    check-cast v10, Ljava/lang/String;

    .local v10, "permissionName":Ljava/lang/String;
    const/4 v11, 0x0

    .line 820
    .local v11, "$i$a$-forEach-AppIdPermissionPolicy$evaluateAllPermissionStatesForPackageAndUser$1":I
    nop

    .line 821
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v6

    .line 822
    nop

    .line 823
    nop

    .line 824
    nop

    .line 820
    move-object v4, p0

    move-object v5, p1

    move v7, p3

    move-object v8, v10

    move-object/from16 v9, p4

    invoke-direct/range {v4 .. v9}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluatePermissionState(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V

    .line 826
    nop

    .line 2307
    .end local v10    # "permissionName":Ljava/lang/String;
    .end local v11    # "$i$a$-forEach-AppIdPermissionPolicy$evaluateAllPermissionStatesForPackageAndUser$1":I
    nop

    .end local v3    # "element$iv":Ljava/lang/Object;
    goto :goto_0

    .line 2308
    :cond_0
    nop

    .line 827
    .end local v0    # "$this$forEach$iv":Ljava/lang/Iterable;
    .end local v1    # "$i$f$forEach":I
    :cond_1
    return-void
.end method

.method private final evaluatePermissionState(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V
    .locals 45
    .param p1, "$this$evaluatePermissionState"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permissionName"    # Ljava/lang/String;
    .param p5, "installedPackageState"    # Lcom/android/server/pm/pkg/PackageState;

    .line 835
    move-object/from16 v6, p0

    move-object/from16 v7, p1

    move/from16 v8, p2

    move/from16 v9, p3

    move-object/from16 v10, p4

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, v8}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object v11, v0

    check-cast v11, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 839
    .local v11, "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    new-instance v0, Lcom/android/server/permission/access/immutable/MutableIndexedList;

    const/4 v1, 0x0

    const/4 v2, 0x1

    invoke-direct {v0, v1, v2, v1}, Lcom/android/server/permission/access/immutable/MutableIndexedList;-><init>(Ljava/util/ArrayList;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    move-object v12, v0

    .line 840
    .local v12, "requestingPackageStates":Lcom/android/server/permission/access/immutable/MutableIndexedList;
    const/4 v0, 0x0

    .line 841
    .local v0, "hasMissingPackage":Z
    move-object v1, v11

    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v3, 0x0

    .line 38
    .local v3, "$i$f$forEachIndexed":I
    const/4 v4, 0x0

    .local v4, "index$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v5

    move v13, v0

    .end local v0    # "hasMissingPackage":Z
    .local v13, "hasMissingPackage":Z
    :goto_0
    if-ge v4, v5, :cond_2

    .line 39
    invoke-virtual {v1, v4}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/String;

    .local v0, "packageName":Ljava/lang/String;
    const/4 v14, 0x0

    .line 842
    .local v14, "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluatePermissionState$1":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v15

    invoke-virtual {v15}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v15

    invoke-virtual {v15}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v15

    invoke-interface {v15, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v15

    invoke-static {v15}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v15, Lcom/android/server/pm/pkg/PackageState;

    .line 843
    .local v15, "packageState":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v15}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v16

    .line 844
    .local v16, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    if-eqz v16, :cond_0

    .line 845
    invoke-interface/range {v16 .. v16}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2, v10}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_1

    .line 846
    move-object v2, v12

    .local v2, "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedList;
    const/16 v18, 0x0

    .line 84
    .local v18, "$i$f$plusAssign":I
    invoke-virtual {v2, v15}, Lcom/android/server/permission/access/immutable/MutableIndexedList;->add(Ljava/lang/Object;)V

    .line 85
    nop

    .end local v2    # "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedList;
    .end local v18    # "$i$f$plusAssign":I
    goto :goto_1

    .line 849
    :cond_0
    const/4 v2, 0x1

    move v13, v2

    .line 851
    :cond_1
    :goto_1
    nop

    .line 39
    .end local v0    # "packageName":Ljava/lang/String;
    .end local v14    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluatePermissionState$1":I
    .end local v15    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v16    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    nop

    .line 38
    add-int/lit8 v4, v4, 0x1

    const/4 v2, 0x1

    goto :goto_0

    :cond_2
    nop

    .line 41
    .end local v4    # "index$iv":I
    nop

    .line 852
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v3    # "$i$f$forEachIndexed":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v0

    const/4 v1, 0x1

    if-ne v0, v1, :cond_3

    if-eqz v13, :cond_3

    .line 854
    return-void

    .line 856
    :cond_3
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v0

    invoke-virtual {v0, v10}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object v14, v0

    check-cast v14, Lcom/android/server/permission/access/permission/Permission;

    .line 857
    .local v14, "permission":Lcom/android/server/permission/access/permission/Permission;
    invoke-virtual/range {p0 .. p4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I

    move-result v15

    .line 858
    .local v15, "oldFlags":I
    if-nez v14, :cond_5

    .line 859
    if-nez v15, :cond_4

    .line 863
    const/4 v5, 0x2

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v3, p3

    move-object/from16 v4, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 865
    :cond_4
    return-void

    .line 867
    :cond_5
    move-object v0, v14

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 54
    .local v1, "$i$f$isNormal":I
    move-object v2, v0

    .local v2, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 48
    .local v3, "$i$f$getProtection":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v2

    .end local v2    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$getProtection":I
    if-nez v2, :cond_6

    const/4 v2, 0x1

    goto :goto_2

    :cond_6
    const/4 v2, 0x0

    .line 54
    :goto_2
    nop

    .line 867
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$isNormal":I
    const/4 v1, 0x2

    if-eqz v2, :cond_10

    .line 868
    const/4 v2, 0x1

    invoke-static {v15, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v16

    .line 869
    .local v16, "wasGranted":Z
    if-nez v16, :cond_f

    .line 870
    invoke-static {v15, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v18

    .line 872
    .local v18, "wasRevoked":Z
    if-eqz p5, :cond_7

    .line 874
    invoke-interface/range {p5 .. p5}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v2

    invoke-static {v2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v2}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v2

    .line 873
    invoke-interface {v2, v10}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_7

    const/4 v2, 0x1

    goto :goto_3

    :cond_7
    const/4 v2, 0x0

    .line 871
    :goto_3
    move/from16 v19, v2

    .line 876
    .local v19, "isRequestedByInstalledPackage":Z
    move-object v2, v12

    .local v2, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v4, 0x0

    .line 29
    .local v4, "$i$f$anyIndexed":I
    move-object v5, v2

    .local v5, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v20, 0x0

    .line 38
    .local v20, "$i$f$forEachIndexed":I
    const/16 v21, 0x0

    .local v21, "index$iv$iv":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v3

    move/from16 v1, v21

    .end local v21    # "index$iv$iv":I
    .local v1, "index$iv$iv":I
    :goto_4
    if-ge v1, v3, :cond_9

    .line 39
    invoke-virtual {v5, v1}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v21

    .local v21, "element$iv":Ljava/lang/Object;
    move/from16 v24, v1

    .local v24, "index$iv":I
    const/16 v25, 0x0

    .line 30
    .local v25, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v26, v21

    check-cast v26, Lcom/android/server/pm/pkg/PackageState;

    .local v26, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v27, 0x0

    .line 876
    .local v27, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isRequestedBySystemPackage$1":I
    invoke-interface/range {v26 .. v26}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v26

    .line 30
    .end local v26    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v27    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isRequestedBySystemPackage$1":I
    if-eqz v26, :cond_8

    .line 31
    const/4 v1, 0x1

    goto :goto_5

    .line 33
    :cond_8
    nop

    .line 39
    .end local v21    # "element$iv":Ljava/lang/Object;
    .end local v24    # "index$iv":I
    .end local v25    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v1, v1, 0x1

    goto :goto_4

    :cond_9
    nop

    .line 41
    .end local v1    # "index$iv$iv":I
    nop

    .line 34
    .end local v5    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v20    # "$i$f$forEachIndexed":I
    const/4 v1, 0x0

    .line 876
    .end local v2    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v4    # "$i$f$anyIndexed":I
    :goto_5
    nop

    .line 875
    move/from16 v20, v1

    .line 878
    .local v20, "isRequestedBySystemPackage":Z
    move-object v1, v12

    .local v1, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v2, 0x0

    .line 29
    .local v2, "$i$f$anyIndexed":I
    move-object v3, v1

    .local v3, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v4, 0x0

    .line 38
    .local v4, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .local v5, "index$iv$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v0

    :goto_6
    if-ge v5, v0, :cond_b

    .line 39
    invoke-virtual {v3, v5}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v24

    .local v24, "element$iv":Ljava/lang/Object;
    move/from16 v25, v5

    .local v25, "index$iv":I
    const/16 v26, 0x0

    .line 30
    .local v26, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v27, v24

    check-cast v27, Lcom/android/server/pm/pkg/PackageState;

    .local v27, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v28, 0x0

    .line 879
    .local v28, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isCompatibilityPermission$1":I
    move/from16 v29, v0

    invoke-interface/range {v27 .. v27}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-direct {v6, v0, v10}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->isCompatibilityPermissionForPackage(Lcom/android/server/pm/pkg/AndroidPackage;Ljava/lang/String;)Z

    move-result v0

    .line 30
    .end local v27    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v28    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isCompatibilityPermission$1":I
    if-eqz v0, :cond_a

    .line 31
    const/16 v22, 0x1

    goto :goto_7

    .line 33
    :cond_a
    nop

    .line 39
    .end local v24    # "element$iv":Ljava/lang/Object;
    .end local v25    # "index$iv":I
    .end local v26    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v5, v5, 0x1

    move/from16 v0, v29

    goto :goto_6

    :cond_b
    nop

    .line 41
    .end local v5    # "index$iv$iv":I
    nop

    .line 34
    .end local v3    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v4    # "$i$f$forEachIndexed":I
    const/16 v22, 0x0

    .line 878
    .end local v1    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v2    # "$i$f$anyIndexed":I
    :goto_7
    nop

    .line 877
    nop

    .line 885
    .local v22, "isCompatibilityPermission":Z
    nop

    .line 886
    if-eqz v18, :cond_d

    .line 887
    if-nez v19, :cond_d

    .line 888
    if-nez v20, :cond_d

    .line 889
    if-eqz v22, :cond_c

    goto :goto_8

    .line 893
    :cond_c
    const/4 v2, 0x2

    goto :goto_9

    .line 891
    :cond_d
    :goto_8
    const/4 v2, 0x1

    .line 885
    :goto_9
    nop

    .line 884
    move v0, v2

    .line 895
    .local v0, "newFlags":I
    move-object v1, v14

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 66
    .local v2, "$i$f$isAppOp":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 63
    .local v4, "$i$f$getProtectionFlags":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v3

    .line 66
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtectionFlags":I
    const/16 v4, 0x40

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 895
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isAppOp":I
    if-eqz v1, :cond_e

    .line 897
    nop

    .line 898
    and-int/lit8 v1, v15, 0x28

    .line 897
    or-int/2addr v1, v0

    .line 896
    move v0, v1

    move/from16 v17, v0

    goto :goto_a

    .line 895
    :cond_e
    move/from16 v17, v0

    .line 900
    .end local v0    # "newFlags":I
    .local v17, "newFlags":I
    :goto_a
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v3, p3

    move-object/from16 v4, p4

    move/from16 v5, v17

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    move-object/from16 v32, v11

    move/from16 v38, v13

    move v11, v15

    goto/16 :goto_37

    .line 869
    .end local v17    # "newFlags":I
    .end local v18    # "wasRevoked":Z
    .end local v19    # "isRequestedByInstalledPackage":Z
    .end local v20    # "isRequestedBySystemPackage":Z
    .end local v22    # "isCompatibilityPermission":Z
    :cond_f
    move-object/from16 v32, v11

    move/from16 v38, v13

    move v11, v15

    goto/16 :goto_37

    .line 902
    .end local v16    # "wasGranted":Z
    :cond_10
    move-object v0, v14

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 60
    .local v1, "$i$f$isSignature":I
    move-object v2, v0

    .local v2, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 48
    .local v3, "$i$f$getProtection":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v4

    invoke-virtual {v4}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v2

    .line 60
    .end local v2    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$getProtection":I
    const/4 v3, 0x2

    if-ne v2, v3, :cond_11

    const/4 v0, 0x1

    goto :goto_b

    :cond_11
    const/4 v0, 0x0

    .line 902
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$isSignature":I
    :goto_b
    const/4 v1, 0x4

    if-nez v0, :cond_3f

    move-object v0, v14

    .restart local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 51
    .local v2, "$i$f$isInternal":I
    move-object v3, v0

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 48
    .local v4, "$i$f$getProtection":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v3

    .line 51
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtection":I
    if-ne v3, v1, :cond_12

    const/4 v0, 0x1

    goto :goto_c

    :cond_12
    const/4 v0, 0x0

    .line 902
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isInternal":I
    :goto_c
    if-eqz v0, :cond_13

    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    goto/16 :goto_2a

    .line 951
    :cond_13
    move-object v0, v14

    .restart local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 57
    .local v2, "$i$f$isRuntime":I
    move-object v3, v0

    .restart local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 48
    .restart local v4    # "$i$f$getProtection":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v3

    .line 57
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtection":I
    const/4 v4, 0x1

    if-ne v3, v4, :cond_14

    const/4 v0, 0x1

    goto :goto_d

    :cond_14
    const/4 v0, 0x0

    .line 951
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isRuntime":I
    :goto_d
    if-eqz v0, :cond_3e

    .line 952
    const v0, 0xfffff8

    and-int/2addr v0, v15

    .line 953
    .local v0, "newFlags":I
    if-eqz v0, :cond_15

    sget-object v2, Lcom/android/server/permission/access/permission/PermissionFlags;->INSTANCE:Lcom/android/server/permission/access/permission/PermissionFlags;

    invoke-virtual {v2, v0}, Lcom/android/server/permission/access/permission/PermissionFlags;->isPermissionGranted(I)Z

    move-result v2

    if-nez v2, :cond_15

    const/4 v2, 0x1

    goto :goto_e

    :cond_15
    const/4 v2, 0x0

    :goto_e
    move/from16 v16, v2

    .line 955
    .local v16, "wasRevoked":Z
    move-object v2, v12

    .local v2, "$this$reduceIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v3, 0x2710

    .local v3, "initialValue$iv":I
    const/4 v4, 0x0

    .line 72
    .local v4, "$i$f$reduceIndexed":I
    const/4 v5, 0x0

    .local v5, "value$iv":I
    move v5, v3

    .line 73
    move-object/from16 v18, v2

    .local v18, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v19, 0x0

    .line 38
    .local v19, "$i$f$forEachIndexed":I
    const/16 v20, 0x0

    .local v20, "index$iv$iv":I
    invoke-virtual/range {v18 .. v18}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v1

    move/from16 v44, v20

    move-object/from16 v20, v2

    move/from16 v2, v44

    .local v2, "index$iv$iv":I
    .local v20, "$this$reduceIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :goto_f
    if-ge v2, v1, :cond_16

    .line 39
    move/from16 v21, v1

    move-object/from16 v1, v18

    .end local v18    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v1, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    invoke-virtual {v1, v2}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v18

    .local v18, "element$iv":Ljava/lang/Object;
    move/from16 v23, v2

    .local v23, "index$iv":I
    const/16 v25, 0x0

    .line 73
    .local v25, "$i$a$-forEachIndexed-IndexedListExtensionsKt$reduceIndexed$1$iv":I
    move-object/from16 v26, v18

    check-cast v26, Lcom/android/server/pm/pkg/PackageState;

    .local v26, "packageState":Lcom/android/server/pm/pkg/PackageState;
    move/from16 v27, v5

    .local v27, "targetSdkVersion":I
    move/from16 v28, v27

    .end local v27    # "targetSdkVersion":I
    .local v28, "targetSdkVersion":I
    const/16 v27, 0x0

    .line 959
    .local v27, "$i$a$-reduceIndexed-AppIdPermissionPolicy$evaluatePermissionState$targetSdkVersion$1":I
    invoke-interface/range {v26 .. v26}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v29

    invoke-static/range {v29 .. v29}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object/from16 v30, v1

    .end local v1    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v30, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    invoke-interface/range {v29 .. v29}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v1

    move/from16 v29, v3

    move/from16 v3, v28

    .end local v28    # "targetSdkVersion":I
    .local v3, "targetSdkVersion":I
    .local v29, "initialValue$iv":I
    invoke-static {v3, v1}, Lcom/android/server/permission/jarjar/kotlin/ranges/RangesKt;->coerceAtMost(II)I

    move-result v1

    .line 73
    .end local v3    # "targetSdkVersion":I
    .end local v26    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v27    # "$i$a$-reduceIndexed-AppIdPermissionPolicy$evaluatePermissionState$targetSdkVersion$1":I
    move v5, v1

    .line 39
    .end local v18    # "element$iv":Ljava/lang/Object;
    .end local v23    # "index$iv":I
    .end local v25    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$reduceIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v2, v2, 0x1

    move/from16 v1, v21

    move/from16 v3, v29

    move-object/from16 v18, v30

    goto :goto_f

    .end local v29    # "initialValue$iv":I
    .end local v30    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v3, "initialValue$iv":I
    .local v18, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :cond_16
    move/from16 v29, v3

    move-object/from16 v30, v18

    .line 41
    .end local v2    # "index$iv$iv":I
    .end local v3    # "initialValue$iv":I
    .end local v18    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .restart local v29    # "initialValue$iv":I
    .restart local v30    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    nop

    .line 74
    .end local v19    # "$i$f$forEachIndexed":I
    .end local v30    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    nop

    .line 955
    .end local v4    # "$i$f$reduceIndexed":I
    .end local v5    # "value$iv":I
    .end local v20    # "$this$reduceIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v29    # "initialValue$iv":I
    nop

    .line 954
    move v4, v5

    .line 961
    .local v4, "targetSdkVersion":I
    const/16 v1, 0x17

    const v2, 0x38000

    if-ge v4, v1, :cond_1b

    .line 962
    move-object v1, v14

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v18, 0x0

    .line 117
    .local v18, "$i$f$isRuntimeOnly":I
    move-object/from16 v19, v1

    .local v19, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v20, 0x0

    .line 63
    .local v20, "$i$f$getProtectionFlags":I
    invoke-virtual/range {v19 .. v19}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v21

    invoke-virtual/range {v21 .. v21}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v3

    .line 117
    .end local v19    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v20    # "$i$f$getProtectionFlags":I
    const/16 v5, 0x2000

    invoke-static {v3, v5}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 962
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v18    # "$i$f$isRuntimeOnly":I
    if-eqz v1, :cond_17

    .line 967
    and-int/2addr v0, v2

    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    goto/16 :goto_21

    .line 969
    :cond_17
    const/16 v1, 0x400

    or-int/2addr v0, v1

    .line 970
    if-eqz v16, :cond_18

    .line 971
    const/high16 v1, 0x100000

    or-int/2addr v0, v1

    .line 976
    :cond_18
    invoke-direct/range {p0 .. p4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getOldStatePermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;)I

    move-result v1

    if-nez v1, :cond_19

    const/4 v1, 0x1

    goto :goto_10

    :cond_19
    const/4 v1, 0x0

    .line 975
    :goto_10
    nop

    .line 977
    .local v1, "isNewPermission":Z
    if-eqz v1, :cond_1a

    .line 978
    or-int/lit16 v0, v0, 0x1000

    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    .end local v1    # "isNewPermission":Z
    goto/16 :goto_21

    .line 977
    .restart local v1    # "isNewPermission":Z
    :cond_1a
    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    goto/16 :goto_21

    .line 982
    .end local v1    # "isNewPermission":Z
    :cond_1b
    const/16 v1, 0x400

    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 983
    .local v3, "wasGrantedByLegacy":Z
    const/16 v5, 0x1000

    invoke-static {v0, v5}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v18

    .line 984
    .local v18, "hasImplicitFlag":Z
    if-eqz v3, :cond_1c

    .line 985
    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    .line 986
    if-nez v18, :cond_1c

    .line 987
    or-int/lit8 v0, v0, 0x10

    .line 990
    :cond_1c
    const/16 v1, 0x800

    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v19

    .line 992
    .local v19, "wasGrantedByImplicit":Z
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v20

    invoke-virtual/range {v20 .. v20}, Lcom/android/server/permission/access/ExternalState;->isLeanback()Z

    move-result v20

    if-eqz v20, :cond_1d

    sget-object v2, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->NOTIFICATIONS_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    invoke-virtual {v2, v10}, Lcom/android/server/permission/access/immutable/IndexedSet;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_1d

    const/4 v2, 0x1

    goto :goto_11

    :cond_1d
    const/4 v2, 0x0

    .line 991
    :goto_11
    nop

    .line 994
    .local v2, "isLeanbackNotificationsPermission":Z
    move-object/from16 v21, v12

    .local v21, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v25, 0x0

    .line 29
    .local v25, "$i$f$anyIndexed":I
    move-object/from16 v26, v21

    .local v26, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v27, 0x0

    .line 38
    .local v27, "$i$f$forEachIndexed":I
    const/16 v28, 0x0

    .local v28, "index$iv$iv":I
    invoke-virtual/range {v26 .. v26}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v5

    move/from16 v1, v28

    .end local v28    # "index$iv$iv":I
    .local v1, "index$iv$iv":I
    :goto_12
    if-ge v1, v5, :cond_1f

    .line 39
    move/from16 v28, v5

    move-object/from16 v5, v26

    .end local v26    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v5, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    invoke-virtual {v5, v1}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v26

    .local v26, "element$iv":Ljava/lang/Object;
    move/from16 v31, v1

    .local v31, "index$iv":I
    const/16 v32, 0x0

    .line 30
    .local v32, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v33, v26

    check-cast v33, Lcom/android/server/pm/pkg/PackageState;

    .local v33, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v34, 0x0

    .line 995
    .local v34, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isImplicitPermission$1":I
    invoke-interface/range {v33 .. v33}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v35

    invoke-static/range {v35 .. v35}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object/from16 v36, v5

    .end local v5    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v36, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    invoke-interface/range {v35 .. v35}, Lcom/android/server/pm/pkg/AndroidPackage;->getImplicitPermissions()Ljava/util/Set;

    move-result-object v5

    invoke-interface {v5, v10}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v5

    .line 30
    .end local v33    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v34    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isImplicitPermission$1":I
    if-eqz v5, :cond_1e

    .line 31
    const/4 v1, 0x1

    goto :goto_13

    .line 33
    :cond_1e
    nop

    .line 39
    .end local v26    # "element$iv":Ljava/lang/Object;
    .end local v31    # "index$iv":I
    .end local v32    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v1, v1, 0x1

    move/from16 v5, v28

    move-object/from16 v26, v36

    goto :goto_12

    .end local v36    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v26, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :cond_1f
    move-object/from16 v36, v26

    .line 41
    .end local v1    # "index$iv$iv":I
    .end local v26    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .restart local v36    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    nop

    .line 34
    .end local v27    # "$i$f$forEachIndexed":I
    .end local v36    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v1, 0x0

    .line 994
    .end local v21    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v25    # "$i$f$anyIndexed":I
    :goto_13
    nop

    .line 993
    nop

    .line 998
    .local v1, "isImplicitPermission":Z
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getImplicitToSourcePermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v5

    invoke-virtual {v5, v10}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 997
    nop

    .line 1000
    .local v5, "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    if-eqz v5, :cond_24

    move-object/from16 v21, v5

    .local v21, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v25, 0x0

    .line 29
    .restart local v25    # "$i$f$anyIndexed":I
    move-object/from16 v26, v21

    .local v26, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v27, 0x0

    .line 38
    .restart local v27    # "$i$f$forEachIndexed":I
    const/16 v28, 0x0

    move-object/from16 v31, v5

    .end local v5    # "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v28    # "index$iv$iv":I
    .local v31, "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    invoke-virtual/range {v26 .. v26}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v5

    move-object/from16 v32, v11

    move/from16 v11, v28

    .end local v28    # "index$iv$iv":I
    .local v11, "index$iv$iv":I
    .local v32, "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :goto_14
    if-ge v11, v5, :cond_23

    .line 39
    move/from16 v28, v5

    move-object/from16 v5, v26

    .end local v26    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v5, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    invoke-virtual {v5, v11}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v26

    .local v26, "element$iv":Ljava/lang/Object;
    move/from16 v33, v11

    .local v33, "index$iv":I
    const/16 v34, 0x0

    .line 30
    .local v34, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v35, v5

    .end local v5    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v35, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object/from16 v5, v26

    check-cast v5, Ljava/lang/String;

    .local v5, "sourcePermissionName":Ljava/lang/String;
    const/16 v36, 0x0

    .line 1002
    .local v36, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isAnySourcePermissionNonRuntime$1":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v37

    invoke-virtual/range {v37 .. v37}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v37

    move/from16 v38, v13

    .end local v13    # "hasMissingPackage":Z
    .local v38, "hasMissingPackage":Z
    invoke-virtual/range {v37 .. v37}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v13

    invoke-virtual {v13, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/permission/access/permission/Permission;

    .line 1001
    nop

    .line 1003
    .local v13, "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    if-eqz v13, :cond_22

    .line 1006
    move-object/from16 v37, v13

    .local v37, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v39, 0x0

    .line 57
    .local v39, "$i$f$isRuntime":I
    move-object/from16 v40, v37

    .local v40, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/16 v41, 0x0

    .line 48
    .local v41, "$i$f$getProtection":I
    invoke-virtual/range {v40 .. v40}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v42

    move-object/from16 v43, v13

    .end local v13    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .local v43, "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    invoke-virtual/range {v42 .. v42}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v13

    .line 57
    .end local v40    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v41    # "$i$f$getProtection":I
    move/from16 v40, v15

    const/4 v15, 0x1

    .end local v15    # "oldFlags":I
    .local v40, "oldFlags":I
    if-ne v13, v15, :cond_20

    move v13, v15

    goto :goto_15

    :cond_20
    const/4 v13, 0x0

    .line 1006
    .end local v37    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v39    # "$i$f$isRuntime":I
    :goto_15
    xor-int/2addr v13, v15

    .line 30
    .end local v5    # "sourcePermissionName":Ljava/lang/String;
    .end local v36    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isAnySourcePermissionNonRuntime$1":I
    .end local v43    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    if-eqz v13, :cond_21

    .line 31
    move v5, v15

    goto :goto_16

    .line 33
    :cond_21
    nop

    .line 39
    .end local v26    # "element$iv":Ljava/lang/Object;
    .end local v33    # "index$iv":I
    .end local v34    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v11, v11, 0x1

    move/from16 v5, v28

    move-object/from16 v26, v35

    move/from16 v13, v38

    move/from16 v15, v40

    goto :goto_14

    .line 1003
    .end local v40    # "oldFlags":I
    .restart local v5    # "sourcePermissionName":Ljava/lang/String;
    .restart local v13    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v15    # "oldFlags":I
    .restart local v26    # "element$iv":Ljava/lang/Object;
    .restart local v33    # "index$iv":I
    .restart local v34    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv":I
    .restart local v36    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isAnySourcePermissionNonRuntime$1":I
    :cond_22
    move-object/from16 v43, v13

    move/from16 v40, v15

    .end local v13    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v15    # "oldFlags":I
    .restart local v40    # "oldFlags":I
    .restart local v43    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    const/4 v13, 0x0

    .line 1004
    .local v13, "$i$a$-checkNotNull-AppIdPermissionPolicy$evaluatePermissionState$isAnySourcePermissionNonRuntime$1$1":I
    new-instance v15, Ljava/lang/StringBuilder;

    invoke-direct {v15}, Ljava/lang/StringBuilder;-><init>()V

    move/from16 v17, v11

    .end local v11    # "index$iv$iv":I
    .local v17, "index$iv$iv":I
    const-string v11, "Unknown source permission "

    invoke-virtual {v15, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, " in split permissions"

    invoke-virtual {v15, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v15}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    .line 1003
    .end local v13    # "$i$a$-checkNotNull-AppIdPermissionPolicy$evaluatePermissionState$isAnySourcePermissionNonRuntime$1$1":I
    new-instance v13, Ljava/lang/IllegalStateException;

    invoke-virtual {v11}, Ljava/lang/Object;->toString()Ljava/lang/String;

    move-result-object v11

    invoke-direct {v13, v11}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v13

    .line 38
    .end local v5    # "sourcePermissionName":Ljava/lang/String;
    .end local v17    # "index$iv$iv":I
    .end local v33    # "index$iv":I
    .end local v34    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv":I
    .end local v35    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v36    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isAnySourcePermissionNonRuntime$1":I
    .end local v38    # "hasMissingPackage":Z
    .end local v40    # "oldFlags":I
    .end local v43    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v11    # "index$iv$iv":I
    .local v13, "hasMissingPackage":Z
    .restart local v15    # "oldFlags":I
    .local v26, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :cond_23
    move/from16 v17, v11

    move/from16 v38, v13

    move/from16 v40, v15

    move-object/from16 v35, v26

    const/4 v15, 0x1

    .line 41
    .end local v11    # "index$iv$iv":I
    .end local v13    # "hasMissingPackage":Z
    .end local v15    # "oldFlags":I
    .end local v26    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v35    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v38    # "hasMissingPackage":Z
    .restart local v40    # "oldFlags":I
    nop

    .line 34
    .end local v27    # "$i$f$forEachIndexed":I
    .end local v35    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v5, 0x0

    .line 1000
    .end local v21    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v25    # "$i$f$anyIndexed":I
    :goto_16
    goto :goto_17

    .line 1008
    .end local v31    # "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v32    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v38    # "hasMissingPackage":Z
    .end local v40    # "oldFlags":I
    .local v5, "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v11, "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v13    # "hasMissingPackage":Z
    .restart local v15    # "oldFlags":I
    :cond_24
    move-object/from16 v31, v5

    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    const/4 v15, 0x1

    .end local v5    # "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v11    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v13    # "hasMissingPackage":Z
    .end local v15    # "oldFlags":I
    .restart local v31    # "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v32    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v38    # "hasMissingPackage":Z
    .restart local v40    # "oldFlags":I
    const/4 v5, 0x0

    .line 1000
    :goto_17
    nop

    .line 999
    nop

    .line 1010
    .local v5, "isAnySourcePermissionNonRuntime":Z
    if-nez v2, :cond_26

    .line 1011
    if-eqz v1, :cond_25

    if-eqz v5, :cond_25

    goto :goto_18

    :cond_25
    const/4 v11, 0x0

    goto :goto_19

    :cond_26
    :goto_18
    move v11, v15

    .line 1009
    :goto_19
    nop

    .line 1012
    .local v11, "shouldGrantByImplicit":Z
    if-eqz v11, :cond_27

    .line 1013
    const/16 v13, 0x800

    or-int/2addr v0, v13

    .line 1014
    if-eqz v16, :cond_29

    .line 1015
    const/high16 v13, 0x100000

    or-int/2addr v0, v13

    goto :goto_1a

    .line 1018
    :cond_27
    const/16 v13, 0x800

    invoke-static {v0, v13}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    .line 1019
    nop

    .line 1020
    if-nez v3, :cond_28

    if-eqz v19, :cond_29

    .line 1021
    :cond_28
    const/high16 v13, 0x100000

    invoke-static {v0, v13}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v13

    if-eqz v13, :cond_29

    .line 1030
    nop

    .line 1031
    nop

    .line 1030
    const v13, 0x100010

    invoke-static {v0, v13}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v13

    .line 1029
    move v0, v13

    .line 1034
    :cond_29
    :goto_1a
    if-nez v1, :cond_2e

    if-eqz v18, :cond_2e

    .line 1035
    const/16 v13, 0x1000

    invoke-static {v0, v13}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    .line 1036
    const/4 v13, 0x0

    .line 1037
    .local v13, "shouldRetainAsNearbyDevices":Z
    sget-object v15, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->NEARBY_DEVICES_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    invoke-virtual {v15, v10}, Lcom/android/server/permission/access/immutable/IndexedSet;->contains(Ljava/lang/Object;)Z

    move-result v15

    if-eqz v15, :cond_2b

    .line 1039
    nop

    .line 1040
    nop

    .line 1041
    nop

    .line 1042
    nop

    .line 1039
    const-string v15, "android.permission.ACCESS_BACKGROUND_LOCATION"

    invoke-virtual {v6, v7, v8, v9, v15}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I

    move-result v15

    .line 1038
    nop

    .line 1045
    .local v15, "accessBackgroundLocationFlags":I
    move/from16 v21, v2

    .end local v2    # "isLeanbackNotificationsPermission":Z
    .local v21, "isLeanbackNotificationsPermission":Z
    sget-object v2, Lcom/android/server/permission/access/permission/PermissionFlags;->INSTANCE:Lcom/android/server/permission/access/permission/PermissionFlags;

    invoke-virtual {v2, v15}, Lcom/android/server/permission/access/permission/PermissionFlags;->isAppOpGranted(I)Z

    move-result v2

    if-eqz v2, :cond_2a

    .line 1046
    const/16 v2, 0x1000

    invoke-static {v15, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v2

    if-nez v2, :cond_2a

    const/4 v2, 0x1

    goto :goto_1b

    :cond_2a
    const/4 v2, 0x0

    .line 1044
    :goto_1b
    move v13, v2

    goto :goto_1c

    .line 1037
    .end local v15    # "accessBackgroundLocationFlags":I
    .end local v21    # "isLeanbackNotificationsPermission":Z
    .restart local v2    # "isLeanbackNotificationsPermission":Z
    :cond_2b
    move/from16 v21, v2

    .line 1048
    .end local v2    # "isLeanbackNotificationsPermission":Z
    .restart local v21    # "isLeanbackNotificationsPermission":Z
    :goto_1c
    const/16 v2, 0x180

    invoke-static {v0, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasAnyBit(II)Z

    move-result v2

    .line 1049
    .local v2, "shouldRetainByMask":Z
    if-nez v13, :cond_2c

    if-eqz v2, :cond_2d

    :cond_2c
    goto :goto_1d

    .line 1055
    :cond_2d
    nop

    .line 1056
    nop

    .line 1055
    const/16 v15, 0x70

    invoke-static {v0, v15}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v15

    .line 1054
    move v0, v15

    goto :goto_1e

    .line 1050
    :goto_1d
    if-eqz v19, :cond_2f

    .line 1051
    or-int/lit8 v0, v0, 0x10

    goto :goto_1e

    .line 1034
    .end local v13    # "shouldRetainAsNearbyDevices":Z
    .end local v21    # "isLeanbackNotificationsPermission":Z
    .local v2, "isLeanbackNotificationsPermission":Z
    :cond_2e
    move/from16 v21, v2

    .line 1062
    .end local v2    # "isLeanbackNotificationsPermission":Z
    .restart local v21    # "isLeanbackNotificationsPermission":Z
    :cond_2f
    :goto_1e
    const-string v2, "com.android.permission.GET_INSTALLED_APPS"

    invoke-static {v2, v10}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_33

    .line 1064
    move-object v2, v12

    .local v2, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v13, 0x0

    .line 29
    .local v13, "$i$f$anyIndexed":I
    move-object v15, v2

    .local v15, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v23, 0x0

    .line 38
    .local v23, "$i$f$forEachIndexed":I
    const/16 v25, 0x0

    move-object/from16 v26, v2

    .end local v2    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v25, "index$iv$iv":I
    .local v26, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    invoke-virtual {v15}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v2

    move/from16 v27, v3

    move/from16 v3, v25

    .end local v25    # "index$iv$iv":I
    .local v3, "index$iv$iv":I
    .local v27, "wasGrantedByLegacy":Z
    :goto_1f
    if-ge v3, v2, :cond_31

    .line 39
    invoke-virtual {v15, v3}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v25

    .local v25, "element$iv":Ljava/lang/Object;
    move/from16 v28, v3

    .local v28, "index$iv":I
    const/16 v29, 0x0

    .line 30
    .local v29, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v30, v25

    check-cast v30, Lcom/android/server/pm/pkg/PackageState;

    .local v30, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v33, 0x0

    .line 1065
    .local v33, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isSystem$1":I
    invoke-interface/range {v30 .. v30}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v34

    invoke-interface/range {v30 .. v30}, Lcom/android/server/pm/pkg/PackageState;->isUpdatedSystemApp()Z

    move-result v35

    or-int v30, v34, v35

    .line 30
    .end local v30    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v33    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$isSystem$1":I
    if-eqz v30, :cond_30

    .line 31
    const/4 v2, 0x1

    goto :goto_20

    .line 33
    :cond_30
    nop

    .line 39
    .end local v25    # "element$iv":Ljava/lang/Object;
    .end local v28    # "index$iv":I
    .end local v29    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v3, v3, 0x1

    goto :goto_1f

    :cond_31
    nop

    .line 41
    .end local v3    # "index$iv$iv":I
    nop

    .line 34
    .end local v15    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v23    # "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .line 1064
    .end local v13    # "$i$f$anyIndexed":I
    .end local v26    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :goto_20
    nop

    .line 1063
    nop

    .line 1067
    .local v2, "isSystem":Z
    if-nez v2, :cond_32

    const/16 v3, 0x16

    if-gt v4, v3, :cond_34

    .line 1068
    :cond_32
    if-eqz v1, :cond_34

    .line 1069
    or-int/lit8 v0, v0, 0x10

    goto :goto_21

    .line 1062
    .end local v2    # "isSystem":Z
    .end local v27    # "wasGrantedByLegacy":Z
    .local v3, "wasGrantedByLegacy":Z
    :cond_33
    move/from16 v27, v3

    .line 1075
    .end local v1    # "isImplicitPermission":Z
    .end local v3    # "wasGrantedByLegacy":Z
    .end local v5    # "isAnySourcePermissionNonRuntime":Z
    .end local v11    # "shouldGrantByImplicit":Z
    .end local v18    # "hasImplicitFlag":Z
    .end local v19    # "wasGrantedByImplicit":Z
    .end local v21    # "isLeanbackNotificationsPermission":Z
    .end local v31    # "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :cond_34
    :goto_21
    const v1, 0x38000

    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasAnyBit(II)Z

    move-result v11

    .line 1076
    .local v11, "wasExempt":Z
    const/high16 v1, 0xc0000

    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasAnyBit(II)Z

    move-result v13

    .line 1078
    .local v13, "wasRestricted":Z
    move-object v1, v14

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 141
    .local v2, "$i$f$isHardOrSoftRestricted":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v5, 0x0

    .line 132
    .local v5, "$i$f$isHardRestricted":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v15

    iget v15, v15, Landroid/content/pm/PermissionInfo;->flags:I

    move/from16 v18, v2

    const/4 v2, 0x4

    .end local v2    # "$i$f$isHardOrSoftRestricted":I
    .local v18, "$i$f$isHardOrSoftRestricted":I
    invoke-static {v15, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v5    # "$i$f$isHardRestricted":I
    const/16 v2, 0x8

    if-nez v3, :cond_36

    .line 141
    move-object v3, v1

    .restart local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v5, 0x0

    .line 138
    .local v5, "$i$f$isSoftRestricted":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v15

    iget v15, v15, Landroid/content/pm/PermissionInfo;->flags:I

    invoke-static {v15, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v5    # "$i$f$isSoftRestricted":I
    if-eqz v3, :cond_35

    goto :goto_22

    :cond_35
    const/4 v3, 0x0

    goto :goto_23

    :cond_36
    :goto_22
    const/4 v3, 0x1

    .line 141
    :goto_23
    nop

    .line 1078
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v18    # "$i$f$isHardOrSoftRestricted":I
    if-eqz v3, :cond_37

    if-nez v11, :cond_37

    if-nez v13, :cond_37

    .line 1092
    const/high16 v1, 0x20000

    or-int/2addr v0, v1

    .line 1093
    const/4 v1, 0x1

    goto :goto_24

    .line 1095
    :cond_37
    move v1, v11

    .line 1078
    :goto_24
    nop

    .line 1077
    move v15, v1

    .line 1098
    .local v15, "isExempt":Z
    move-object v1, v14

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 132
    .local v3, "$i$f$isHardRestricted":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    iget v5, v5, Landroid/content/pm/PermissionInfo;->flags:I

    const/4 v2, 0x4

    invoke-static {v5, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 1098
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$isHardRestricted":I
    const/high16 v2, 0x40000

    if-eqz v1, :cond_38

    if-nez v15, :cond_38

    .line 1099
    or-int v1, v0, v2

    goto :goto_25

    .line 1101
    :cond_38
    invoke-static {v0, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v1

    .line 1097
    :goto_25
    move v0, v1

    .line 1104
    nop

    .line 1105
    move-object v1, v14

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 138
    .local v2, "$i$f$isSoftRestricted":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v3

    iget v3, v3, Landroid/content/pm/PermissionInfo;->flags:I

    const/16 v5, 0x8

    invoke-static {v3, v5}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 1105
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isSoftRestricted":I
    if-eqz v1, :cond_3d

    .line 1106
    if-nez v15, :cond_3c

    .line 1107
    move-object v1, v12

    .local v1, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v3, 0x0

    .line 29
    .local v3, "$i$f$anyIndexed":I
    move-object v5, v1

    .local v5, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/16 v18, 0x0

    .line 38
    .local v18, "$i$f$forEachIndexed":I
    const/16 v19, 0x0

    .local v19, "index$iv$iv":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v2

    move-object/from16 v21, v1

    move/from16 v1, v19

    .end local v19    # "index$iv$iv":I
    .local v1, "index$iv$iv":I
    .local v21, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :goto_26
    if-ge v1, v2, :cond_3a

    .line 39
    invoke-virtual {v5, v1}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v19

    .local v19, "element$iv":Ljava/lang/Object;
    move/from16 v23, v1

    .local v23, "index$iv":I
    const/16 v24, 0x0

    .line 30
    .local v24, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move/from16 v25, v2

    move-object/from16 v2, v19

    check-cast v2, Lcom/android/server/pm/pkg/PackageState;

    .local v2, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v26, 0x0

    .line 1108
    .local v26, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$2":I
    nop

    .line 1109
    nop

    .line 1110
    nop

    .line 1111
    nop

    .line 1108
    invoke-direct {v6, v2, v4, v10}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->isSoftRestrictedPermissionExemptForPackage(Lcom/android/server/pm/pkg/PackageState;ILjava/lang/String;)Z

    move-result v2

    .line 30
    .end local v2    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v26    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$2":I
    if-eqz v2, :cond_39

    .line 31
    const/4 v2, 0x1

    goto :goto_27

    .line 33
    :cond_39
    nop

    .line 39
    .end local v19    # "element$iv":Ljava/lang/Object;
    .end local v23    # "index$iv":I
    .end local v24    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v1, v1, 0x1

    move/from16 v2, v25

    goto :goto_26

    :cond_3a
    nop

    .line 41
    .end local v1    # "index$iv$iv":I
    nop

    .line 34
    .end local v5    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v18    # "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .line 1107
    .end local v3    # "$i$f$anyIndexed":I
    .end local v21    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :goto_27
    if-nez v2, :cond_3b

    .line 1115
    const/high16 v1, 0x80000

    or-int/2addr v1, v0

    move v5, v1

    goto :goto_29

    .line 1107
    :cond_3b
    const/high16 v1, 0x80000

    goto :goto_28

    .line 1106
    :cond_3c
    const/high16 v1, 0x80000

    goto :goto_28

    .line 1105
    :cond_3d
    const/high16 v1, 0x80000

    .line 1117
    :goto_28
    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v1

    move v5, v1

    .line 1103
    :goto_29
    nop

    .line 1119
    .end local v0    # "newFlags":I
    .local v5, "newFlags":I
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v3, p3

    move/from16 v17, v4

    .end local v4    # "targetSdkVersion":I
    .local v17, "targetSdkVersion":I
    move-object/from16 v4, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    move/from16 v11, v40

    goto/16 :goto_37

    .line 1122
    .end local v5    # "newFlags":I
    .end local v16    # "wasRevoked":Z
    .end local v17    # "targetSdkVersion":I
    .end local v32    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v38    # "hasMissingPackage":Z
    .end local v40    # "oldFlags":I
    .local v11, "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v13, "hasMissingPackage":Z
    .local v15, "oldFlags":I
    :cond_3e
    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    .end local v11    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v13    # "hasMissingPackage":Z
    .end local v15    # "oldFlags":I
    .restart local v32    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v38    # "hasMissingPackage":Z
    .restart local v40    # "oldFlags":I
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1123
    move-object v1, v14

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 45
    .local v2, "$i$f$getProtectionLevel":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v3

    iget v1, v3, Landroid/content/pm/PermissionInfo;->protectionLevel:I

    .line 1124
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$getProtectionLevel":I
    move-object v2, v14

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 33
    .local v3, "$i$f$getName":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v4

    iget-object v2, v4, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1125
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$getName":I
    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    const-string v4, "Unknown protection level "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, "for permission "

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v1, " while evaluating permission statefor appId "

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v1, " and userId "

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v9}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 1121
    invoke-static {v0, v1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    move/from16 v11, v40

    goto/16 :goto_37

    .line 902
    .end local v32    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v38    # "hasMissingPackage":Z
    .end local v40    # "oldFlags":I
    .restart local v11    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v13    # "hasMissingPackage":Z
    .restart local v15    # "oldFlags":I
    :cond_3f
    move-object/from16 v32, v11

    move/from16 v38, v13

    move/from16 v40, v15

    .line 903
    .end local v11    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v13    # "hasMissingPackage":Z
    .end local v15    # "oldFlags":I
    .restart local v32    # "packageNames":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v38    # "hasMissingPackage":Z
    .restart local v40    # "oldFlags":I
    :goto_2a
    move/from16 v11, v40

    const/4 v0, 0x4

    .end local v40    # "oldFlags":I
    .local v11, "oldFlags":I
    invoke-static {v11, v0}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v13

    .line 905
    .local v13, "wasProtectionGranted":Z
    if-eqz v38, :cond_40

    if-eqz v13, :cond_40

    .line 908
    move v3, v0

    goto/16 :goto_35

    .line 911
    :cond_40
    move-object v1, v14

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 105
    .local v2, "$i$f$isPrivileged":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 63
    .local v4, "$i$f$getProtectionFlags":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v3

    .line 105
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtectionFlags":I
    const/16 v4, 0x10

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isPrivileged":I
    if-eqz v1, :cond_44

    .line 912
    move-object v1, v12

    .local v1, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v2, 0x0

    .line 29
    .local v2, "$i$f$anyIndexed":I
    move-object v3, v1

    .local v3, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v4, 0x0

    .line 38
    .local v4, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .local v5, "index$iv$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v15

    :goto_2b
    if-ge v5, v15, :cond_42

    .line 39
    invoke-virtual {v3, v5}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v16

    .local v16, "element$iv":Ljava/lang/Object;
    move/from16 v18, v5

    .local v18, "index$iv":I
    const/16 v19, 0x0

    .line 30
    .local v19, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v0, v16

    check-cast v0, Lcom/android/server/pm/pkg/PackageState;

    .local v0, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v20, 0x0

    .line 913
    .local v20, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$newFlags$mayGrantByPrivileged$1":I
    invoke-direct {v6, v7, v0, v14}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->checkPrivilegedPermissionAllowlist(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z

    move-result v0

    .line 30
    .end local v0    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v20    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$newFlags$mayGrantByPrivileged$1":I
    if-eqz v0, :cond_41

    .line 31
    const/4 v1, 0x1

    goto :goto_2c

    .line 33
    :cond_41
    nop

    .line 39
    .end local v16    # "element$iv":Ljava/lang/Object;
    .end local v18    # "index$iv":I
    .end local v19    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v5, v5, 0x1

    const/4 v0, 0x4

    goto :goto_2b

    :cond_42
    nop

    .line 41
    .end local v5    # "index$iv$iv":I
    nop

    .line 34
    .end local v3    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v4    # "$i$f$forEachIndexed":I
    const/4 v1, 0x0

    .end local v1    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v2    # "$i$f$anyIndexed":I
    :goto_2c
    if-eqz v1, :cond_43

    goto :goto_2d

    :cond_43
    const/4 v1, 0x0

    goto :goto_2e

    :cond_44
    :goto_2d
    const/4 v1, 0x1

    .line 910
    :goto_2e
    move v0, v1

    .line 916
    .local v0, "mayGrantByPrivileged":Z
    move-object v1, v14

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 60
    .local v2, "$i$f$isSignature":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 48
    .local v4, "$i$f$getProtection":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v3

    .line 60
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtection":I
    const/4 v4, 0x2

    if-ne v3, v4, :cond_45

    const/4 v1, 0x1

    goto :goto_2f

    :cond_45
    const/4 v1, 0x0

    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isSignature":I
    :goto_2f
    if-eqz v1, :cond_48

    .line 917
    move-object v1, v12

    .local v1, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v2, 0x0

    .line 29
    .local v2, "$i$f$anyIndexed":I
    move-object v3, v1

    .local v3, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v4, 0x0

    .line 38
    .local v4, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .restart local v5    # "index$iv$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v15

    :goto_30
    if-ge v5, v15, :cond_47

    .line 39
    invoke-virtual {v3, v5}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v16

    .restart local v16    # "element$iv":Ljava/lang/Object;
    move/from16 v18, v5

    .restart local v18    # "index$iv":I
    const/16 v19, 0x0

    .line 30
    .restart local v19    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v20, v1

    .end local v1    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v20, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    move-object/from16 v1, v16

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    .local v1, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v23, 0x0

    .line 918
    .local v23, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$newFlags$shouldGrantBySignature$1":I
    invoke-direct {v6, v7, v1, v14}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->shouldGrantPermissionBySignature(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z

    move-result v1

    .line 30
    .end local v1    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v23    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$newFlags$shouldGrantBySignature$1":I
    if-eqz v1, :cond_46

    .line 31
    const/4 v1, 0x1

    goto :goto_31

    .line 33
    :cond_46
    nop

    .line 39
    .end local v16    # "element$iv":Ljava/lang/Object;
    .end local v18    # "index$iv":I
    .end local v19    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v5, v5, 0x1

    move-object/from16 v1, v20

    goto :goto_30

    .end local v20    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v1, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :cond_47
    move-object/from16 v20, v1

    .line 41
    .end local v1    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v5    # "index$iv$iv":I
    .restart local v20    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    nop

    .line 34
    .end local v3    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v4    # "$i$f$forEachIndexed":I
    const/4 v1, 0x0

    .end local v2    # "$i$f$anyIndexed":I
    .end local v20    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :goto_31
    if-eqz v1, :cond_48

    const/4 v1, 0x1

    goto :goto_32

    :cond_48
    const/4 v1, 0x0

    .line 915
    :goto_32
    nop

    .line 921
    .local v1, "shouldGrantBySignature":Z
    move-object v2, v12

    .local v2, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v3, 0x0

    .line 29
    .local v3, "$i$f$anyIndexed":I
    move-object v4, v2

    .local v4, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    const/4 v5, 0x0

    .line 38
    .local v5, "$i$f$forEachIndexed":I
    const/4 v15, 0x0

    move-object/from16 v16, v2

    .end local v2    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .local v15, "index$iv$iv":I
    .local v16, "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    invoke-virtual {v4}, Lcom/android/server/permission/access/immutable/IndexedList;->getSize()I

    move-result v2

    :goto_33
    if-ge v15, v2, :cond_4a

    .line 39
    invoke-virtual {v4, v15}, Lcom/android/server/permission/access/immutable/IndexedList;->get(I)Ljava/lang/Object;

    move-result-object v18

    .local v18, "element$iv":Ljava/lang/Object;
    move/from16 v19, v15

    .local v19, "index$iv":I
    const/16 v20, 0x0

    .line 30
    .local v20, "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    move/from16 v23, v2

    move-object/from16 v2, v18

    check-cast v2, Lcom/android/server/pm/pkg/PackageState;

    .local v2, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v25, 0x0

    .line 922
    .local v25, "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$newFlags$shouldGrantByProtectionFlags$1":I
    invoke-direct {v6, v7, v2, v14}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->shouldGrantPermissionByProtectionFlags(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z

    move-result v2

    .line 30
    .end local v2    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v25    # "$i$a$-anyIndexed-AppIdPermissionPolicy$evaluatePermissionState$newFlags$shouldGrantByProtectionFlags$1":I
    if-eqz v2, :cond_49

    .line 31
    const/4 v2, 0x1

    goto :goto_34

    .line 33
    :cond_49
    nop

    .line 39
    .end local v18    # "element$iv":Ljava/lang/Object;
    .end local v19    # "index$iv":I
    .end local v20    # "$i$a$-forEachIndexed-IndexedListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v15, v15, 0x1

    move/from16 v2, v23

    goto :goto_33

    :cond_4a
    nop

    .line 41
    .end local v15    # "index$iv$iv":I
    nop

    .line 34
    .end local v4    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    .end local v5    # "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .line 921
    .end local v3    # "$i$f$anyIndexed":I
    .end local v16    # "$this$anyIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedList;
    :goto_34
    nop

    .line 920
    nop

    .line 924
    .local v2, "shouldGrantByProtectionFlags":Z
    nop

    .line 925
    if-eqz v0, :cond_4c

    .line 926
    if-nez v1, :cond_4b

    if-eqz v2, :cond_4c

    .line 928
    :cond_4b
    const/4 v3, 0x4

    goto :goto_35

    .line 930
    :cond_4c
    const/4 v3, 0x0

    .line 905
    .end local v0    # "mayGrantByPrivileged":Z
    .end local v1    # "shouldGrantBySignature":Z
    .end local v2    # "shouldGrantByProtectionFlags":Z
    :goto_35
    nop

    .line 904
    move v0, v3

    .line 933
    .local v0, "newFlags":I
    move-object v1, v14

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 66
    .local v2, "$i$f$isAppOp":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 63
    .local v4, "$i$f$getProtectionFlags":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v3

    .line 66
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtectionFlags":I
    const/16 v4, 0x40

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 933
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isAppOp":I
    if-eqz v1, :cond_4d

    .line 935
    and-int/lit8 v1, v11, 0x28

    or-int/2addr v1, v0

    .line 934
    move v0, v1

    .line 942
    :cond_4d
    move-object v1, v14

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 78
    .local v2, "$i$f$isDevelopment":I
    move-object v3, v1

    .restart local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 63
    .restart local v4    # "$i$f$getProtectionFlags":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v3

    .line 78
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtectionFlags":I
    const/16 v4, 0x20

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 942
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isDevelopment":I
    if-eqz v1, :cond_4e

    .line 943
    and-int/lit8 v1, v11, 0x10

    or-int/2addr v0, v1

    .line 945
    :cond_4e
    move-object v1, v14

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 114
    .local v2, "$i$f$isRole":I
    move-object v3, v1

    .restart local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 63
    .restart local v4    # "$i$f$getProtectionFlags":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    invoke-virtual {v5}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v3

    .line 114
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtectionFlags":I
    const/high16 v4, 0x4000000

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 945
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isRole":I
    if-eqz v1, :cond_4f

    .line 947
    nop

    .line 948
    and-int/lit8 v1, v11, 0x18

    .line 947
    or-int/2addr v1, v0

    .line 946
    move v0, v1

    move v15, v0

    goto :goto_36

    .line 945
    :cond_4f
    move v15, v0

    .line 950
    .end local v0    # "newFlags":I
    .local v15, "newFlags":I
    :goto_36
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v3, p3

    move-object/from16 v4, p4

    move v5, v15

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 1128
    .end local v13    # "wasProtectionGranted":Z
    .end local v15    # "newFlags":I
    :goto_37
    return-void
.end method

.method private final evaluatePermissionStateForAllPackages(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V
    .locals 34
    .param p1, "$this$evaluatePermissionStateForAllPackages"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "permissionName"    # Ljava/lang/String;
    .param p3, "installedPackageState"    # Lcom/android/server/pm/pkg/PackageState;

    .line 787
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    .line 788
    .local v0, "externalState":Lcom/android/server/permission/access/ExternalState;
    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v1

    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v2, 0x0

    .line 38
    .local v2, "$i$f$forEachIndexed":I
    const/4 v3, 0x0

    .local v3, "index$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v4

    :goto_0
    if-ge v3, v4, :cond_6

    .line 39
    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v11

    .local v11, "userId":I
    const/4 v12, 0x0

    .line 789
    .local v12, "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluatePermissionStateForAllPackages$1":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v13

    .local v13, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/4 v14, 0x0

    .line 44
    .local v14, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .local v5, "index$iv":I
    invoke-virtual {v13}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v15

    move v10, v5

    .end local v5    # "index$iv":I
    .local v10, "index$iv":I
    :goto_1
    if-ge v10, v15, :cond_5

    .line 45
    invoke-virtual {v13, v10}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v9

    .local v9, "appId":I
    invoke-virtual {v13, v10}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    const/16 v16, 0x0

    .line 791
    .local v16, "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluatePermissionStateForAllPackages$1$1":I
    nop

    .line 1440
    nop

    .line 1442
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v5

    .line 1440
    .local v5, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v6, 0x0

    .line 1445
    .local v6, "$i$f$anyPackageInAppId":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v7

    invoke-virtual {v7}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v7

    invoke-virtual {v7, v9}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v7

    invoke-static {v7}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v7, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .local v7, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v8, v7

    .local v8, "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v17, 0x0

    .line 29
    .local v17, "$i$f$anyIndexed":I
    move-object/from16 v18, v8

    .local v18, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v19, 0x0

    .line 38
    .local v19, "$i$f$forEachIndexed":I
    const/16 v20, 0x0

    move-object/from16 v21, v0

    .end local v0    # "externalState":Lcom/android/server/permission/access/ExternalState;
    .local v20, "index$iv$iv$iv":I
    .local v21, "externalState":Lcom/android/server/permission/access/ExternalState;
    invoke-virtual/range {v18 .. v18}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v0

    move-object/from16 v22, v1

    move/from16 v1, v20

    .end local v20    # "index$iv$iv$iv":I
    .local v1, "index$iv$iv$iv":I
    .local v22, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    :goto_2
    const/16 v20, 0x0

    if-ge v1, v0, :cond_3

    .line 39
    move/from16 v23, v0

    move-object/from16 v0, v18

    .end local v18    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v0, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    invoke-virtual {v0, v1}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v18

    .local v18, "element$iv$iv":Ljava/lang/Object;
    move/from16 v24, v1

    .local v24, "index$iv$iv":I
    const/16 v25, 0x0

    .line 30
    .local v25, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move-object/from16 v26, v0

    .end local v0    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v26, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object/from16 v0, v18

    check-cast v0, Ljava/lang/String;

    .local v0, "packageName$iv":Ljava/lang/String;
    const/16 v27, 0x0

    .line 1447
    .local v27, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v28

    move/from16 v29, v2

    .end local v2    # "$i$f$forEachIndexed":I
    .local v29, "$i$f$forEachIndexed":I
    invoke-virtual/range {v28 .. v28}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v2

    invoke-interface {v2, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    invoke-static {v2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v2, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v2, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v28

    const/16 v30, 0x1

    if-eqz v28, :cond_0

    move-object/from16 v28, v2

    .local v28, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v31, 0x0

    .line 792
    .local v31, "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$evaluatePermissionStateForAllPackages$1$1$isPermissionRequested$1":I
    invoke-interface/range {v28 .. v28}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v32

    invoke-static/range {v32 .. v32}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object/from16 v33, v0

    .end local v0    # "packageName$iv":Ljava/lang/String;
    .local v33, "packageName$iv":Ljava/lang/String;
    invoke-interface/range {v32 .. v32}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v0

    move-object/from16 v32, v2

    move-object/from16 v2, p2

    .end local v2    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .local v32, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v0, v2}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v0

    .line 1448
    .end local v28    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v31    # "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$evaluatePermissionStateForAllPackages$1$1$isPermissionRequested$1":I
    if-eqz v0, :cond_1

    move/from16 v20, v30

    goto :goto_3

    .end local v32    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v33    # "packageName$iv":Ljava/lang/String;
    .restart local v0    # "packageName$iv":Ljava/lang/String;
    .restart local v2    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_0
    move-object/from16 v33, v0

    move-object/from16 v32, v2

    move-object/from16 v2, p2

    .line 30
    .end local v0    # "packageName$iv":Ljava/lang/String;
    .end local v2    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v27    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    :cond_1
    :goto_3
    if-eqz v20, :cond_2

    .line 31
    move/from16 v20, v30

    goto :goto_4

    .line 33
    :cond_2
    nop

    .line 39
    .end local v18    # "element$iv$iv":Ljava/lang/Object;
    .end local v24    # "index$iv$iv":I
    .end local v25    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v1, v1, 0x1

    move/from16 v0, v23

    move-object/from16 v18, v26

    move/from16 v2, v29

    goto :goto_2

    .end local v26    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v29    # "$i$f$forEachIndexed":I
    .local v2, "$i$f$forEachIndexed":I
    .local v18, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :cond_3
    move/from16 v29, v2

    move-object/from16 v26, v18

    move-object/from16 v2, p2

    .line 41
    .end local v1    # "index$iv$iv$iv":I
    .end local v2    # "$i$f$forEachIndexed":I
    .end local v18    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v26    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v29    # "$i$f$forEachIndexed":I
    nop

    .line 34
    .end local v19    # "$i$f$forEachIndexed":I
    .end local v26    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    nop

    .line 1446
    .end local v8    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v17    # "$i$f$anyIndexed":I
    :goto_4
    nop

    .line 791
    .end local v5    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v6    # "$i$f$anyPackageInAppId":I
    .end local v7    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    nop

    .line 790
    move/from16 v0, v20

    .line 794
    .local v0, "isPermissionRequested":Z
    if-eqz v0, :cond_4

    .line 795
    move-object/from16 v5, p0

    move-object/from16 v6, p1

    move v7, v9

    move v8, v11

    move v1, v9

    .end local v9    # "appId":I
    .local v1, "appId":I
    move-object/from16 v9, p2

    move/from16 v17, v10

    .end local v10    # "index$iv":I
    .local v17, "index$iv":I
    move-object/from16 v10, p3

    invoke-direct/range {v5 .. v10}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluatePermissionState(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V

    goto :goto_5

    .line 794
    .end local v1    # "appId":I
    .end local v17    # "index$iv":I
    .restart local v9    # "appId":I
    .restart local v10    # "index$iv":I
    :cond_4
    move v1, v9

    move/from16 v17, v10

    .line 797
    .end local v9    # "appId":I
    .end local v10    # "index$iv":I
    .restart local v1    # "appId":I
    .restart local v17    # "index$iv":I
    :goto_5
    nop

    .line 45
    .end local v0    # "isPermissionRequested":Z
    .end local v1    # "appId":I
    .end local v16    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluatePermissionStateForAllPackages$1$1":I
    nop

    .line 44
    add-int/lit8 v10, v17, 0x1

    move-object/from16 v0, v21

    move-object/from16 v1, v22

    move/from16 v2, v29

    .end local v17    # "index$iv":I
    .restart local v10    # "index$iv":I
    goto/16 :goto_1

    .end local v21    # "externalState":Lcom/android/server/permission/access/ExternalState;
    .end local v22    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v29    # "$i$f$forEachIndexed":I
    .local v0, "externalState":Lcom/android/server/permission/access/ExternalState;
    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v2    # "$i$f$forEachIndexed":I
    :cond_5
    move-object/from16 v21, v0

    move-object/from16 v22, v1

    move/from16 v29, v2

    move/from16 v17, v10

    move-object/from16 v2, p2

    .line 47
    .end local v0    # "externalState":Lcom/android/server/permission/access/ExternalState;
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v2    # "$i$f$forEachIndexed":I
    .end local v10    # "index$iv":I
    .restart local v21    # "externalState":Lcom/android/server/permission/access/ExternalState;
    .restart local v22    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v29    # "$i$f$forEachIndexed":I
    nop

    .line 798
    .end local v13    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v14    # "$i$f$forEachIndexed":I
    nop

    .line 39
    .end local v11    # "userId":I
    .end local v12    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$evaluatePermissionStateForAllPackages$1":I
    nop

    .line 38
    add-int/lit8 v3, v3, 0x1

    move/from16 v2, v29

    goto/16 :goto_0

    .end local v21    # "externalState":Lcom/android/server/permission/access/ExternalState;
    .end local v22    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v29    # "$i$f$forEachIndexed":I
    .restart local v0    # "externalState":Lcom/android/server/permission/access/ExternalState;
    .restart local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v2    # "$i$f$forEachIndexed":I
    :cond_6
    nop

    .line 41
    .end local v3    # "index$iv":I
    nop

    .line 799
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v2    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final getOldStatePermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;)I
    .locals 1
    .param p1, "$this$getOldStatePermissionFlags"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permissionName"    # Ljava/lang/String;

    .line 1720
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getOldState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-direct {p0, v0, p2, p3, p4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/AccessState;IILjava/lang/String;)I

    move-result v0

    return v0
.end method

.method private final getPermissionFlags(Lcom/android/server/permission/access/AccessState;IILjava/lang/String;)I
    .locals 2
    .param p1, "state"    # Lcom/android/server/permission/access/AccessState;
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permissionName"    # Ljava/lang/String;

    .line 1728
    invoke-virtual {p1}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, p3}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/UserState;

    if-eqz v0, :cond_0

    invoke-virtual {v0}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    if-eqz v0, :cond_0

    invoke-virtual {v0, p2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/immutable/IndexedMap;

    goto :goto_0

    :cond_0
    const/4 v0, 0x0

    :goto_0
    const/4 v1, 0x0

    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v1

    invoke-static {v0, p4, v1}, Lcom/android/server/permission/access/immutable/IndexedMapExtensionsKt;->getWithDefault(Lcom/android/server/permission/access/immutable/IndexedMap;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/Number;

    invoke-virtual {v0}, Ljava/lang/Number;->intValue()I

    move-result v0

    return v0
.end method

.method private final getPrivilegedPermissionAllowlistState(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Ljava/lang/String;)Ljava/lang/Boolean;
    .locals 7
    .param p1, "$this$getPrivilegedPermissionAllowlistState"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "permissionName"    # Ljava/lang/String;

    .line 1378
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getPermissionAllowlist()Lcom/android/server/pm/permission/PermissionAllowlist;

    move-result-object v0

    .line 1379
    .local v0, "permissionAllowlist":Lcom/android/server/pm/permission/PermissionAllowlist;
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getApexModuleName()Ljava/lang/String;

    move-result-object v1

    .line 1380
    .local v1, "apexModuleName":Ljava/lang/String;
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v2

    .line 1381
    .local v2, "packageName":Ljava/lang/String;
    nop

    .line 1382
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isVendor()Z

    move-result v3

    if-nez v3, :cond_0

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isOdm()Z

    move-result v3

    if-eqz v3, :cond_1

    :cond_0
    goto :goto_0

    .line 1387
    :cond_1
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isProduct()Z

    move-result v3

    if-eqz v3, :cond_2

    .line 1388
    nop

    .line 1389
    nop

    .line 1390
    nop

    .line 1388
    invoke-virtual {v0, v2, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getProductPrivilegedAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v3

    goto :goto_1

    .line 1392
    :cond_2
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isSystemExt()Z

    move-result v3

    if-eqz v3, :cond_3

    .line 1393
    nop

    .line 1394
    nop

    .line 1395
    nop

    .line 1393
    invoke-virtual {v0, v2, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getSystemExtPrivilegedAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v3

    goto :goto_1

    .line 1397
    :cond_3
    if-eqz v1, :cond_6

    .line 1399
    invoke-virtual {v0, v2, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getPrivilegedAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v3

    .line 1398
    nop

    .line 1400
    .local v3, "nonApexAllowlistState":Ljava/lang/Boolean;
    if-eqz v3, :cond_4

    .line 1404
    sget-object v4, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1405
    nop

    .line 1407
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Package "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " is an APK in APEX but has permission allowlist on the system image, please bundle the allowlist in the "

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, " APEX instead"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    .line 1403
    invoke-static {v4, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1411
    :cond_4
    nop

    .line 1412
    nop

    .line 1413
    nop

    .line 1414
    nop

    .line 1411
    invoke-virtual {v0, v1, v2, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getApexPrivilegedAppAllowlistState(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v4

    .line 1410
    nop

    .line 1416
    .local v4, "apexAllowlistState":Ljava/lang/Boolean;
    if-nez v4, :cond_5

    .end local v3    # "nonApexAllowlistState":Ljava/lang/Boolean;
    .end local v4    # "apexAllowlistState":Ljava/lang/Boolean;
    goto :goto_1

    .restart local v3    # "nonApexAllowlistState":Ljava/lang/Boolean;
    .restart local v4    # "apexAllowlistState":Ljava/lang/Boolean;
    :cond_5
    move-object v3, v4

    goto :goto_1

    .line 1418
    .end local v3    # "nonApexAllowlistState":Ljava/lang/Boolean;
    .end local v4    # "apexAllowlistState":Ljava/lang/Boolean;
    :cond_6
    invoke-virtual {v0, v2, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getPrivilegedAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v3

    goto :goto_1

    .line 1383
    :goto_0
    nop

    .line 1384
    nop

    .line 1385
    nop

    .line 1383
    invoke-virtual {v0, v2, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getVendorPrivilegedAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v3

    .line 1381
    :goto_1
    return-object v3
.end method

.method private final getSignaturePermissionAllowlistState(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Ljava/lang/String;)Ljava/lang/Boolean;
    .locals 3
    .param p1, "$this$getSignaturePermissionAllowlistState"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "permissionName"    # Ljava/lang/String;

    .line 1288
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getPermissionAllowlist()Lcom/android/server/pm/permission/PermissionAllowlist;

    move-result-object v0

    .line 1289
    .local v0, "permissionAllowlist":Lcom/android/server/pm/permission/PermissionAllowlist;
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v1

    .line 1290
    .local v1, "packageName":Ljava/lang/String;
    nop

    .line 1291
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isVendor()Z

    move-result v2

    if-nez v2, :cond_0

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isOdm()Z

    move-result v2

    if-eqz v2, :cond_1

    :cond_0
    goto :goto_0

    .line 1293
    :cond_1
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isProduct()Z

    move-result v2

    if-eqz v2, :cond_2

    .line 1294
    nop

    .line 1295
    nop

    .line 1296
    nop

    .line 1294
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getProductSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    goto :goto_1

    .line 1298
    :cond_2
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isSystemExt()Z

    move-result v2

    if-eqz v2, :cond_3

    .line 1299
    nop

    .line 1300
    nop

    .line 1301
    nop

    .line 1299
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getSystemExtSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    goto :goto_1

    .line 1304
    :cond_3
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getApexSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    if-nez v2, :cond_4

    .line 1305
    nop

    .line 1306
    nop

    .line 1307
    nop

    .line 1305
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getProductSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    .line 1304
    if-nez v2, :cond_4

    .line 1309
    nop

    .line 1310
    nop

    .line 1311
    nop

    .line 1309
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getVendorSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    .line 1304
    if-nez v2, :cond_4

    .line 1313
    nop

    .line 1314
    nop

    .line 1315
    nop

    .line 1313
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getSystemExtSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    .line 1304
    if-nez v2, :cond_4

    .line 1317
    nop

    .line 1318
    nop

    .line 1319
    nop

    .line 1317
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    goto :goto_1

    .line 1292
    :goto_0
    invoke-virtual {v0, v1, p3}, Lcom/android/server/pm/permission/PermissionAllowlist;->getVendorSignatureAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    .line 1290
    :cond_4
    :goto_1
    return-object v2
.end method

.method private final inheritImplicitPermissionStates(Lcom/android/server/permission/access/MutateStateScope;II)V
    .locals 30
    .param p1, "$this$inheritImplicitPermissionStates"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "appId"    # I
    .param p3, "userId"    # I

    .line 1131
    move-object/from16 v6, p0

    move-object/from16 v7, p1

    move/from16 v8, p2

    move/from16 v9, p3

    const/4 v0, 0x0

    .local v0, "targetSdkVersion":I
    const/16 v0, 0x2710

    .line 1132
    new-instance v1, Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    const/4 v2, 0x0

    const/4 v10, 0x1

    invoke-direct {v1, v2, v10, v2}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;-><init>(Landroid/util/ArraySet;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    move-object v11, v1

    .line 1133
    .local v11, "implicitPermissions":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    nop

    .line 1452
    nop

    .line 1454
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    .line 1452
    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v2, 0x0

    .line 1457
    .local v2, "$i$f$forEachPackageInAppId":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v3

    invoke-virtual {v3, v8}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1458
    .local v3, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v4, v3

    .local v4, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v5, 0x0

    .line 38
    .local v5, "$i$f$forEachIndexed":I
    const/4 v12, 0x0

    .local v12, "index$iv$iv":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v13

    move/from16 v29, v12

    move v12, v0

    move/from16 v0, v29

    .local v0, "index$iv$iv":I
    .local v12, "targetSdkVersion":I
    :goto_0
    if-ge v0, v13, :cond_1

    .line 39
    invoke-virtual {v4, v0}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Ljava/lang/String;

    .local v14, "packageName$iv":Ljava/lang/String;
    const/4 v15, 0x0

    .line 1459
    .local v15, "$i$a$-forEachIndexed-AppIdPermissionPolicy$forEachPackageInAppId$1$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v16

    invoke-virtual/range {v16 .. v16}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v10

    invoke-interface {v10, v14}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v10

    invoke-static {v10}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v10, Lcom/android/server/pm/pkg/PackageState;

    .line 1460
    .local v10, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v10}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v16

    if-eqz v16, :cond_0

    .line 1461
    move-object/from16 v16, v10

    .local v16, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v18, 0x0

    .line 1134
    .local v18, "$i$a$-forEachPackageInAppId$default-AppIdPermissionPolicy$inheritImplicitPermissionStates$1":I
    invoke-interface/range {v16 .. v16}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v19

    invoke-static/range {v19 .. v19}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object/from16 v20, v1

    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v20, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-interface/range {v19 .. v19}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v1

    invoke-static {v12, v1}, Lcom/android/server/permission/jarjar/kotlin/ranges/RangesKt;->coerceAtMost(II)I

    move-result v1

    .line 1135
    .end local v12    # "targetSdkVersion":I
    .local v1, "targetSdkVersion":I
    invoke-interface/range {v16 .. v16}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v12

    invoke-static {v12}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v12}, Lcom/android/server/pm/pkg/AndroidPackage;->getImplicitPermissions()Ljava/util/Set;

    move-result-object v12

    invoke-static {v11, v12}, Lcom/android/server/permission/access/immutable/IndexedSetExtensionsKt;->plusAssign(Lcom/android/server/permission/access/immutable/MutableIndexedSet;Ljava/util/Collection;)V

    .line 1136
    nop

    .line 1461
    .end local v16    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v18    # "$i$a$-forEachPackageInAppId$default-AppIdPermissionPolicy$inheritImplicitPermissionStates$1":I
    move v12, v1

    goto :goto_1

    .line 1460
    .end local v20    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    .restart local v12    # "targetSdkVersion":I
    :cond_0
    move-object/from16 v20, v1

    .line 1463
    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .restart local v20    # "state$iv":Lcom/android/server/permission/access/AccessState;
    :goto_1
    nop

    .line 39
    .end local v10    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v14    # "packageName$iv":Ljava/lang/String;
    .end local v15    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$forEachPackageInAppId$1$iv":I
    nop

    .line 38
    add-int/lit8 v0, v0, 0x1

    move-object/from16 v1, v20

    const/4 v10, 0x1

    goto :goto_0

    .end local v20    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .restart local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    :cond_1
    move-object/from16 v20, v1

    .line 41
    .end local v0    # "index$iv$iv":I
    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .restart local v20    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 1464
    .end local v4    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v5    # "$i$f$forEachIndexed":I
    nop

    .line 1137
    .end local v2    # "$i$f$forEachPackageInAppId":I
    .end local v3    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v20    # "state$iv":Lcom/android/server/permission/access/AccessState;
    move-object v10, v11

    .local v10, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    const/4 v13, 0x0

    .line 44
    .local v13, "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .local v0, "index$iv":I
    invoke-virtual {v10}, Lcom/android/server/permission/access/immutable/IndexedSet;->getSize()I

    move-result v14

    move v15, v0

    .end local v0    # "index$iv":I
    .local v15, "index$iv":I
    :goto_2
    if-ge v15, v14, :cond_f

    .line 45
    invoke-virtual {v10, v15}, Lcom/android/server/permission/access/immutable/IndexedSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v0

    move-object v5, v0

    check-cast v5, Ljava/lang/String;

    .local v5, "implicitPermissionName":Ljava/lang/String;
    const/16 v16, 0x0

    .line 1138
    .local v16, "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v0

    invoke-virtual {v0, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    move-object/from16 v18, v0

    check-cast v18, Lcom/android/server/permission/access/permission/Permission;

    .line 1139
    .local v18, "implicitPermission":Lcom/android/server/permission/access/permission/Permission;
    const-string v0, " in split permissions"

    if-eqz v18, :cond_e

    .line 1142
    move-object/from16 v1, v18

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 57
    .local v2, "$i$f$isRuntime":I
    move-object v3, v1

    .local v3, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 48
    .local v4, "$i$f$getProtection":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v19

    invoke-virtual/range {v19 .. v19}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v3

    .line 57
    .end local v3    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getProtection":I
    move-object/from16 v19, v10

    const/4 v10, 0x1

    .end local v10    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .local v19, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    if-ne v3, v10, :cond_2

    move v1, v10

    goto :goto_3

    :cond_2
    const/4 v1, 0x0

    .line 1142
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isRuntime":I
    :goto_3
    if-nez v1, :cond_3

    .line 1143
    goto/16 :goto_8

    .line 1147
    :cond_3
    invoke-direct {v6, v7, v8, v9, v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getOldStatePermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;)I

    move-result v1

    if-nez v1, :cond_4

    move v1, v10

    goto :goto_4

    :cond_4
    const/4 v1, 0x0

    .line 1146
    :goto_4
    move/from16 v17, v1

    .line 1148
    .local v17, "isNewPermission":Z
    if-nez v17, :cond_5

    .line 1149
    goto/16 :goto_8

    .line 1152
    :cond_5
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getImplicitToSourcePermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v1

    invoke-virtual {v1, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/permission/access/immutable/IndexedListSet;

    if-nez v1, :cond_6

    .line 1153
    goto/16 :goto_8

    .line 1152
    :cond_6
    nop

    .line 1151
    move-object/from16 v20, v1

    .line 1154
    .local v20, "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v1, 0x0

    .local v1, "newFlags":I
    invoke-virtual {v6, v7, v8, v9, v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I

    move-result v1

    .line 1155
    move-object/from16 v2, v20

    .local v2, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v3, 0x0

    .line 38
    .local v3, "$i$f$forEachIndexed":I
    const/16 v21, 0x0

    .local v21, "index$iv":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v4

    move/from16 v10, v21

    .end local v21    # "index$iv":I
    .local v10, "index$iv":I
    :goto_5
    if-ge v10, v4, :cond_c

    .line 39
    invoke-virtual {v2, v10}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v22

    move-object/from16 v23, v2

    .end local v2    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v23, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object/from16 v2, v22

    check-cast v2, Ljava/lang/String;

    .local v2, "sourcePermissionName":Ljava/lang/String;
    const/16 v22, 0x0

    .line 1156
    .local v22, "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$2":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v24

    invoke-virtual/range {v24 .. v24}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v24

    move/from16 v25, v3

    .end local v3    # "$i$f$forEachIndexed":I
    .local v25, "$i$f$forEachIndexed":I
    invoke-virtual/range {v24 .. v24}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v3

    invoke-virtual {v3, v2}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/permission/access/permission/Permission;

    .line 1157
    .local v3, "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    if-eqz v3, :cond_b

    .line 1160
    move-object/from16 v24, v3

    .end local v3    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .local v24, "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    invoke-virtual {v6, v7, v8, v9, v2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I

    move-result v3

    .line 1161
    .local v3, "sourceFlags":I
    move/from16 v26, v4

    sget-object v4, Lcom/android/server/permission/access/permission/PermissionFlags;->INSTANCE:Lcom/android/server/permission/access/permission/PermissionFlags;

    invoke-virtual {v4, v3}, Lcom/android/server/permission/access/permission/PermissionFlags;->isPermissionGranted(I)Z

    move-result v4

    .line 1162
    .local v4, "isSourceGranted":Z
    sget-object v6, Lcom/android/server/permission/access/permission/PermissionFlags;->INSTANCE:Lcom/android/server/permission/access/permission/PermissionFlags;

    invoke-virtual {v6, v1}, Lcom/android/server/permission/access/permission/PermissionFlags;->isPermissionGranted(I)Z

    move-result v6

    .line 1163
    .local v6, "isNewGranted":Z
    if-eqz v4, :cond_7

    if-nez v6, :cond_7

    const/16 v27, 0x1

    goto :goto_6

    :cond_7
    const/16 v27, 0x0

    .line 1164
    .local v27, "isGrantingNewFromRevoke":Z
    :goto_6
    if-eq v4, v6, :cond_8

    if-eqz v27, :cond_a

    .line 1165
    :cond_8
    if-eqz v27, :cond_9

    .line 1166
    const/4 v1, 0x0

    .line 1168
    :cond_9
    const v28, 0xfffff8

    and-int v28, v3, v28

    or-int v1, v1, v28

    .line 1170
    :cond_a
    nop

    .line 39
    .end local v2    # "sourcePermissionName":Ljava/lang/String;
    .end local v3    # "sourceFlags":I
    .end local v4    # "isSourceGranted":Z
    .end local v6    # "isNewGranted":Z
    .end local v22    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$2":I
    .end local v24    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v27    # "isGrantingNewFromRevoke":Z
    nop

    .line 38
    add-int/lit8 v10, v10, 0x1

    move-object/from16 v6, p0

    move-object/from16 v2, v23

    move/from16 v3, v25

    move/from16 v4, v26

    goto :goto_5

    .line 1157
    .restart local v2    # "sourcePermissionName":Ljava/lang/String;
    .local v3, "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v22    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$2":I
    :cond_b
    move-object/from16 v24, v3

    .end local v3    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v24    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 1158
    .local v3, "$i$a$-checkNotNull-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$2$1":I
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v6, "Unknown source permission "

    invoke-virtual {v4, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 1157
    .end local v3    # "$i$a$-checkNotNull-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$2$1":I
    new-instance v3, Ljava/lang/IllegalStateException;

    invoke-virtual {v0}, Ljava/lang/Object;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-direct {v3, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 38
    .end local v22    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$2":I
    .end local v23    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v24    # "sourcePermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v25    # "$i$f$forEachIndexed":I
    .local v2, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v3, "$i$f$forEachIndexed":I
    :cond_c
    move-object/from16 v23, v2

    move/from16 v25, v3

    .line 41
    .end local v2    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v3    # "$i$f$forEachIndexed":I
    .end local v10    # "index$iv":I
    .restart local v23    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v25    # "$i$f$forEachIndexed":I
    nop

    .line 1171
    .end local v23    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v25    # "$i$f$forEachIndexed":I
    nop

    .line 1172
    const/16 v0, 0x17

    if-lt v12, v0, :cond_d

    .line 1173
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->NO_IMPLICIT_FLAG_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    invoke-virtual {v0, v5}, Lcom/android/server/permission/access/immutable/IndexedSet;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_d

    .line 1175
    const/16 v0, 0x1000

    invoke-static {v1, v0}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    move v6, v0

    .end local v1    # "newFlags":I
    .local v0, "newFlags":I
    goto :goto_7

    .line 1177
    .end local v0    # "newFlags":I
    .restart local v1    # "newFlags":I
    :cond_d
    or-int/lit16 v0, v1, 0x1000

    move v6, v0

    .line 1179
    .end local v1    # "newFlags":I
    .local v6, "newFlags":I
    :goto_7
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v3, p3

    move-object v4, v5

    move-object v10, v5

    .end local v5    # "implicitPermissionName":Ljava/lang/String;
    .local v10, "implicitPermissionName":Ljava/lang/String;
    move v5, v6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 1180
    nop

    .line 45
    .end local v6    # "newFlags":I
    .end local v10    # "implicitPermissionName":Ljava/lang/String;
    .end local v16    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2":I
    .end local v17    # "isNewPermission":Z
    .end local v18    # "implicitPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v20    # "sourcePermissions":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :goto_8
    nop

    .line 44
    add-int/lit8 v15, v15, 0x1

    move-object/from16 v6, p0

    move-object/from16 v10, v19

    goto/16 :goto_2

    .line 1139
    .end local v19    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .restart local v5    # "implicitPermissionName":Ljava/lang/String;
    .local v10, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .restart local v16    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2":I
    .restart local v18    # "implicitPermission":Lcom/android/server/permission/access/permission/Permission;
    :cond_e
    move-object/from16 v19, v10

    move-object v10, v5

    .end local v5    # "implicitPermissionName":Ljava/lang/String;
    .local v10, "implicitPermissionName":Ljava/lang/String;
    .restart local v19    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    const/4 v1, 0x0

    .line 1140
    .local v1, "$i$a$-checkNotNull-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$1":I
    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unknown implicit permission "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 1139
    .end local v1    # "$i$a$-checkNotNull-AppIdPermissionPolicy$inheritImplicitPermissionStates$2$1":I
    new-instance v1, Ljava/lang/IllegalStateException;

    invoke-virtual {v0}, Ljava/lang/Object;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-direct {v1, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v1

    .line 44
    .end local v16    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$inheritImplicitPermissionStates$2":I
    .end local v18    # "implicitPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v19    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .local v10, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    :cond_f
    nop

    .line 47
    .end local v15    # "index$iv":I
    nop

    .line 1181
    .end local v10    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .end local v13    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final isCompatibilityPermissionForPackage(Lcom/android/server/pm/pkg/AndroidPackage;Ljava/lang/String;)Z
    .locals 7
    .param p1, "androidPackage"    # Lcom/android/server/pm/pkg/AndroidPackage;
    .param p2, "permissionName"    # Ljava/lang/String;

    .line 1187
    sget-object v0, Lcom/android/internal/pm/permission/CompatibilityPermissionInfo;->COMPAT_PERMS:[Lcom/android/internal/pm/permission/CompatibilityPermissionInfo;

    array-length v1, v0

    const/4 v2, 0x0

    move v3, v2

    :goto_0
    if-ge v3, v1, :cond_1

    aget-object v4, v0, v3

    .line 1188
    .local v4, "compatibilityPermission":Lcom/android/internal/pm/permission/CompatibilityPermissionInfo;
    nop

    .line 1189
    invoke-virtual {v4}, Lcom/android/internal/pm/permission/CompatibilityPermissionInfo;->getName()Ljava/lang/String;

    move-result-object v5

    invoke-static {v5, p2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_0

    .line 1190
    invoke-interface {p1}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v5

    invoke-virtual {v4}, Lcom/android/internal/pm/permission/CompatibilityPermissionInfo;->getSdkVersion()I

    move-result v6

    if-ge v5, v6, :cond_0

    .line 1193
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1194
    nop

    .line 1195
    invoke-interface {p1}, Lcom/android/server/pm/pkg/AndroidPackage;->getPackageName()Ljava/lang/String;

    move-result-object v1

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Auto-granting "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v3, " to old package "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 1192
    invoke-static {v0, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    .line 1197
    const/4 v0, 0x1

    return v0

    .line 1187
    .end local v4    # "compatibilityPermission":Lcom/android/internal/pm/permission/CompatibilityPermissionInfo;
    :cond_0
    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    .line 1200
    :cond_1
    return v2
.end method

.method private final isSoftRestrictedPermissionExemptForPackage(Lcom/android/server/pm/pkg/PackageState;ILjava/lang/String;)Z
    .locals 3
    .param p1, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p2, "appIdTargetSdkVersion"    # I
    .param p3, "permissionName"    # Ljava/lang/String;

    .line 1433
    nop

    .line 1435
    nop

    .line 1434
    const-string v0, "android.permission.READ_EXTERNAL_STORAGE"

    invoke-static {p3, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    const/4 v1, 0x1

    if-eqz v0, :cond_0

    move v0, v1

    goto :goto_0

    .line 1435
    :cond_0
    const-string v0, "android.permission.WRITE_EXTERNAL_STORAGE"

    invoke-static {p3, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    :goto_0
    const/4 v2, 0x0

    if-eqz v0, :cond_2

    .line 1436
    const/16 v0, 0x1d

    if-lt p2, v0, :cond_1

    goto :goto_1

    :cond_1
    move v1, v2

    goto :goto_1

    .line 1437
    :cond_2
    move v1, v2

    .line 1438
    :goto_1
    return v1
.end method

.method private final revokePermissionsOnPackageUpdate(Lcom/android/server/permission/access/MutateStateScope;I)V
    .locals 30
    .param p1, "$this$revokePermissionsOnPackageUpdate"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "appId"    # I

    .line 710
    move/from16 v6, p2

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getOldState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->contains(I)Z

    move-result v0

    if-eqz v0, :cond_3

    .line 711
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getOldState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    .local v0, "state$iv":Lcom/android/server/permission/access/AccessState;
    move-object/from16 v2, p0

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    move-object/from16 v3, p1

    .local v3, "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    const/4 v4, 0x0

    .line 1445
    .local v4, "$i$f$anyPackageInAppId":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v5

    invoke-virtual {v5, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    invoke-static {v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .local v5, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v8, v5

    .local v8, "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v9, 0x0

    .line 29
    .local v9, "$i$f$anyIndexed":I
    move-object v10, v8

    .local v10, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v11, 0x0

    .line 38
    .local v11, "$i$f$forEachIndexed":I
    const/4 v12, 0x0

    .local v12, "index$iv$iv$iv":I
    invoke-virtual {v10}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v13

    :goto_0
    if-ge v12, v13, :cond_2

    .line 39
    invoke-virtual {v10, v12}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v14

    .local v14, "element$iv$iv":Ljava/lang/Object;
    move v15, v12

    .local v15, "index$iv$iv":I
    const/16 v16, 0x0

    .line 30
    .local v16, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move-object v1, v14

    check-cast v1, Ljava/lang/String;

    .local v1, "packageName$iv":Ljava/lang/String;
    const/16 v18, 0x0

    .line 1447
    .local v18, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v19

    invoke-virtual/range {v19 .. v19}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v7

    invoke-interface {v7, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v7

    invoke-static {v7}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v7, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v7, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v7}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v19

    nop

    if-eqz v19, :cond_0

    move-object/from16 v19, v7

    .local v19, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v21, 0x0

    .line 711
    .local v21, "$i$a$-anyPackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$hasOldPackage$1":I
    nop

    .line 1448
    .end local v19    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v21    # "$i$a$-anyPackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$hasOldPackage$1":I
    const/4 v1, 0x1

    goto :goto_1

    :cond_0
    const/4 v1, 0x0

    .line 30
    .end local v1    # "packageName$iv":Ljava/lang/String;
    .end local v7    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v18    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    :goto_1
    if-eqz v1, :cond_1

    .line 31
    const/4 v1, 0x1

    goto :goto_2

    .line 33
    :cond_1
    nop

    .line 39
    .end local v14    # "element$iv$iv":Ljava/lang/Object;
    .end local v15    # "index$iv$iv":I
    .end local v16    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v12, v12, 0x1

    goto :goto_0

    :cond_2
    nop

    .line 41
    .end local v12    # "index$iv$iv$iv":I
    nop

    .line 34
    .end local v10    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v11    # "$i$f$forEachIndexed":I
    const/4 v1, 0x0

    .line 1446
    .end local v8    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v9    # "$i$f$anyIndexed":I
    :goto_2
    nop

    .end local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v3    # "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v4    # "$i$f$anyPackageInAppId":I
    .end local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    if-eqz v1, :cond_3

    const/4 v0, 0x1

    goto :goto_3

    :cond_3
    const/4 v0, 0x0

    .line 709
    :goto_3
    move v7, v0

    .line 712
    .local v7, "hasOldPackage":Z
    if-nez v7, :cond_4

    .line 717
    return-void

    .line 723
    :cond_4
    const/16 v0, 0x2710

    .local v0, "initialValue$iv":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getOldState()Lcom/android/server/permission/access/AccessState;

    move-result-object v1

    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    move-object/from16 v2, p1

    .local v2, "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    move-object/from16 v3, p0

    .local v3, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    const/4 v4, 0x0

    .line 1473
    .local v4, "$i$f$reducePackageInAppId":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v5

    invoke-virtual {v5, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    invoke-static {v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1474
    .restart local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v8, v5

    .local v8, "$this$reduceIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v9, 0x0

    .line 72
    .local v9, "$i$f$reduceIndexed":I
    new-instance v10, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;

    invoke-direct {v10}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;-><init>()V

    .local v10, "value$iv$iv":Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;
    iput v0, v10, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 73
    move-object v11, v8

    .local v11, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v12, 0x0

    .line 38
    .local v12, "$i$f$forEachIndexed":I
    const/4 v13, 0x0

    .local v13, "index$iv$iv$iv":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v14

    :goto_4
    if-ge v13, v14, :cond_6

    .line 39
    invoke-virtual {v11, v13}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v15

    .local v15, "element$iv$iv":Ljava/lang/Object;
    move/from16 v16, v13

    .local v16, "index$iv$iv":I
    const/16 v18, 0x0

    .line 73
    .local v18, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$reduceIndexed$1$iv$iv":I
    move/from16 v19, v0

    .end local v0    # "initialValue$iv":I
    .local v19, "initialValue$iv":I
    iget v0, v10, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    move-object/from16 v21, v2

    .end local v2    # "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .local v0, "value$iv":I
    .local v21, "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    move-object v2, v15

    check-cast v2, Ljava/lang/String;

    .local v2, "packageName$iv":Ljava/lang/String;
    const/16 v22, 0x0

    .line 1475
    .local v22, "$i$a$-reduceIndexed-AppIdPermissionPolicy$reducePackageInAppId$1$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v23

    move-object/from16 v24, v1

    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v24, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v23 .. v23}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface {v1, v2}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    .line 1476
    .local v1, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v23

    if-eqz v23, :cond_5

    .line 1477
    move/from16 v23, v0

    .local v23, "targetSdkVersion":I
    move-object/from16 v25, v1

    .local v25, "packageState":Lcom/android/server/pm/pkg/PackageState;
    move/from16 v26, v23

    .end local v23    # "targetSdkVersion":I
    .local v26, "targetSdkVersion":I
    const/16 v23, 0x0

    .line 726
    .local v23, "$i$a$-reducePackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$oldTargetSdkVersion$1":I
    invoke-interface/range {v25 .. v25}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v27

    invoke-static/range {v27 .. v27}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move/from16 v28, v0

    .end local v0    # "value$iv":I
    .local v28, "value$iv":I
    invoke-interface/range {v27 .. v27}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v0

    move-object/from16 v27, v1

    move/from16 v1, v26

    .end local v26    # "targetSdkVersion":I
    .local v1, "targetSdkVersion":I
    .local v27, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-static {v1, v0}, Lcom/android/server/permission/jarjar/kotlin/ranges/RangesKt;->coerceAtMost(II)I

    move-result v0

    .line 1477
    .end local v1    # "targetSdkVersion":I
    .end local v23    # "$i$a$-reducePackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$oldTargetSdkVersion$1":I
    .end local v25    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    goto :goto_5

    .line 1479
    .end local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v28    # "value$iv":I
    .restart local v0    # "value$iv":I
    .local v1, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_5
    move/from16 v28, v0

    move-object/from16 v27, v1

    .line 1476
    .end local v0    # "value$iv":I
    .end local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v28    # "value$iv":I
    :goto_5
    nop

    .end local v2    # "packageName$iv":Ljava/lang/String;
    .end local v22    # "$i$a$-reduceIndexed-AppIdPermissionPolicy$reducePackageInAppId$1$iv":I
    .end local v27    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v28    # "value$iv":I
    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v0

    .line 73
    invoke-virtual {v0}, Ljava/lang/Number;->intValue()I

    move-result v0

    iput v0, v10, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 39
    .end local v15    # "element$iv$iv":Ljava/lang/Object;
    .end local v16    # "index$iv$iv":I
    .end local v18    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$reduceIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v13, v13, 0x1

    move/from16 v0, v19

    move-object/from16 v2, v21

    move-object/from16 v1, v24

    goto :goto_4

    .end local v19    # "initialValue$iv":I
    .end local v21    # "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v24    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v0, "initialValue$iv":I
    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v2, "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    :cond_6
    move/from16 v19, v0

    move-object/from16 v24, v1

    move-object/from16 v21, v2

    .line 41
    .end local v0    # "initialValue$iv":I
    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v2    # "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v13    # "index$iv$iv$iv":I
    .restart local v19    # "initialValue$iv":I
    .restart local v21    # "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .restart local v24    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 74
    .end local v11    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v12    # "$i$f$forEachIndexed":I
    iget v0, v10, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 1474
    .end local v8    # "$this$reduceIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v9    # "$i$f$reduceIndexed":I
    .end local v10    # "value$iv$iv":Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;
    nop

    .line 723
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v4    # "$i$f$reducePackageInAppId":I
    .end local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v19    # "initialValue$iv":I
    .end local v21    # "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v24    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 722
    move v8, v0

    .line 729
    .local v8, "oldTargetSdkVersion":I
    const/16 v0, 0x2710

    .restart local v0    # "initialValue$iv":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    .restart local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    move-object/from16 v2, p0

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    move-object/from16 v3, p1

    .local v3, "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    const/4 v4, 0x0

    .line 1473
    .restart local v4    # "$i$f$reducePackageInAppId":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v5

    invoke-virtual {v5, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    invoke-static {v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1474
    .restart local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v9, v5

    .local v9, "$this$reduceIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v10, 0x0

    .line 72
    .local v10, "$i$f$reduceIndexed":I
    new-instance v11, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;

    invoke-direct {v11}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;-><init>()V

    .local v11, "value$iv$iv":Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;
    iput v0, v11, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 73
    move-object v12, v9

    .local v12, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v13, 0x0

    .line 38
    .local v13, "$i$f$forEachIndexed":I
    const/4 v14, 0x0

    .local v14, "index$iv$iv$iv":I
    invoke-virtual {v12}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v15

    :goto_6
    if-ge v14, v15, :cond_8

    .line 39
    invoke-virtual {v12, v14}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v16

    .local v16, "element$iv$iv":Ljava/lang/Object;
    move/from16 v18, v14

    .local v18, "index$iv$iv":I
    const/16 v19, 0x0

    .line 73
    .local v19, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$reduceIndexed$1$iv$iv":I
    move/from16 v21, v0

    .end local v0    # "initialValue$iv":I
    .local v21, "initialValue$iv":I
    iget v0, v11, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    move-object/from16 v22, v2

    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .local v0, "value$iv":I
    .local v22, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    move-object/from16 v2, v16

    check-cast v2, Ljava/lang/String;

    .local v2, "packageName$iv":Ljava/lang/String;
    const/16 v23, 0x0

    .line 1475
    .local v23, "$i$a$-reduceIndexed-AppIdPermissionPolicy$reducePackageInAppId$1$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v24

    move-object/from16 v25, v1

    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v25, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v24 .. v24}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface {v1, v2}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    .line 1476
    .local v1, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v24

    if-eqz v24, :cond_7

    .line 1477
    move/from16 v24, v0

    .local v24, "targetSdkVersion":I
    move-object/from16 v26, v1

    .local v26, "packageState":Lcom/android/server/pm/pkg/PackageState;
    const/16 v27, 0x0

    .line 732
    .local v27, "$i$a$-reducePackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$newTargetSdkVersion$1":I
    invoke-interface/range {v26 .. v26}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v28

    invoke-static/range {v28 .. v28}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move/from16 v29, v0

    .end local v0    # "value$iv":I
    .local v29, "value$iv":I
    invoke-interface/range {v28 .. v28}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v0

    move-object/from16 v28, v1

    move/from16 v1, v24

    .end local v24    # "targetSdkVersion":I
    .local v1, "targetSdkVersion":I
    .local v28, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-static {v1, v0}, Lcom/android/server/permission/jarjar/kotlin/ranges/RangesKt;->coerceAtMost(II)I

    move-result v0

    .line 1477
    .end local v1    # "targetSdkVersion":I
    .end local v26    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v27    # "$i$a$-reducePackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$newTargetSdkVersion$1":I
    goto :goto_7

    .line 1479
    .end local v28    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v29    # "value$iv":I
    .restart local v0    # "value$iv":I
    .local v1, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_7
    move/from16 v29, v0

    move-object/from16 v28, v1

    .line 1476
    .end local v0    # "value$iv":I
    .end local v1    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v28    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v29    # "value$iv":I
    :goto_7
    nop

    .end local v2    # "packageName$iv":Ljava/lang/String;
    .end local v23    # "$i$a$-reduceIndexed-AppIdPermissionPolicy$reducePackageInAppId$1$iv":I
    .end local v28    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v29    # "value$iv":I
    invoke-static {v0}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v0

    .line 73
    invoke-virtual {v0}, Ljava/lang/Number;->intValue()I

    move-result v0

    iput v0, v11, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 39
    .end local v16    # "element$iv$iv":Ljava/lang/Object;
    .end local v18    # "index$iv$iv":I
    .end local v19    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$reduceIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v14, v14, 0x1

    move/from16 v0, v21

    move-object/from16 v2, v22

    move-object/from16 v1, v25

    goto :goto_6

    .end local v21    # "initialValue$iv":I
    .end local v22    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v0, "initialValue$iv":I
    .local v1, "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    :cond_8
    move/from16 v21, v0

    move-object/from16 v25, v1

    move-object/from16 v22, v2

    .line 41
    .end local v0    # "initialValue$iv":I
    .end local v1    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v14    # "index$iv$iv$iv":I
    .restart local v21    # "initialValue$iv":I
    .restart local v22    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .restart local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 74
    .end local v12    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v13    # "$i$f$forEachIndexed":I
    iget v0, v11, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 1474
    .end local v9    # "$this$reduceIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v10    # "$i$f$reduceIndexed":I
    .end local v11    # "value$iv$iv":Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;
    nop

    .line 729
    .end local v3    # "$this$reducePackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v4    # "$i$f$reducePackageInAppId":I
    .end local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v21    # "initialValue$iv":I
    .end local v22    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 728
    move v9, v0

    .line 736
    .local v9, "newTargetSdkVersion":I
    const/16 v0, 0x1d

    if-lt v8, v0, :cond_9

    .line 737
    if-ge v9, v0, :cond_9

    const/4 v1, 0x1

    goto :goto_8

    :cond_9
    const/4 v1, 0x0

    .line 735
    :goto_8
    move v10, v1

    .line 740
    .local v10, "isTargetSdkVersionDowngraded":Z
    if-ge v8, v0, :cond_a

    .line 741
    if-lt v9, v0, :cond_a

    const/4 v0, 0x1

    goto :goto_9

    :cond_a
    const/4 v0, 0x0

    .line 739
    :goto_9
    move v11, v0

    .line 743
    .local v11, "isTargetSdkVersionUpgraded":Z
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getOldState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    .local v0, "state$iv":Lcom/android/server/permission/access/AccessState;
    move-object/from16 v1, p0

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    move-object/from16 v2, p1

    .local v2, "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    const/4 v3, 0x0

    .line 1445
    .local v3, "$i$f$anyPackageInAppId":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v4

    invoke-virtual {v4, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v4

    invoke-static {v4}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v4, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .local v4, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v5, v4

    .local v5, "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v12, 0x0

    .line 29
    .local v12, "$i$f$anyIndexed":I
    move-object v13, v5

    .local v13, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v14, 0x0

    .line 38
    .local v14, "$i$f$forEachIndexed":I
    const/4 v15, 0x0

    move-object/from16 v16, v1

    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .local v15, "index$iv$iv$iv":I
    .local v16, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    invoke-virtual {v13}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v1

    :goto_a
    if-ge v15, v1, :cond_d

    .line 39
    invoke-virtual {v13, v15}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v18

    .local v18, "element$iv$iv":Ljava/lang/Object;
    move/from16 v19, v15

    .local v19, "index$iv$iv":I
    const/16 v21, 0x0

    .line 30
    .local v21, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move/from16 v22, v1

    move-object/from16 v1, v18

    check-cast v1, Ljava/lang/String;

    .local v1, "packageName$iv":Ljava/lang/String;
    const/16 v23, 0x0

    .line 1447
    .local v23, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v24

    move-object/from16 v25, v0

    .end local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .restart local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v24 .. v24}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v0

    invoke-interface {v0, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v0, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v0, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v0}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v24

    if-eqz v24, :cond_b

    move-object/from16 v24, v0

    .local v24, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v26, 0x0

    .line 744
    .local v26, "$i$a$-anyPackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$oldIsRequestLegacyExternalStorage$1":I
    invoke-interface/range {v24 .. v24}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v27

    invoke-static/range {v27 .. v27}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface/range {v27 .. v27}, Lcom/android/server/pm/pkg/AndroidPackage;->isRequestLegacyExternalStorage()Z

    move-result v24

    .line 1448
    .end local v24    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v26    # "$i$a$-anyPackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$oldIsRequestLegacyExternalStorage$1":I
    if-eqz v24, :cond_b

    const/4 v0, 0x1

    goto :goto_b

    :cond_b
    const/4 v0, 0x0

    .line 30
    .end local v0    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v1    # "packageName$iv":Ljava/lang/String;
    .end local v23    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    :goto_b
    if-eqz v0, :cond_c

    .line 31
    const/4 v0, 0x1

    goto :goto_c

    .line 33
    :cond_c
    nop

    .line 39
    .end local v18    # "element$iv$iv":Ljava/lang/Object;
    .end local v19    # "index$iv$iv":I
    .end local v21    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v15, v15, 0x1

    move/from16 v1, v22

    move-object/from16 v0, v25

    goto :goto_a

    .end local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v0, "state$iv":Lcom/android/server/permission/access/AccessState;
    :cond_d
    move-object/from16 v25, v0

    .line 41
    .end local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v15    # "index$iv$iv$iv":I
    .restart local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 34
    .end local v13    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v14    # "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .line 1446
    .end local v5    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v12    # "$i$f$anyIndexed":I
    :goto_c
    nop

    .line 743
    .end local v2    # "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v3    # "$i$f$anyPackageInAppId":I
    .end local v4    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v16    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v25    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 742
    move v12, v0

    .line 747
    .local v12, "oldIsRequestLegacyExternalStorage":Z
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    .restart local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    move-object/from16 v1, p1

    .local v1, "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    move-object/from16 v2, p0

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    const/4 v3, 0x0

    .line 1445
    .restart local v3    # "$i$f$anyPackageInAppId":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v4

    invoke-virtual {v4, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v4

    invoke-static {v4}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v4, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .restart local v4    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v5, v4

    .restart local v5    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v13, 0x0

    .line 29
    .local v13, "$i$f$anyIndexed":I
    move-object v14, v5

    .local v14, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v15, 0x0

    .line 38
    .local v15, "$i$f$forEachIndexed":I
    const/16 v16, 0x0

    move-object/from16 v18, v1

    .end local v1    # "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .local v16, "index$iv$iv$iv":I
    .local v18, "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    invoke-virtual {v14}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v1

    move-object/from16 v19, v2

    move/from16 v2, v16

    .end local v16    # "index$iv$iv$iv":I
    .local v2, "index$iv$iv$iv":I
    .local v19, "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    :goto_d
    if-ge v2, v1, :cond_10

    .line 39
    invoke-virtual {v14, v2}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v16

    .local v16, "element$iv$iv":Ljava/lang/Object;
    move/from16 v21, v2

    .local v21, "index$iv$iv":I
    const/16 v22, 0x0

    .line 30
    .local v22, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move/from16 v23, v1

    move-object/from16 v1, v16

    check-cast v1, Ljava/lang/String;

    .local v1, "packageName$iv":Ljava/lang/String;
    const/16 v24, 0x0

    .line 1447
    .local v24, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v25

    move-object/from16 v26, v0

    .end local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v26, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v25 .. v25}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v0

    invoke-interface {v0, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v0, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v0, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v0}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v25

    if-eqz v25, :cond_e

    move-object/from16 v25, v0

    .local v25, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v27, 0x0

    .line 748
    .local v27, "$i$a$-anyPackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$newIsRequestLegacyExternalStorage$1":I
    invoke-interface/range {v25 .. v25}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v28

    invoke-static/range {v28 .. v28}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface/range {v28 .. v28}, Lcom/android/server/pm/pkg/AndroidPackage;->isRequestLegacyExternalStorage()Z

    move-result v25

    .line 1448
    .end local v25    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v27    # "$i$a$-anyPackageInAppId-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$newIsRequestLegacyExternalStorage$1":I
    if-eqz v25, :cond_e

    const/4 v0, 0x1

    goto :goto_e

    :cond_e
    const/4 v0, 0x0

    .line 30
    .end local v0    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v1    # "packageName$iv":Ljava/lang/String;
    .end local v24    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    :goto_e
    if-eqz v0, :cond_f

    .line 31
    const/4 v0, 0x1

    goto :goto_f

    .line 33
    :cond_f
    nop

    .line 39
    .end local v16    # "element$iv$iv":Ljava/lang/Object;
    .end local v21    # "index$iv$iv":I
    .end local v22    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v2, v2, 0x1

    move/from16 v1, v23

    move-object/from16 v0, v26

    goto :goto_d

    .end local v26    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v0, "state$iv":Lcom/android/server/permission/access/AccessState;
    :cond_10
    move-object/from16 v26, v0

    .line 41
    .end local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v2    # "index$iv$iv$iv":I
    .restart local v26    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 34
    .end local v14    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v15    # "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .line 1446
    .end local v5    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v13    # "$i$f$anyIndexed":I
    :goto_f
    nop

    .line 747
    .end local v3    # "$i$f$anyPackageInAppId":I
    .end local v4    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v18    # "$this$anyPackageInAppId$iv":Lcom/android/server/permission/access/MutateStateScope;
    .end local v19    # "this_$iv":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;
    .end local v26    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 746
    move v13, v0

    .line 751
    .local v13, "newIsRequestLegacyExternalStorage":Z
    if-nez v11, :cond_11

    .line 752
    if-nez v12, :cond_11

    .line 753
    if-eqz v13, :cond_11

    const/4 v0, 0x1

    goto :goto_10

    :cond_11
    const/4 v0, 0x0

    .line 750
    :goto_10
    move v14, v0

    .line 755
    .local v14, "isNewlyRequestingLegacyExternalStorage":Z
    if-nez v14, :cond_12

    if-eqz v10, :cond_13

    :cond_12
    goto :goto_11

    :cond_13
    const/4 v1, 0x0

    goto :goto_12

    :goto_11
    const/4 v1, 0x1

    .line 754
    :goto_12
    move v15, v1

    .line 756
    .local v15, "shouldRevokeStorageAndMediaPermissions":Z
    if-eqz v15, :cond_1a

    .line 757
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v4

    .local v4, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/16 v16, 0x0

    .line 44
    .local v16, "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .local v0, "index$iv":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v3

    move v2, v0

    .end local v0    # "index$iv":I
    .local v2, "index$iv":I
    :goto_13
    if-ge v2, v3, :cond_19

    .line 45
    invoke-virtual {v4, v2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v0

    .local v0, "userId":I
    invoke-virtual {v4, v2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v1

    move-object/from16 v17, v1

    check-cast v17, Lcom/android/server/permission/access/UserState;

    .local v17, "userState":Lcom/android/server/permission/access/UserState;
    move v1, v0

    .end local v0    # "userId":I
    .local v1, "userId":I
    const/16 v18, 0x0

    .line 758
    .local v18, "$i$a$-forEachIndexed-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$1":I
    invoke-virtual/range {v17 .. v17}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/immutable/IndexedMap;

    if-eqz v0, :cond_18

    .local v0, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/16 v19, 0x0

    .line 53
    .local v19, "$i$f$forEachReversedIndexed":I
    move-object v5, v0

    .local v5, "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/16 v21, 0x0

    .line 65
    .local v21, "$i$f$getLastIndex":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->getSize()I

    move-result v22

    const/16 v20, 0x1

    add-int/lit8 v22, v22, -0x1

    .line 53
    .end local v5    # "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v21    # "$i$f$getLastIndex":I
    move/from16 v5, v22

    .local v5, "index$iv":I
    :goto_14
    move/from16 v21, v2

    .end local v2    # "index$iv":I
    .local v21, "index$iv":I
    const/4 v2, -0x1

    if-ge v2, v5, :cond_17

    .line 54
    invoke-virtual {v0, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v2

    invoke-virtual {v0, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v22

    check-cast v22, Ljava/lang/Number;

    move/from16 v23, v7

    .end local v7    # "hasOldPackage":Z
    .local v23, "hasOldPackage":Z
    invoke-virtual/range {v22 .. v22}, Ljava/lang/Number;->intValue()I

    move-result v7

    .local v7, "oldFlags":I
    check-cast v2, Ljava/lang/String;

    .local v2, "permissionName":Ljava/lang/String;
    const/16 v22, 0x0

    .line 764
    .local v22, "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$1$1":I
    nop

    .line 765
    move-object/from16 v24, v0

    .end local v0    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .local v24, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->STORAGE_AND_MEDIA_PERMISSIONS:Lcom/android/server/permission/access/immutable/IndexedSet;

    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IndexedSet;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_16

    .line 766
    const/16 v0, 0x10

    invoke-static {v7, v0}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v0

    if-eqz v0, :cond_15

    .line 767
    const/16 v0, 0x180

    invoke-static {v7, v0}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasAnyBit(II)Z

    move-result v0

    if-nez v0, :cond_14

    .line 770
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 771
    nop

    .line 772
    move/from16 v25, v3

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3}, Ljava/lang/StringBuilder;-><init>()V

    move-object/from16 v26, v4

    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v26, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const-string v4, "Revoking storage permission: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v4, " for appId:  "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " and user: "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    .line 769
    invoke-static {v0, v3}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    .line 775
    const v0, 0xf00070

    invoke-static {v7, v0}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    .line 774
    move/from16 v27, v5

    .end local v5    # "index$iv":I
    .local v27, "index$iv":I
    move v5, v0

    .line 776
    .local v5, "newFlags":I
    move-object/from16 v0, p0

    move/from16 v28, v1

    .end local v1    # "userId":I
    .local v28, "userId":I
    move-object/from16 v1, p1

    move-object/from16 v29, v2

    .end local v2    # "permissionName":Ljava/lang/String;
    .local v29, "permissionName":Ljava/lang/String;
    move/from16 v2, p2

    move/from16 v3, v28

    move-object/from16 v4, v29

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    goto :goto_15

    .line 767
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v27    # "index$iv":I
    .end local v28    # "userId":I
    .end local v29    # "permissionName":Ljava/lang/String;
    .restart local v1    # "userId":I
    .restart local v2    # "permissionName":Ljava/lang/String;
    .restart local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v5, "index$iv":I
    :cond_14
    move/from16 v28, v1

    move-object/from16 v29, v2

    move/from16 v25, v3

    move-object/from16 v26, v4

    move/from16 v27, v5

    .end local v1    # "userId":I
    .end local v2    # "permissionName":Ljava/lang/String;
    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v5    # "index$iv":I
    .restart local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v27    # "index$iv":I
    .restart local v28    # "userId":I
    .restart local v29    # "permissionName":Ljava/lang/String;
    goto :goto_15

    .line 766
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v27    # "index$iv":I
    .end local v28    # "userId":I
    .end local v29    # "permissionName":Ljava/lang/String;
    .restart local v1    # "userId":I
    .restart local v2    # "permissionName":Ljava/lang/String;
    .restart local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v5    # "index$iv":I
    :cond_15
    move/from16 v28, v1

    move-object/from16 v29, v2

    move/from16 v25, v3

    move-object/from16 v26, v4

    move/from16 v27, v5

    .end local v1    # "userId":I
    .end local v2    # "permissionName":Ljava/lang/String;
    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v5    # "index$iv":I
    .restart local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v27    # "index$iv":I
    .restart local v28    # "userId":I
    .restart local v29    # "permissionName":Ljava/lang/String;
    goto :goto_15

    .line 765
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v27    # "index$iv":I
    .end local v28    # "userId":I
    .end local v29    # "permissionName":Ljava/lang/String;
    .restart local v1    # "userId":I
    .restart local v2    # "permissionName":Ljava/lang/String;
    .restart local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v5    # "index$iv":I
    :cond_16
    move/from16 v28, v1

    move-object/from16 v29, v2

    move/from16 v25, v3

    move-object/from16 v26, v4

    move/from16 v27, v5

    .line 778
    .end local v1    # "userId":I
    .end local v2    # "permissionName":Ljava/lang/String;
    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v5    # "index$iv":I
    .restart local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v27    # "index$iv":I
    .restart local v28    # "userId":I
    .restart local v29    # "permissionName":Ljava/lang/String;
    :goto_15
    nop

    .line 54
    .end local v7    # "oldFlags":I
    .end local v22    # "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$1$1":I
    .end local v29    # "permissionName":Ljava/lang/String;
    nop

    .line 53
    add-int/lit8 v5, v27, -0x1

    move/from16 v2, v21

    move/from16 v7, v23

    move-object/from16 v0, v24

    move/from16 v3, v25

    move-object/from16 v4, v26

    move/from16 v1, v28

    .end local v27    # "index$iv":I
    .restart local v5    # "index$iv":I
    goto/16 :goto_14

    .end local v23    # "hasOldPackage":Z
    .end local v24    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v28    # "userId":I
    .restart local v0    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .restart local v1    # "userId":I
    .restart local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v7, "hasOldPackage":Z
    :cond_17
    move-object/from16 v24, v0

    move/from16 v28, v1

    move/from16 v25, v3

    move-object/from16 v26, v4

    move/from16 v27, v5

    move/from16 v23, v7

    .line 56
    .end local v0    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v1    # "userId":I
    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v5    # "index$iv":I
    .end local v7    # "hasOldPackage":Z
    .restart local v23    # "hasOldPackage":Z
    .restart local v24    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .restart local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v28    # "userId":I
    nop

    .end local v19    # "$i$f$forEachReversedIndexed":I
    .end local v24    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    goto :goto_16

    .line 758
    .end local v21    # "index$iv":I
    .end local v23    # "hasOldPackage":Z
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v28    # "userId":I
    .restart local v1    # "userId":I
    .local v2, "index$iv":I
    .restart local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v7    # "hasOldPackage":Z
    :cond_18
    move/from16 v28, v1

    move/from16 v21, v2

    move/from16 v25, v3

    move-object/from16 v26, v4

    move/from16 v23, v7

    const/16 v20, 0x1

    .line 779
    .end local v1    # "userId":I
    .end local v2    # "index$iv":I
    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v7    # "hasOldPackage":Z
    .restart local v21    # "index$iv":I
    .restart local v23    # "hasOldPackage":Z
    .restart local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v28    # "userId":I
    :goto_16
    nop

    .line 45
    .end local v17    # "userState":Lcom/android/server/permission/access/UserState;
    .end local v18    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$revokePermissionsOnPackageUpdate$1":I
    .end local v28    # "userId":I
    nop

    .line 44
    add-int/lit8 v2, v21, 0x1

    move/from16 v7, v23

    move/from16 v3, v25

    move-object/from16 v4, v26

    .end local v21    # "index$iv":I
    .restart local v2    # "index$iv":I
    goto/16 :goto_13

    .end local v23    # "hasOldPackage":Z
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v7    # "hasOldPackage":Z
    :cond_19
    move/from16 v21, v2

    move-object/from16 v26, v4

    move/from16 v23, v7

    .line 47
    .end local v2    # "index$iv":I
    .end local v4    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v7    # "hasOldPackage":Z
    .restart local v23    # "hasOldPackage":Z
    .restart local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    goto :goto_17

    .line 756
    .end local v16    # "$i$f$forEachIndexed":I
    .end local v23    # "hasOldPackage":Z
    .end local v26    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v7    # "hasOldPackage":Z
    :cond_1a
    move/from16 v23, v7

    .line 781
    .end local v7    # "hasOldPackage":Z
    .restart local v23    # "hasOldPackage":Z
    :goto_17
    return-void
.end method

.method private final shouldGrantPermissionByProtectionFlags(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z
    .locals 11
    .param p1, "$this$shouldGrantPermissionByProtectionFlags"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "permission"    # Lcom/android/server/permission/access/permission/Permission;

    .line 1488
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    .line 1489
    .local v0, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getKnownPackages()Lcom/android/server/permission/access/immutable/IntMap;

    move-result-object v1

    .line 1490
    .local v1, "knownPackages":Lcom/android/server/permission/access/immutable/IntMap;
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v2

    .line 1491
    .local v2, "packageName":Ljava/lang/String;
    move-object v3, p3

    .local v3, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 105
    .local v4, "$i$f$isPrivileged":I
    move-object v5, v3

    .local v5, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 63
    .local v6, "$i$f$getProtectionFlags":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v7

    invoke-virtual {v7}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v5

    .line 105
    .end local v5    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$getProtectionFlags":I
    const/16 v6, 0x10

    invoke-static {v5, v6}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1491
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$isPrivileged":I
    const/4 v4, 0x0

    const/4 v5, 0x1

    if-nez v3, :cond_0

    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 96
    .local v6, "$i$f$isOem":I
    move-object v7, v3

    .local v7, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .local v8, "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 96
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/16 v8, 0x4000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1491
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isOem":I
    if-eqz v3, :cond_4

    :cond_0
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v3

    if-eqz v3, :cond_4

    .line 1493
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isUpdatedSystemApp()Z

    move-result v3

    if-eqz v3, :cond_3

    .line 1497
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/ExternalState;->getDisabledSystemPackageStates()Ljava/util/Map;

    move-result-object v3

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v6

    invoke-interface {v3, v6}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/pm/pkg/PackageState;

    .line 1496
    nop

    .line 1498
    .local v3, "disabledSystemPackageState":Lcom/android/server/pm/pkg/PackageState;
    if-eqz v3, :cond_1

    invoke-interface {v3}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v6

    goto :goto_0

    :cond_1
    const/4 v6, 0x0

    .line 1499
    .local v6, "disabledSystemPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :goto_0
    if-eqz v6, :cond_2

    .line 1500
    invoke-interface {v6}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v7

    move-object v8, p3

    .local v8, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 33
    .local v9, "$i$f$getName":I
    invoke-virtual {v8}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v10

    iget-object v8, v10, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1500
    .end local v8    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getName":I
    invoke-interface {v7, v8}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_2

    .line 1501
    invoke-direct {p0, p1, v3, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->shouldGrantPrivilegedOrOemPermission(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z

    move-result v7

    if-eqz v7, :cond_2

    move v3, v5

    goto :goto_1

    :cond_2
    move v3, v4

    .end local v3    # "disabledSystemPackageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v6    # "disabledSystemPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    goto :goto_1

    .line 1503
    :cond_3
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->shouldGrantPrivilegedOrOemPermission(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z

    move-result v3

    .line 1493
    :goto_1
    nop

    .line 1492
    nop

    .line 1505
    .local v3, "shouldGrant":Z
    if-eqz v3, :cond_4

    .line 1506
    return v5

    .line 1509
    .end local v3    # "shouldGrant":Z
    :cond_4
    move-object v3, p3

    .local v3, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 99
    .local v6, "$i$f$isPre23":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .local v8, "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 99
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/16 v8, 0x80

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1509
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isPre23":I
    if-eqz v3, :cond_5

    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v3

    const/16 v6, 0x17

    if-ge v3, v6, :cond_5

    .line 1513
    return v5

    .line 1515
    :cond_5
    nop

    .line 1516
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 84
    .local v6, "$i$f$isInstaller":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 84
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/16 v8, 0x100

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1516
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isInstaller":I
    if-eqz v3, :cond_7

    .line 1517
    const/4 v3, 0x2

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-nez v3, :cond_6

    .line 1518
    const/4 v3, 0x7

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_7

    .line 1522
    :cond_6
    return v5

    .line 1524
    :cond_7
    nop

    .line 1525
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 129
    .local v6, "$i$f$isVerifier":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 129
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/16 v8, 0x200

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1525
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isVerifier":I
    if-eqz v3, :cond_8

    const/4 v3, 0x4

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_8

    .line 1529
    return v5

    .line 1531
    :cond_8
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 102
    .local v6, "$i$f$isPreInstalled":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 102
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/16 v8, 0x400

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1531
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isPreInstalled":I
    if-eqz v3, :cond_9

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v3

    if-eqz v3, :cond_9

    .line 1533
    return v5

    .line 1535
    :cond_9
    nop

    .line 1536
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 90
    .local v6, "$i$f$isKnownSigner":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 90
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x8000000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1536
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isKnownSigner":I
    if-eqz v3, :cond_a

    .line 1537
    invoke-interface {v0}, Lcom/android/server/pm/pkg/AndroidPackage;->getSigningDetails()Landroid/content/pm/SigningDetails;

    move-result-object v3

    move-object v6, p3

    .local v6, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v7, 0x0

    .line 147
    .local v7, "$i$f$getKnownCerts":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v8

    iget-object v6, v8, Landroid/content/pm/PermissionInfo;->knownCerts:Ljava/util/Set;

    .line 1537
    .end local v6    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v7    # "$i$f$getKnownCerts":I
    invoke-virtual {v3, v6}, Landroid/content/pm/SigningDetails;->hasAncestorOrSelfWithDigest(Ljava/util/Set;)Z

    move-result v3

    if-eqz v3, :cond_a

    .line 1541
    return v5

    .line 1543
    :cond_a
    nop

    .line 1544
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 120
    .local v6, "$i$f$isSetup":I
    move-object v7, v3

    .local v7, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 120
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/16 v8, 0x800

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1544
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isSetup":I
    if-eqz v3, :cond_b

    invoke-virtual {v1, v5}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_b

    .line 1548
    return v5

    .line 1550
    :cond_b
    nop

    .line 1551
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 123
    .local v6, "$i$f$isSystemTextClassifier":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 123
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x10000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1551
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isSystemTextClassifier":I
    if-eqz v3, :cond_c

    .line 1552
    const/4 v3, 0x6

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_c

    .line 1555
    return v5

    .line 1557
    :cond_c
    nop

    .line 1558
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 75
    .local v6, "$i$f$isConfigurator":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 75
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x80000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1558
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isConfigurator":I
    if-eqz v3, :cond_d

    .line 1559
    const/16 v3, 0xa

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_d

    .line 1562
    return v5

    .line 1564
    :cond_d
    nop

    .line 1565
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 81
    .local v6, "$i$f$isIncidentReportApprover":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 81
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x100000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1565
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isIncidentReportApprover":I
    if-eqz v3, :cond_e

    .line 1566
    const/16 v3, 0xb

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_e

    .line 1570
    return v5

    .line 1572
    :cond_e
    nop

    .line 1573
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 69
    .local v6, "$i$f$isAppPredictor":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 69
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x200000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1573
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isAppPredictor":I
    if-eqz v3, :cond_f

    .line 1574
    const/16 v3, 0xc

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_f

    .line 1577
    return v5

    .line 1579
    :cond_f
    nop

    .line 1580
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 72
    .local v6, "$i$f$isCompanion":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 72
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x800000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1580
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isCompanion":I
    if-eqz v3, :cond_10

    .line 1581
    const/16 v3, 0xf

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_10

    .line 1584
    return v5

    .line 1586
    :cond_10
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 108
    .local v6, "$i$f$isRecents":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 108
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x2000000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1586
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isRecents":I
    if-eqz v3, :cond_11

    const/16 v3, 0x11

    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntMap;->get(I)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, [Ljava/lang/Object;

    invoke-static {v3, v2}, Lcom/android/server/permission/jarjar/kotlin/collections/ArraysKt;->contains([Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_11

    .line 1588
    return v5

    .line 1590
    :cond_11
    move-object v3, p3

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 93
    .local v6, "$i$f$isModule":I
    move-object v7, v3

    .restart local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 63
    .restart local v8    # "$i$f$getProtectionFlags":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v9

    invoke-virtual {v9}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v7

    .line 93
    .end local v7    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getProtectionFlags":I
    const/high16 v8, 0x400000

    invoke-static {v7, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 1590
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$isModule":I
    if-eqz v3, :cond_12

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getApexModuleName()Ljava/lang/String;

    move-result-object v3

    if-eqz v3, :cond_12

    .line 1592
    return v5

    .line 1594
    :cond_12
    return v4
.end method

.method private final shouldGrantPermissionBySignature(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z
    .locals 16
    .param p1, "$this$shouldGrantPermissionBySignature"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "permission"    # Lcom/android/server/permission/access/permission/Permission;

    .line 1216
    move-object/from16 v0, p0

    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v1}, Lcom/android/server/pm/pkg/AndroidPackage;->getSigningDetails()Landroid/content/pm/SigningDetails;

    move-result-object v1

    .line 1219
    .local v1, "packageSigningDetails":Landroid/content/pm/SigningDetails;
    nop

    .line 1218
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v2

    move-object/from16 v3, p3

    .local v3, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 36
    .local v4, "$i$f$getPackageName":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    iget-object v3, v5, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 1218
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$getPackageName":I
    invoke-interface {v2, v3}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/pm/pkg/PackageState;

    .line 1219
    const/4 v3, 0x0

    if-eqz v2, :cond_0

    .line 1218
    nop

    .line 1219
    invoke-interface {v2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v2

    .line 1220
    if-eqz v2, :cond_0

    .line 1219
    nop

    .line 1220
    invoke-interface {v2}, Lcom/android/server/pm/pkg/AndroidPackage;->getSigningDetails()Landroid/content/pm/SigningDetails;

    move-result-object v2

    goto :goto_0

    .line 1219
    :cond_0
    move-object v2, v3

    .line 1217
    :goto_0
    nop

    .line 1222
    .local v2, "sourceSigningDetails":Landroid/content/pm/SigningDetails;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v4

    const-string v5, "android"

    invoke-interface {v4, v5}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    invoke-static {v4}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v4, Lcom/android/server/pm/pkg/PackageState;

    .line 1223
    invoke-interface {v4}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v4

    invoke-static {v4}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    .line 1224
    invoke-interface {v4}, Lcom/android/server/pm/pkg/AndroidPackage;->getSigningDetails()Landroid/content/pm/SigningDetails;

    move-result-object v4

    .line 1221
    nop

    .line 1226
    .local v4, "platformSigningDetails":Landroid/content/pm/SigningDetails;
    const/4 v6, 0x4

    const/4 v7, 0x0

    const/4 v8, 0x1

    if-eqz v2, :cond_2

    .line 1227
    nop

    .line 1228
    nop

    .line 1226
    invoke-virtual {v2, v1, v6}, Landroid/content/pm/SigningDetails;->hasCommonSignerWithCapability(Landroid/content/pm/SigningDetails;I)Z

    move-result v9

    .line 1229
    if-ne v9, v8, :cond_1

    move v9, v8

    goto :goto_1

    :cond_1
    move v9, v7

    goto :goto_1

    .line 1226
    :cond_2
    move v9, v7

    :goto_1
    if-nez v9, :cond_4

    .line 1230
    invoke-virtual {v1, v4}, Landroid/content/pm/SigningDetails;->hasAncestorOrSelf(Landroid/content/pm/SigningDetails;)Z

    move-result v9

    if-nez v9, :cond_4

    .line 1231
    nop

    .line 1232
    nop

    .line 1233
    nop

    .line 1231
    invoke-virtual {v4, v1, v6}, Landroid/content/pm/SigningDetails;->checkCapability(Landroid/content/pm/SigningDetails;I)Z

    move-result v6

    if-eqz v6, :cond_3

    goto :goto_2

    :cond_3
    move v6, v7

    goto :goto_3

    :cond_4
    :goto_2
    move v6, v8

    .line 1225
    :goto_3
    nop

    .line 1235
    .local v6, "hasCommonSigner":Z
    invoke-static {}, Lcom/android/internal/hidden_from_bootclasspath/android/permission/flags/Flags;->signaturePermissionAllowlistEnabled()Z

    move-result v9

    if-nez v9, :cond_5

    .line 1236
    return v6

    .line 1238
    :cond_5
    if-nez v6, :cond_6

    .line 1239
    return v7

    .line 1242
    :cond_6
    move-object/from16 v9, p3

    .local v9, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v10, 0x0

    .line 36
    .local v10, "$i$f$getPackageName":I
    invoke-virtual {v9}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget-object v9, v11, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 1242
    .end local v9    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v10    # "$i$f$getPackageName":I
    invoke-static {v9, v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_c

    .line 1244
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->isSystem()Z

    move-result v5

    if-eqz v5, :cond_a

    .line 1247
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->isUpdatedSystemApp()Z

    move-result v5

    if-eqz v5, :cond_9

    .line 1251
    nop

    .line 1249
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getDisabledSystemPackageStates()Ljava/util/Map;

    move-result-object v5

    .line 1250
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v9

    .line 1249
    invoke-interface {v5, v9}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/pkg/PackageState;

    .line 1251
    if-eqz v5, :cond_7

    .line 1249
    nop

    .line 1251
    invoke-interface {v5}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v3

    .line 1248
    :cond_7
    nop

    .line 1252
    .local v3, "disabledSystemPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    if-eqz v3, :cond_8

    .line 1253
    invoke-interface {v3}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v5

    move-object/from16 v9, p3

    .restart local v9    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v10, 0x0

    .line 33
    .local v10, "$i$f$getName":I
    invoke-virtual {v9}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v11

    iget-object v9, v11, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1253
    .end local v9    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v10    # "$i$f$getName":I
    invoke-interface {v5, v9}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_8

    move v3, v8

    goto :goto_4

    :cond_8
    move v3, v7

    .end local v3    # "disabledSystemPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    goto :goto_4

    .line 1255
    :cond_9
    move v3, v8

    goto :goto_4

    .line 1258
    :cond_a
    move v3, v7

    .line 1244
    :goto_4
    nop

    .line 1243
    nop

    .line 1260
    .local v3, "isRequestedByFactoryApp":Z
    nop

    .line 1261
    if-nez v3, :cond_b

    .line 1262
    move-object/from16 v5, p3

    .local v5, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v9, 0x0

    .line 33
    .local v9, "$i$f$getName":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v10

    iget-object v5, v10, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1262
    .end local v5    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v9    # "$i$f$getName":I
    move-object/from16 v9, p1

    move-object/from16 v10, p2

    invoke-direct {v0, v9, v10, v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getSignaturePermissionAllowlistState(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v5

    invoke-static {v8}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v11

    invoke-static {v5, v11}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v5

    if-nez v5, :cond_d

    .line 1265
    sget-object v5, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1266
    move-object/from16 v11, p3

    .local v11, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v12, 0x0

    .line 33
    .local v12, "$i$f$getName":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v13

    iget-object v11, v13, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1267
    .end local v11    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v12    # "$i$f$getName":I
    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v12

    invoke-interface/range {p2 .. p2}, Lcom/android/server/pm/pkg/PackageState;->getPath()Ljava/io/File;

    move-result-object v13

    new-instance v14, Ljava/lang/StringBuilder;

    invoke-direct {v14}, Ljava/lang/StringBuilder;-><init>()V

    const-string v15, "Signature permission "

    invoke-virtual {v14, v15}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, " for package "

    invoke-virtual {v14, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v12}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v11, " ("

    invoke-virtual {v14, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v11, ") not in signature permission allowlist"

    invoke-virtual {v14, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v14}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v11

    .line 1264
    invoke-static {v5, v11}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1274
    invoke-static {}, Landroid/os/Build;->isDebuggable()Z

    .line 1275
    iget-boolean v5, v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->isSignaturePermissionAllowlistForceEnforced:Z

    if-eqz v5, :cond_d

    .line 1277
    return v7

    .line 1261
    :cond_b
    move-object/from16 v9, p1

    move-object/from16 v10, p2

    goto :goto_5

    .line 1242
    .end local v3    # "isRequestedByFactoryApp":Z
    :cond_c
    move-object/from16 v9, p1

    move-object/from16 v10, p2

    .line 1281
    :cond_d
    :goto_5
    return v8
.end method

.method private final shouldGrantPrivilegedOrOemPermission(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/permission/Permission;)Z
    .locals 8
    .param p1, "$this$shouldGrantPrivilegedOrOemPermission"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
    .param p3, "permission"    # Lcom/android/server/permission/access/permission/Permission;

    .line 1601
    move-object v0, p3

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 33
    .local v1, "$i$f$getName":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v2

    iget-object v0, v2, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1601
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$getName":I
    nop

    .line 1602
    .local v0, "permissionName":Ljava/lang/String;
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v1

    .line 1603
    .local v1, "packageName":Ljava/lang/String;
    nop

    .line 1604
    move-object v2, p3

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 105
    .local v3, "$i$f$isPrivileged":I
    move-object v4, v2

    .local v4, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v5, 0x0

    .line 63
    .local v5, "$i$f$getProtectionFlags":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v6

    invoke-virtual {v6}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v4

    .line 105
    .end local v4    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v5    # "$i$f$getProtectionFlags":I
    const/16 v5, 0x10

    invoke-static {v4, v5}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v2

    .line 1604
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$isPrivileged":I
    const/4 v3, 0x0

    if-eqz v2, :cond_2

    .line 1605
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isPrivileged()Z

    move-result v2

    if-eqz v2, :cond_4

    .line 1609
    nop

    .line 1610
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isVendor()Z

    move-result v2

    if-nez v2, :cond_0

    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isOdm()Z

    move-result v2

    if-eqz v2, :cond_1

    .line 1611
    :cond_0
    move-object v2, p3

    .restart local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 126
    .local v4, "$i$f$isVendorPrivileged":I
    move-object v5, v2

    .local v5, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 63
    .local v6, "$i$f$getProtectionFlags":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v7

    invoke-virtual {v7}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v5

    .line 126
    .end local v5    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$getProtectionFlags":I
    const v6, 0x8000

    invoke-static {v5, v6}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v2

    .line 1611
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$isVendorPrivileged":I
    if-nez v2, :cond_1

    .line 1614
    sget-object v2, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    .line 1615
    nop

    .line 1616
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Permission "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " cannot be granted to privileged vendor (or odm) app "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " because it isn\'t a vendorPrivileged permission"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 1613
    invoke-static {v2, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    .line 1619
    return v3

    .line 1621
    :cond_1
    const/4 v2, 0x1

    return v2

    .line 1624
    :cond_2
    move-object v2, p3

    .restart local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 96
    .local v4, "$i$f$isOem":I
    move-object v5, v2

    .restart local v5    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 63
    .restart local v6    # "$i$f$getProtectionFlags":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v7

    invoke-virtual {v7}, Landroid/content/pm/PermissionInfo;->getProtectionFlags()I

    move-result v5

    .line 96
    .end local v5    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$getProtectionFlags":I
    const/16 v6, 0x4000

    invoke-static {v5, v6}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v2

    .line 1624
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$isOem":I
    if-eqz v2, :cond_4

    .line 1625
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->isOem()Z

    move-result v2

    if-eqz v2, :cond_4

    .line 1627
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/ExternalState;->getPermissionAllowlist()Lcom/android/server/pm/permission/PermissionAllowlist;

    move-result-object v2

    .line 1628
    nop

    .line 1629
    nop

    .line 1627
    invoke-virtual {v2, v1, v0}, Lcom/android/server/pm/permission/PermissionAllowlist;->getOemAppAllowlistState(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/Boolean;

    move-result-object v2

    .line 1626
    nop

    .line 1631
    .local v2, "allowlistState":Ljava/lang/Boolean;
    if-eqz v2, :cond_3

    .line 1635
    invoke-virtual {v2}, Ljava/lang/Boolean;->booleanValue()Z

    move-result v3

    return v3

    .line 1631
    :cond_3
    const/4 v3, 0x0

    .line 1632
    .local v3, "$i$a$-checkNotNull-AppIdPermissionPolicy$shouldGrantPrivilegedOrOemPermission$1":I
    nop

    .line 1633
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "OEM permission "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " requested by package "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v5, " must be explicitly declared granted or not"

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    .line 1632
    nop

    .line 1631
    .end local v3    # "$i$a$-checkNotNull-AppIdPermissionPolicy$shouldGrantPrivilegedOrOemPermission$1":I
    new-instance v3, Ljava/lang/IllegalStateException;

    invoke-virtual {v4}, Ljava/lang/Object;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v3, v4}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v3

    .line 1639
    .end local v2    # "allowlistState":Ljava/lang/Boolean;
    :cond_4
    return v3
.end method

.method private final trimPermissionStates(Lcom/android/server/permission/access/MutateStateScope;I)V
    .locals 21
    .param p1, "$this$trimPermissionStates"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "appId"    # I

    .line 688
    move/from16 v6, p2

    new-instance v0, Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    const/4 v1, 0x0

    const/4 v7, 0x1

    invoke-direct {v0, v1, v7, v1}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;-><init>(Landroid/util/ArraySet;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    move-object v8, v0

    .line 689
    .local v8, "requestedPermissions":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    nop

    .line 1452
    nop

    .line 1454
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    .line 1452
    .local v0, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v1, 0x0

    .line 1457
    .local v1, "$i$f$forEachPackageInAppId":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v2

    invoke-virtual {v2, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v2

    invoke-static {v2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v2, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1458
    .local v2, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v3, v2

    .local v3, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v4, 0x0

    .line 38
    .local v4, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .local v5, "index$iv$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v9

    :goto_0
    if-ge v5, v9, :cond_1

    .line 39
    invoke-virtual {v3, v5}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Ljava/lang/String;

    .local v10, "packageName$iv":Ljava/lang/String;
    const/4 v11, 0x0

    .line 1459
    .local v11, "$i$a$-forEachIndexed-AppIdPermissionPolicy$forEachPackageInAppId$1$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v12

    invoke-virtual {v12}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v12

    invoke-interface {v12, v10}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v12

    invoke-static {v12}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v12, Lcom/android/server/pm/pkg/PackageState;

    .line 1460
    .local v12, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v12}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v13

    if-eqz v13, :cond_0

    .line 1461
    move-object v13, v12

    .local v13, "it":Lcom/android/server/pm/pkg/PackageState;
    const/4 v14, 0x0

    .line 697
    .local v14, "$i$a$-forEachPackageInAppId$default-AppIdPermissionPolicy$trimPermissionStates$1":I
    invoke-interface {v13}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v15

    invoke-static {v15}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v15}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v15

    invoke-static {v8, v15}, Lcom/android/server/permission/access/immutable/IndexedSetExtensionsKt;->plusAssign(Lcom/android/server/permission/access/immutable/MutableIndexedSet;Ljava/util/Collection;)V

    .line 698
    nop

    .line 1461
    .end local v13    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v14    # "$i$a$-forEachPackageInAppId$default-AppIdPermissionPolicy$trimPermissionStates$1":I
    nop

    .line 1463
    :cond_0
    nop

    .line 39
    .end local v10    # "packageName$iv":Ljava/lang/String;
    .end local v11    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$forEachPackageInAppId$1$iv":I
    .end local v12    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    nop

    .line 38
    add-int/lit8 v5, v5, 0x1

    goto :goto_0

    :cond_1
    nop

    .line 41
    .end local v5    # "index$iv$iv":I
    nop

    .line 1464
    .end local v3    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v4    # "$i$f$forEachIndexed":I
    nop

    .line 699
    .end local v0    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v1    # "$i$f$forEachPackageInAppId":I
    .end local v2    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v9

    .local v9, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/4 v10, 0x0

    .line 44
    .local v10, "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .local v0, "index$iv":I
    invoke-virtual {v9}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v11

    move v12, v0

    .end local v0    # "index$iv":I
    .local v12, "index$iv":I
    :goto_1
    if-ge v12, v11, :cond_5

    .line 45
    invoke-virtual {v9, v12}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v3

    .local v3, "userId":I
    invoke-virtual {v9, v12}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    move-object v13, v0

    check-cast v13, Lcom/android/server/permission/access/UserState;

    .local v13, "userState":Lcom/android/server/permission/access/UserState;
    const/4 v14, 0x0

    .line 700
    .local v14, "$i$a$-forEachIndexed-AppIdPermissionPolicy$trimPermissionStates$2":I
    invoke-virtual {v13}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/immutable/IndexedMap;

    nop

    if-eqz v0, :cond_4

    move-object v15, v0

    .local v15, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/16 v16, 0x0

    .line 53
    .local v16, "$i$f$forEachReversedIndexed":I
    nop

    .local v0, "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v1, 0x0

    .line 65
    .local v1, "$i$f$getLastIndex":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IndexedMap;->getSize()I

    move-result v2

    sub-int/2addr v2, v7

    .line 53
    .end local v0    # "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v1    # "$i$f$getLastIndex":I
    move v0, v2

    move v5, v0

    .local v5, "index$iv":I
    :goto_2
    const/4 v0, -0x1

    if-ge v0, v5, :cond_3

    .line 54
    invoke-virtual {v15, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v0

    invoke-virtual {v15, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/lang/Number;

    invoke-virtual {v1}, Ljava/lang/Number;->intValue()I

    move-object v4, v0

    check-cast v4, Ljava/lang/String;

    .local v4, "permissionName":Ljava/lang/String;
    const/16 v17, 0x0

    .line 701
    .local v17, "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$trimPermissionStates$2$1":I
    invoke-virtual {v8, v4}, Lcom/android/server/permission/access/immutable/IndexedSet;->contains(Ljava/lang/Object;)Z

    move-result v0

    if-nez v0, :cond_2

    .line 702
    const/16 v18, 0x0

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move-object/from16 v19, v4

    .end local v4    # "permissionName":Ljava/lang/String;
    .local v19, "permissionName":Ljava/lang/String;
    move/from16 v20, v5

    .end local v5    # "index$iv":I
    .local v20, "index$iv":I
    move/from16 v5, v18

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    goto :goto_3

    .line 701
    .end local v19    # "permissionName":Ljava/lang/String;
    .end local v20    # "index$iv":I
    .restart local v4    # "permissionName":Ljava/lang/String;
    .restart local v5    # "index$iv":I
    :cond_2
    move-object/from16 v19, v4

    move/from16 v20, v5

    .line 704
    .end local v4    # "permissionName":Ljava/lang/String;
    .end local v5    # "index$iv":I
    .restart local v19    # "permissionName":Ljava/lang/String;
    .restart local v20    # "index$iv":I
    :goto_3
    nop

    .line 54
    .end local v17    # "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$trimPermissionStates$2$1":I
    .end local v19    # "permissionName":Ljava/lang/String;
    nop

    .line 53
    add-int/lit8 v5, v20, -0x1

    .end local v20    # "index$iv":I
    .restart local v5    # "index$iv":I
    goto :goto_2

    :cond_3
    move/from16 v20, v5

    .line 56
    .end local v5    # "index$iv":I
    nop

    .line 705
    .end local v15    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v16    # "$i$f$forEachReversedIndexed":I
    :cond_4
    nop

    .line 45
    .end local v3    # "userId":I
    .end local v13    # "userState":Lcom/android/server/permission/access/UserState;
    .end local v14    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$trimPermissionStates$2":I
    nop

    .line 44
    add-int/lit8 v12, v12, 0x1

    goto :goto_1

    :cond_5
    nop

    .line 47
    .end local v12    # "index$iv":I
    nop

    .line 706
    .end local v9    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v10    # "$i$f$forEachIndexed":I
    return-void
.end method

.method private final trimPermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V
    .locals 31
    .param p1, "$this$trimPermissions"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "packageName"    # Ljava/lang/String;
    .param p3, "changedPermissionNames"    # Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/MutateStateScope;",
            "Ljava/lang/String;",
            "Lcom/android/server/permission/access/immutable/MutableIndexedSet<",
            "Ljava/lang/String;",
            ">;)V"
        }
    .end annotation

    .line 609
    move-object/from16 v0, p2

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface {v1, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    .line 610
    .local v1, "packageState":Lcom/android/server/pm/pkg/PackageState;
    if-eqz v1, :cond_0

    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v3

    goto :goto_0

    :cond_0
    const/4 v3, 0x0

    .line 611
    .local v3, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :goto_0
    if-eqz v1, :cond_1

    if-nez v3, :cond_1

    .line 612
    return-void

    .line 615
    :cond_1
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/ExternalState;->getDisabledSystemPackageStates()Ljava/util/Map;

    move-result-object v4

    invoke-interface {v4, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/pm/pkg/PackageState;

    if-eqz v4, :cond_2

    invoke-interface {v4}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v4

    goto :goto_1

    :cond_2
    const/4 v4, 0x0

    .line 614
    :goto_1
    nop

    .line 618
    .local v4, "disabledSystemPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/SystemState;->getPermissionTrees()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v5

    .local v5, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v6, 0x0

    .line 53
    .local v6, "$i$f$forEachReversedIndexed":I
    move-object v7, v5

    .local v7, "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v8, 0x0

    .line 65
    .local v8, "$i$f$getLastIndex":I
    invoke-virtual {v7}, Lcom/android/server/permission/access/immutable/IndexedMap;->getSize()I

    move-result v9

    const/4 v10, 0x1

    sub-int/2addr v9, v10

    .line 53
    .end local v7    # "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v8    # "$i$f$getLastIndex":I
    move v7, v9

    .local v7, "index$iv":I
    :goto_2
    const/4 v8, -0x1

    if-ge v8, v7, :cond_f

    .line 54
    invoke-virtual {v5, v7}, Lcom/android/server/permission/access/immutable/IndexedMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v8

    invoke-virtual {v5, v7}, Lcom/android/server/permission/access/immutable/IndexedMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/permission/access/permission/Permission;

    .local v11, "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    check-cast v8, Ljava/lang/String;

    .local v8, "permissionTreeName":Ljava/lang/String;
    move v12, v7

    .local v12, "permissionTreeIndex":I
    const/4 v13, 0x0

    .line 622
    .local v13, "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$trimPermissions$1":I
    nop

    .line 623
    move-object v14, v11

    .local v14, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v15, 0x0

    .line 36
    .local v15, "$i$f$getPackageName":I
    invoke-virtual {v14}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v2

    iget-object v2, v2, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 623
    .end local v14    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v15    # "$i$f$getPackageName":I
    invoke-static {v2, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_e

    .line 624
    if-eqz v1, :cond_7

    .line 625
    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v3}, Lcom/android/server/pm/pkg/AndroidPackage;->getPermissions()Ljava/util/List;

    move-result-object v2

    .local v2, "$this$noneIndexed$iv":Ljava/util/List;
    const/4 v14, 0x0

    .line 50
    .local v14, "$i$f$noneIndexed":I
    move-object v15, v2

    .local v15, "$this$forEachIndexed$iv$iv":Ljava/util/List;
    const/16 v16, 0x0

    .line 38
    .local v16, "$i$f$forEachIndexed":I
    const/16 v17, 0x0

    .local v17, "index$iv$iv":I
    invoke-interface {v15}, Ljava/util/List;->size()I

    move-result v9

    move/from16 v10, v17

    .end local v17    # "index$iv$iv":I
    .local v10, "index$iv$iv":I
    :goto_3
    if-ge v10, v9, :cond_6

    .line 39
    invoke-interface {v15, v10}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v17

    .local v17, "element$iv":Ljava/lang/Object;
    move/from16 v18, v10

    .local v18, "index$iv":I
    const/16 v19, 0x0

    .line 51
    .local v19, "$i$a$-forEachIndexed-ListExtensionsKt$noneIndexed$1$iv":I
    move-object/from16 v20, v17

    check-cast v20, Lcom/android/internal/pm/pkg/component/ParsedPermission;

    .local v20, "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    const/16 v21, 0x0

    .line 626
    .local v21, "$i$a$-noneIndexed-AppIdPermissionPolicy$trimPermissions$1$1":I
    invoke-interface/range {v20 .. v20}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v22

    if-eqz v22, :cond_3

    move-object/from16 v22, v2

    .end local v2    # "$this$noneIndexed$iv":Ljava/util/List;
    .local v22, "$this$noneIndexed$iv":Ljava/util/List;
    invoke-interface/range {v20 .. v20}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->getName()Ljava/lang/String;

    move-result-object v2

    invoke-static {v2, v8}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_4

    const/4 v2, 0x1

    goto :goto_4

    .end local v22    # "$this$noneIndexed$iv":Ljava/util/List;
    .restart local v2    # "$this$noneIndexed$iv":Ljava/util/List;
    :cond_3
    move-object/from16 v22, v2

    .end local v2    # "$this$noneIndexed$iv":Ljava/util/List;
    .restart local v22    # "$this$noneIndexed$iv":Ljava/util/List;
    :cond_4
    const/4 v2, 0x0

    .line 51
    .end local v20    # "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    .end local v21    # "$i$a$-noneIndexed-AppIdPermissionPolicy$trimPermissions$1$1":I
    :goto_4
    if-eqz v2, :cond_5

    .line 52
    const/4 v2, 0x0

    goto :goto_5

    .line 54
    :cond_5
    nop

    .line 39
    .end local v17    # "element$iv":Ljava/lang/Object;
    .end local v18    # "index$iv":I
    .end local v19    # "$i$a$-forEachIndexed-ListExtensionsKt$noneIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v10, v10, 0x1

    move-object/from16 v2, v22

    goto :goto_3

    .end local v22    # "$this$noneIndexed$iv":Ljava/util/List;
    .restart local v2    # "$this$noneIndexed$iv":Ljava/util/List;
    :cond_6
    move-object/from16 v22, v2

    .line 41
    .end local v2    # "$this$noneIndexed$iv":Ljava/util/List;
    .end local v10    # "index$iv$iv":I
    .restart local v22    # "$this$noneIndexed$iv":Ljava/util/List;
    nop

    .line 55
    .end local v15    # "$this$forEachIndexed$iv$iv":Ljava/util/List;
    .end local v16    # "$i$f$forEachIndexed":I
    const/4 v2, 0x1

    .line 625
    .end local v14    # "$i$f$noneIndexed":I
    .end local v22    # "$this$noneIndexed$iv":Ljava/util/List;
    :goto_5
    if-eqz v2, :cond_e

    .line 628
    :cond_7
    if-eqz v4, :cond_d

    invoke-interface {v4}, Lcom/android/server/pm/pkg/AndroidPackage;->getPermissions()Ljava/util/List;

    move-result-object v2

    if-eqz v2, :cond_d

    .local v2, "$this$anyIndexed$iv":Ljava/util/List;
    const/4 v9, 0x0

    .line 29
    .local v9, "$i$f$anyIndexed":I
    move-object v10, v2

    .local v10, "$this$forEachIndexed$iv$iv":Ljava/util/List;
    const/4 v14, 0x0

    .line 38
    .local v14, "$i$f$forEachIndexed":I
    const/4 v15, 0x0

    move-object/from16 v16, v2

    .end local v2    # "$this$anyIndexed$iv":Ljava/util/List;
    .local v15, "index$iv$iv":I
    .local v16, "$this$anyIndexed$iv":Ljava/util/List;
    invoke-interface {v10}, Ljava/util/List;->size()I

    move-result v2

    :goto_6
    if-ge v15, v2, :cond_b

    .line 39
    invoke-interface {v10, v15}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v17

    .restart local v17    # "element$iv":Ljava/lang/Object;
    move/from16 v18, v15

    .restart local v18    # "index$iv":I
    const/16 v19, 0x0

    .line 30
    .local v19, "$i$a$-forEachIndexed-ListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v20, v17

    check-cast v20, Lcom/android/internal/pm/pkg/component/ParsedPermission;

    .restart local v20    # "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    const/16 v21, 0x0

    .line 629
    .local v21, "$i$a$-anyIndexed-AppIdPermissionPolicy$trimPermissions$1$2":I
    invoke-interface/range {v20 .. v20}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v22

    if-eqz v22, :cond_8

    move/from16 v22, v2

    invoke-interface/range {v20 .. v20}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->getName()Ljava/lang/String;

    move-result-object v2

    invoke-static {v2, v8}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_9

    const/4 v2, 0x1

    goto :goto_7

    :cond_8
    move/from16 v22, v2

    :cond_9
    const/4 v2, 0x0

    .line 30
    .end local v20    # "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    .end local v21    # "$i$a$-anyIndexed-AppIdPermissionPolicy$trimPermissions$1$2":I
    :goto_7
    if-eqz v2, :cond_a

    .line 31
    const/4 v2, 0x1

    goto :goto_8

    .line 33
    :cond_a
    nop

    .line 39
    .end local v17    # "element$iv":Ljava/lang/Object;
    .end local v18    # "index$iv":I
    .end local v19    # "$i$a$-forEachIndexed-ListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v15, v15, 0x1

    move/from16 v2, v22

    goto :goto_6

    :cond_b
    nop

    .line 41
    .end local v15    # "index$iv$iv":I
    nop

    .line 34
    .end local v10    # "$this$forEachIndexed$iv$iv":Ljava/util/List;
    .end local v14    # "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .line 628
    .end local v9    # "$i$f$anyIndexed":I
    .end local v16    # "$this$anyIndexed$iv":Ljava/util/List;
    :goto_8
    nop

    .line 630
    const/4 v9, 0x1

    if-ne v2, v9, :cond_c

    const/4 v2, 0x1

    goto :goto_9

    :cond_c
    const/4 v2, 0x0

    goto :goto_9

    .line 628
    :cond_d
    const/4 v2, 0x0

    :goto_9
    if-nez v2, :cond_e

    .line 632
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v2

    const/4 v9, 0x0

    const/4 v10, 0x1

    const/4 v14, 0x0

    invoke-static {v2, v14, v10, v9}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissionTrees()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v2

    invoke-virtual {v2, v12}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->removeAt(I)Ljava/lang/Object;

    .line 634
    :cond_e
    nop

    .line 54
    .end local v8    # "permissionTreeName":Ljava/lang/String;
    .end local v11    # "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    .end local v12    # "permissionTreeIndex":I
    .end local v13    # "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$trimPermissions$1":I
    nop

    .line 53
    add-int/lit8 v7, v7, -0x1

    const/4 v10, 0x1

    goto/16 :goto_2

    :cond_f
    nop

    .line 56
    .end local v7    # "index$iv":I
    nop

    .line 636
    .end local v5    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v6    # "$i$f$forEachReversedIndexed":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v2

    invoke-virtual {v2}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v2

    .local v2, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v5, 0x0

    .line 53
    .local v5, "$i$f$forEachReversedIndexed":I
    move-object v6, v2

    .local v6, "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v7, 0x0

    .line 65
    .local v7, "$i$f$getLastIndex":I
    invoke-virtual {v6}, Lcom/android/server/permission/access/immutable/IndexedMap;->getSize()I

    move-result v9

    const/4 v10, 0x1

    sub-int/2addr v9, v10

    .line 53
    .end local v6    # "$this$lastIndex$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v7    # "$i$f$getLastIndex":I
    move v6, v9

    .local v6, "index$iv":I
    :goto_a
    if-ge v8, v6, :cond_20

    .line 54
    invoke-virtual {v2, v6}, Lcom/android/server/permission/access/immutable/IndexedMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v7

    invoke-virtual {v2, v6}, Lcom/android/server/permission/access/immutable/IndexedMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/permission/access/permission/Permission;

    .local v9, "permission":Lcom/android/server/permission/access/permission/Permission;
    check-cast v7, Ljava/lang/String;

    .local v7, "permissionName":Ljava/lang/String;
    move v15, v6

    .local v15, "permissionIndex":I
    const/16 v16, 0x0

    .line 640
    .local v16, "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$trimPermissions$2":I
    move-object/from16 v14, p0

    move-object/from16 v13, p1

    invoke-direct {v14, v13, v9}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->updatePermissionIfDynamic(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/permission/access/permission/Permission;)Lcom/android/server/permission/access/permission/Permission;

    move-result-object v12

    .line 641
    .local v12, "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v10

    .line 642
    move-object/from16 v18, v2

    const/4 v2, 0x0

    const/4 v8, 0x1

    const/4 v11, 0x0

    .end local v2    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .local v18, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    invoke-static {v10, v2, v8, v11}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v10

    .line 643
    invoke-virtual {v10}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissions()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v2

    .line 644
    invoke-virtual {v2, v15, v12}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->putAt(ILjava/lang/Object;)Ljava/lang/Object;

    .line 645
    nop

    .line 646
    move-object v2, v12

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v8, 0x0

    .line 36
    .local v8, "$i$f$getPackageName":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v10

    iget-object v2, v10, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 646
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v8    # "$i$f$getPackageName":I
    invoke-static {v2, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_1f

    .line 647
    if-eqz v1, :cond_15

    .line 648
    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v3}, Lcom/android/server/pm/pkg/AndroidPackage;->getPermissions()Ljava/util/List;

    move-result-object v2

    .local v2, "$this$noneIndexed$iv":Ljava/util/List;
    const/4 v8, 0x0

    .line 50
    .local v8, "$i$f$noneIndexed":I
    move-object v10, v2

    .restart local v10    # "$this$forEachIndexed$iv$iv":Ljava/util/List;
    const/4 v11, 0x0

    .line 38
    .local v11, "$i$f$forEachIndexed":I
    const/16 v19, 0x0

    .local v19, "index$iv$iv":I
    invoke-interface {v10}, Ljava/util/List;->size()I

    move-result v0

    move-object/from16 v20, v1

    move/from16 v1, v19

    .end local v19    # "index$iv$iv":I
    .local v1, "index$iv$iv":I
    .local v20, "packageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_b
    if-ge v1, v0, :cond_13

    .line 39
    invoke-interface {v10, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v19

    .local v19, "element$iv":Ljava/lang/Object;
    move/from16 v21, v1

    .local v21, "index$iv":I
    const/16 v22, 0x0

    .line 51
    .local v22, "$i$a$-forEachIndexed-ListExtensionsKt$noneIndexed$1$iv":I
    move-object/from16 v23, v19

    check-cast v23, Lcom/android/internal/pm/pkg/component/ParsedPermission;

    .local v23, "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    const/16 v24, 0x0

    .line 649
    .local v24, "$i$a$-noneIndexed-AppIdPermissionPolicy$trimPermissions$2$1":I
    invoke-interface/range {v23 .. v23}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v25

    if-nez v25, :cond_10

    move/from16 v25, v0

    invoke-interface/range {v23 .. v23}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0, v7}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_11

    const/4 v0, 0x1

    goto :goto_c

    :cond_10
    move/from16 v25, v0

    :cond_11
    const/4 v0, 0x0

    .line 51
    .end local v23    # "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    .end local v24    # "$i$a$-noneIndexed-AppIdPermissionPolicy$trimPermissions$2$1":I
    :goto_c
    if-eqz v0, :cond_12

    .line 52
    const/4 v0, 0x0

    goto :goto_d

    .line 54
    :cond_12
    nop

    .line 39
    .end local v19    # "element$iv":Ljava/lang/Object;
    .end local v21    # "index$iv":I
    .end local v22    # "$i$a$-forEachIndexed-ListExtensionsKt$noneIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v1, v1, 0x1

    move/from16 v0, v25

    goto :goto_b

    :cond_13
    nop

    .line 41
    .end local v1    # "index$iv$iv":I
    nop

    .line 55
    .end local v10    # "$this$forEachIndexed$iv$iv":Ljava/util/List;
    .end local v11    # "$i$f$forEachIndexed":I
    const/4 v0, 0x1

    .line 648
    .end local v2    # "$this$noneIndexed$iv":Ljava/util/List;
    .end local v8    # "$i$f$noneIndexed":I
    :goto_d
    if-eqz v0, :cond_14

    goto :goto_e

    :cond_14
    move-object/from16 v29, v12

    move v0, v15

    const/4 v2, 0x0

    const/4 v8, 0x1

    const/4 v10, 0x0

    goto/16 :goto_15

    .line 647
    .end local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .local v1, "packageState":Lcom/android/server/pm/pkg/PackageState;
    :cond_15
    move-object/from16 v20, v1

    .line 651
    .end local v1    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_e
    if-eqz v4, :cond_1b

    invoke-interface {v4}, Lcom/android/server/pm/pkg/AndroidPackage;->getPermissions()Ljava/util/List;

    move-result-object v0

    if-eqz v0, :cond_1b

    .local v0, "$this$anyIndexed$iv":Ljava/util/List;
    const/4 v1, 0x0

    .line 29
    .local v1, "$i$f$anyIndexed":I
    move-object v2, v0

    .local v2, "$this$forEachIndexed$iv$iv":Ljava/util/List;
    const/4 v8, 0x0

    .line 38
    .local v8, "$i$f$forEachIndexed":I
    const/4 v10, 0x0

    .local v10, "index$iv$iv":I
    invoke-interface {v2}, Ljava/util/List;->size()I

    move-result v11

    :goto_f
    if-ge v10, v11, :cond_19

    .line 39
    invoke-interface {v2, v10}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v19

    .restart local v19    # "element$iv":Ljava/lang/Object;
    move/from16 v21, v10

    .restart local v21    # "index$iv":I
    const/16 v22, 0x0

    .line 30
    .local v22, "$i$a$-forEachIndexed-ListExtensionsKt$anyIndexed$1$iv":I
    move-object/from16 v23, v19

    check-cast v23, Lcom/android/internal/pm/pkg/component/ParsedPermission;

    .restart local v23    # "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    const/16 v24, 0x0

    .line 652
    .local v24, "$i$a$-anyIndexed-AppIdPermissionPolicy$trimPermissions$2$2":I
    invoke-interface/range {v23 .. v23}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->isTree()Z

    move-result v25

    if-nez v25, :cond_16

    move-object/from16 v25, v0

    .end local v0    # "$this$anyIndexed$iv":Ljava/util/List;
    .local v25, "$this$anyIndexed$iv":Ljava/util/List;
    invoke-interface/range {v23 .. v23}, Lcom/android/internal/pm/pkg/component/ParsedPermission;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0, v7}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v0

    if-eqz v0, :cond_17

    const/4 v0, 0x1

    goto :goto_10

    .end local v25    # "$this$anyIndexed$iv":Ljava/util/List;
    .restart local v0    # "$this$anyIndexed$iv":Ljava/util/List;
    :cond_16
    move-object/from16 v25, v0

    .end local v0    # "$this$anyIndexed$iv":Ljava/util/List;
    .restart local v25    # "$this$anyIndexed$iv":Ljava/util/List;
    :cond_17
    const/4 v0, 0x0

    .line 30
    .end local v23    # "it":Lcom/android/internal/pm/pkg/component/ParsedPermission;
    .end local v24    # "$i$a$-anyIndexed-AppIdPermissionPolicy$trimPermissions$2$2":I
    :goto_10
    if-eqz v0, :cond_18

    .line 31
    const/4 v0, 0x1

    goto :goto_11

    .line 33
    :cond_18
    nop

    .line 39
    .end local v19    # "element$iv":Ljava/lang/Object;
    .end local v21    # "index$iv":I
    .end local v22    # "$i$a$-forEachIndexed-ListExtensionsKt$anyIndexed$1$iv":I
    nop

    .line 38
    add-int/lit8 v10, v10, 0x1

    move-object/from16 v0, v25

    goto :goto_f

    .end local v25    # "$this$anyIndexed$iv":Ljava/util/List;
    .restart local v0    # "$this$anyIndexed$iv":Ljava/util/List;
    :cond_19
    move-object/from16 v25, v0

    .line 41
    .end local v0    # "$this$anyIndexed$iv":Ljava/util/List;
    .end local v10    # "index$iv$iv":I
    .restart local v25    # "$this$anyIndexed$iv":Ljava/util/List;
    nop

    .line 34
    .end local v2    # "$this$forEachIndexed$iv$iv":Ljava/util/List;
    .end local v8    # "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .line 651
    .end local v1    # "$i$f$anyIndexed":I
    .end local v25    # "$this$anyIndexed$iv":Ljava/util/List;
    :goto_11
    nop

    .line 653
    const/4 v1, 0x1

    if-ne v0, v1, :cond_1a

    const/4 v0, 0x1

    goto :goto_12

    :cond_1a
    const/4 v0, 0x0

    goto :goto_12

    .line 651
    :cond_1b
    const/4 v0, 0x0

    :goto_12
    if-nez v0, :cond_1e

    .line 660
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v0

    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v1, 0x0

    .line 38
    .local v1, "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .local v2, "index$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v8

    :goto_13
    if-ge v2, v8, :cond_1d

    .line 39
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v19

    .local v19, "userId":I
    const/16 v21, 0x0

    .line 661
    .local v21, "$i$a$-forEachIndexed-AppIdPermissionPolicy$trimPermissions$2$3":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v11

    .local v11, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/16 v22, 0x0

    .line 44
    .local v22, "$i$f$forEachIndexed":I
    const/4 v10, 0x0

    move/from16 v23, v15

    .end local v15    # "permissionIndex":I
    .local v10, "index$iv":I
    .local v23, "permissionIndex":I
    invoke-virtual {v11}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v15

    :goto_14
    if-ge v10, v15, :cond_1c

    .line 45
    invoke-virtual {v11, v10}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v24

    .local v24, "appId":I
    invoke-virtual {v11, v10}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v25

    check-cast v25, Lcom/android/server/permission/access/immutable/IndexedListSet;

    const/16 v25, 0x0

    .line 662
    .local v25, "$i$a$-forEachIndexed-AppIdPermissionPolicy$trimPermissions$2$3$1":I
    const/16 v26, 0x0

    move/from16 v27, v10

    .end local v10    # "index$iv":I
    .local v27, "index$iv":I
    move-object/from16 v10, p0

    move-object/from16 v28, v11

    .end local v11    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .local v28, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    move-object/from16 v11, p1

    move-object/from16 v29, v12

    .end local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .local v29, "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    move/from16 v12, v24

    move/from16 v13, v19

    move-object v14, v7

    move-object/from16 v30, v0

    move/from16 v0, v23

    move/from16 v23, v15

    .end local v23    # "permissionIndex":I
    .local v0, "permissionIndex":I
    .local v30, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    move/from16 v15, v26

    invoke-virtual/range {v10 .. v15}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 663
    nop

    .line 45
    .end local v24    # "appId":I
    .end local v25    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$trimPermissions$2$3$1":I
    nop

    .line 44
    add-int/lit8 v10, v27, 0x1

    move-object/from16 v14, p0

    move-object/from16 v13, p1

    move/from16 v15, v23

    move-object/from16 v11, v28

    move-object/from16 v12, v29

    move/from16 v23, v0

    move-object/from16 v0, v30

    .end local v27    # "index$iv":I
    .restart local v10    # "index$iv":I
    goto :goto_14

    .end local v28    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v30    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v11    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v23    # "permissionIndex":I
    :cond_1c
    move-object/from16 v30, v0

    move/from16 v27, v10

    move-object/from16 v28, v11

    move-object/from16 v29, v12

    move/from16 v0, v23

    .line 47
    .end local v10    # "index$iv":I
    .end local v11    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v23    # "permissionIndex":I
    .local v0, "permissionIndex":I
    .restart local v28    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .restart local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v30    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    nop

    .line 664
    .end local v22    # "$i$f$forEachIndexed":I
    .end local v28    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    nop

    .line 39
    .end local v19    # "userId":I
    .end local v21    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$trimPermissions$2$3":I
    nop

    .line 38
    add-int/lit8 v2, v2, 0x1

    move-object/from16 v14, p0

    move-object/from16 v13, p1

    move v15, v0

    move-object/from16 v0, v30

    goto :goto_13

    .end local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v30    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .restart local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v15    # "permissionIndex":I
    :cond_1d
    move-object/from16 v30, v0

    move-object/from16 v29, v12

    move v0, v15

    .line 41
    .end local v2    # "index$iv":I
    .end local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v15    # "permissionIndex":I
    .local v0, "permissionIndex":I
    .restart local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v30    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    nop

    .line 665
    .end local v1    # "$i$f$forEachIndexed":I
    .end local v30    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    const/4 v2, 0x0

    const/4 v8, 0x1

    const/4 v10, 0x0

    invoke-static {v1, v10, v8, v2}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissions()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v1

    invoke-virtual {v1, v0}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->removeAt(I)Ljava/lang/Object;

    .line 666
    move-object/from16 v1, p3

    .local v1, "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    const/4 v11, 0x0

    .line 80
    .local v11, "$i$f$plusAssign":I
    invoke-virtual {v1, v7}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;->add(Ljava/lang/Object;)Z

    .line 81
    goto :goto_15

    .line 651
    .end local v0    # "permissionIndex":I
    .end local v1    # "$this$plusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .end local v11    # "$i$f$plusAssign":I
    .end local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v15    # "permissionIndex":I
    :cond_1e
    move-object/from16 v29, v12

    move v0, v15

    const/4 v2, 0x0

    const/4 v8, 0x1

    const/4 v10, 0x0

    .end local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v15    # "permissionIndex":I
    .restart local v0    # "permissionIndex":I
    .restart local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    goto :goto_15

    .line 646
    .end local v0    # "permissionIndex":I
    .end local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .local v1, "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .restart local v15    # "permissionIndex":I
    :cond_1f
    move-object/from16 v20, v1

    move-object/from16 v29, v12

    move v0, v15

    const/4 v2, 0x0

    const/4 v8, 0x1

    const/4 v10, 0x0

    .line 668
    .end local v1    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v12    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    .end local v15    # "permissionIndex":I
    .restart local v0    # "permissionIndex":I
    .restart local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    :goto_15
    nop

    .line 54
    .end local v0    # "permissionIndex":I
    .end local v7    # "permissionName":Ljava/lang/String;
    .end local v9    # "permission":Lcom/android/server/permission/access/permission/Permission;
    .end local v16    # "$i$a$-forEachReversedIndexed-AppIdPermissionPolicy$trimPermissions$2":I
    .end local v29    # "updatedPermission":Lcom/android/server/permission/access/permission/Permission;
    nop

    .line 53
    add-int/lit8 v6, v6, -0x1

    move-object/from16 v0, p2

    move-object/from16 v2, v18

    move-object/from16 v1, v20

    const/4 v8, -0x1

    goto/16 :goto_a

    .end local v18    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v1    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .local v2, "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    :cond_20
    nop

    .line 56
    .end local v6    # "index$iv":I
    nop

    .line 669
    .end local v2    # "$this$forEachReversedIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v5    # "$i$f$forEachReversedIndexed":I
    return-void
.end method

.method private final updatePermissionIfDynamic(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/permission/access/permission/Permission;)Lcom/android/server/permission/access/permission/Permission;
    .locals 10
    .param p1, "$this$updatePermissionIfDynamic"    # Lcom/android/server/permission/access/MutateStateScope;
    .param p2, "permission"    # Lcom/android/server/permission/access/permission/Permission;

    .line 672
    move-object v0, p2

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 42
    .local v1, "$i$f$isDynamic":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getType()I

    move-result v2

    const/4 v3, 0x2

    if-ne v2, v3, :cond_0

    const/4 v2, 0x1

    goto :goto_0

    :cond_0
    const/4 v2, 0x0

    .line 672
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$isDynamic":I
    :goto_0
    if-nez v2, :cond_1

    .line 673
    return-object p2

    .line 675
    :cond_1
    move-object v0, p2

    .restart local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 33
    .local v1, "$i$f$getName":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v2

    iget-object v0, v2, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 675
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$getName":I
    invoke-virtual {p0, p1, v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->findPermissionTree(Lcom/android/server/permission/access/GetStateScope;Ljava/lang/String;)Lcom/android/server/permission/access/permission/Permission;

    move-result-object v0

    if-nez v0, :cond_2

    return-object p2

    .line 679
    .local v0, "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    :cond_2
    new-instance v2, Landroid/content/pm/PermissionInfo;

    invoke-virtual {p2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v1

    invoke-direct {v2, v1}, Landroid/content/pm/PermissionInfo;-><init>(Landroid/content/pm/PermissionInfo;)V

    move-object v1, v2

    .local v1, "$this$updatePermissionIfDynamic_u24lambda_u2438":Landroid/content/pm/PermissionInfo;
    const/4 v3, 0x0

    .line 680
    .local v3, "$i$a$-apply-AppIdPermissionPolicy$updatePermissionIfDynamic$1":I
    move-object v4, v0

    .local v4, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v5, 0x0

    .line 36
    .local v5, "$i$f$getPackageName":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v6

    iget-object v4, v6, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 680
    .end local v4    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v5    # "$i$f$getPackageName":I
    iput-object v4, v1, Landroid/content/pm/PermissionInfo;->packageName:Ljava/lang/String;

    .line 681
    nop

    .line 679
    .end local v1    # "$this$updatePermissionIfDynamic_u24lambda_u2438":Landroid/content/pm/PermissionInfo;
    .end local v3    # "$i$a$-apply-AppIdPermissionPolicy$updatePermissionIfDynamic$1":I
    nop

    .line 682
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getAppId()I

    move-result v5

    .line 677
    nop

    .line 679
    nop

    .line 683
    nop

    .line 677
    nop

    .line 682
    nop

    .line 677
    const/16 v8, 0x34

    const/4 v9, 0x0

    const/4 v3, 0x1

    const/4 v4, 0x0

    const/4 v6, 0x0

    const/4 v7, 0x0

    move-object v1, p2

    invoke-static/range {v1 .. v9}, Lcom/android/server/permission/access/permission/Permission;->copy$default(Lcom/android/server/permission/access/permission/Permission;Landroid/content/pm/PermissionInfo;ZII[IZILjava/lang/Object;)Lcom/android/server/permission/access/permission/Permission;

    move-result-object v1

    return-object v1
.end method


# virtual methods
.method public final addOnPermissionFlagsChangedListener(Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;)V
    .locals 3
    .param p1, "listener"    # Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1776
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListenersLock:Ljava/lang/Object;

    monitor-enter v0

    const/4 v1, 0x0

    .line 1777
    .local v1, "$i$a$-synchronized-AppIdPermissionPolicy$addOnPermissionFlagsChangedListener$1":I
    :try_start_0
    iget-object v2, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListeners:Lcom/android/server/permission/access/immutable/IndexedListSet;

    invoke-static {v2, p1}, Lcom/android/server/permission/access/immutable/IndexedListSetExtensionsKt;->plus(Lcom/android/server/permission/access/immutable/IndexedListSet;Ljava/lang/Object;)Lcom/android/server/permission/access/immutable/MutableIndexedListSet;

    move-result-object v2

    iput-object v2, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListeners:Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1778
    nop

    .end local v1    # "$i$a$-synchronized-AppIdPermissionPolicy$addOnPermissionFlagsChangedListener$1":I
    sget-object v1, Lcom/android/server/permission/jarjar/kotlin/Unit;->INSTANCE:Lcom/android/server/permission/jarjar/kotlin/Unit;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 1776
    monitor-exit v0

    .line 1779
    return-void

    .line 1776
    :catchall_0
    move-exception v1

    monitor-exit v0

    throw v1
.end method

.method public final addPermission(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/permission/access/permission/Permission;Z)V
    .locals 5
    .param p1, "$this$addPermission"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "permission"    # Lcom/android/server/permission/access/permission/Permission;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "isSynchronousWrite"    # Z

    .line 1702
    if-eqz p3, :cond_0

    const/4 v0, 0x2

    goto :goto_0

    :cond_0
    const/4 v0, 0x1

    .line 1703
    .local v0, "writeMode":I
    :goto_0
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1, v0}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState(I)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissions()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v1

    move-object v2, p2

    .local v2, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v3, 0x0

    .line 33
    .local v3, "$i$f$getName":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v4

    iget-object v2, v4, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1703
    .end local v2    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v3    # "$i$f$getName":I
    nop

    .local v1, "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .local v2, "key$iv":Ljava/lang/Object;
    const/4 v3, 0x0

    .line 126
    .local v3, "$i$f$set":I
    invoke-virtual {v1, v2, p2}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 127
    nop

    .line 1704
    .end local v1    # "$this$set$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .end local v2    # "key$iv":Ljava/lang/Object;
    .end local v3    # "$i$f$set":I
    return-void
.end method

.method public final findPermissionTree(Lcom/android/server/permission/access/GetStateScope;Ljava/lang/String;)Lcom/android/server/permission/access/permission/Permission;
    .locals 17
    .param p1, "$this$findPermissionTree"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "permissionName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .annotation build Lorg/jetbrains/annotations/Nullable;
    .end annotation

    .line 1671
    move-object/from16 v0, p2

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/SystemState;->getPermissionTrees()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v1

    .local v1, "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v2, 0x0

    .line 38
    .local v2, "$i$f$firstNotNullOfOrNullIndexed":I
    move-object v3, v1

    .local v3, "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v4, 0x0

    .line 47
    .local v4, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .local v5, "index$iv$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IndexedMap;->getSize()I

    move-result v6

    :goto_0
    const/4 v7, 0x0

    if-ge v5, v6, :cond_2

    .line 48
    invoke-virtual {v3, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v8

    .local v8, "key$iv":Ljava/lang/Object;
    invoke-virtual {v3, v5}, Lcom/android/server/permission/access/immutable/IndexedMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v9

    .local v9, "value$iv":Ljava/lang/Object;
    move v10, v5

    .local v10, "index$iv":I
    const/4 v11, 0x0

    .line 39
    .local v11, "$i$a$-forEachIndexed-IndexedMapExtensionsKt$firstNotNullOfOrNullIndexed$1$iv":I
    move-object v12, v9

    check-cast v12, Lcom/android/server/permission/access/permission/Permission;

    .local v12, "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    move-object v13, v8

    check-cast v13, Ljava/lang/String;

    .local v13, "permissionTreeName":Ljava/lang/String;
    const/4 v14, 0x0

    .line 1675
    .local v14, "$i$a$-firstNotNullOfOrNullIndexed-AppIdPermissionPolicy$findPermissionTree$1":I
    nop

    .line 1676
    const/4 v15, 0x0

    move-object/from16 v16, v1

    .end local v1    # "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .local v16, "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    const/4 v1, 0x2

    invoke-static {v0, v13, v15, v1, v7}, Lcom/android/server/permission/jarjar/kotlin/text/StringsKt;->startsWith$default(Ljava/lang/String;Ljava/lang/String;ZILjava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 1677
    invoke-virtual/range {p2 .. p2}, Ljava/lang/String;->length()I

    move-result v1

    invoke-virtual {v13}, Ljava/lang/String;->length()I

    move-result v15

    if-le v1, v15, :cond_0

    .line 1678
    invoke-virtual {v13}, Ljava/lang/String;->length()I

    move-result v1

    invoke-virtual {v0, v1}, Ljava/lang/String;->charAt(I)C

    move-result v1

    const/16 v15, 0x2e

    if-ne v1, v15, :cond_0

    .line 1680
    move-object v7, v12

    goto :goto_1

    .line 1682
    :cond_0
    nop

    .line 1675
    :goto_1
    nop

    .line 39
    .end local v12    # "permissionTree":Lcom/android/server/permission/access/permission/Permission;
    .end local v13    # "permissionTreeName":Ljava/lang/String;
    .end local v14    # "$i$a$-firstNotNullOfOrNullIndexed-AppIdPermissionPolicy$findPermissionTree$1":I
    nop

    nop

    if-eqz v7, :cond_1

    .local v7, "it$iv":Ljava/lang/Object;
    const/4 v1, 0x0

    .line 40
    .local v1, "$i$a$-let-IndexedMapExtensionsKt$firstNotNullOfOrNullIndexed$1$1$iv":I
    goto :goto_2

    .line 42
    .end local v1    # "$i$a$-let-IndexedMapExtensionsKt$firstNotNullOfOrNullIndexed$1$1$iv":I
    .end local v7    # "it$iv":Ljava/lang/Object;
    :cond_1
    nop

    .line 48
    .end local v8    # "key$iv":Ljava/lang/Object;
    .end local v9    # "value$iv":Ljava/lang/Object;
    .end local v10    # "index$iv":I
    .end local v11    # "$i$a$-forEachIndexed-IndexedMapExtensionsKt$firstNotNullOfOrNullIndexed$1$iv":I
    nop

    .line 47
    add-int/lit8 v5, v5, 0x1

    move-object/from16 v1, v16

    goto :goto_0

    .end local v16    # "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .local v1, "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    :cond_2
    move-object/from16 v16, v1

    .line 50
    .end local v1    # "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v5    # "index$iv$iv":I
    .restart local v16    # "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    nop

    .line 43
    .end local v3    # "$this$forEachIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    .end local v4    # "$i$f$forEachIndexed":I
    nop

    .line 1684
    .end local v2    # "$i$f$firstNotNullOfOrNullIndexed":I
    .end local v16    # "$this$firstNotNullOfOrNullIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedMap;
    :goto_2
    return-object v7
.end method

.method public final getAllPermissionFlags(Lcom/android/server/permission/access/GetStateScope;II)Lcom/android/server/permission/access/immutable/IndexedMap;
    .locals 1
    .param p1, "$this$getAllPermissionFlags"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/GetStateScope;",
            "II)",
            "Lcom/android/server/permission/access/immutable/IndexedMap<",
            "Ljava/lang/String;",
            "Ljava/lang/Integer;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/Nullable;
    .end annotation

    .line 1731
    invoke-virtual {p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, p3}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/UserState;

    if-eqz v0, :cond_0

    invoke-virtual {v0}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    if-eqz v0, :cond_0

    invoke-virtual {v0, p2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/immutable/IndexedMap;

    goto :goto_0

    :cond_0
    const/4 v0, 0x0

    :goto_0
    return-object v0
.end method

.method public getObjectScheme()Ljava/lang/String;
    .locals 1
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation

    .line 74
    const-string/jumbo v0, "permission"

    return-object v0
.end method

.method public final getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I
    .locals 1
    .param p1, "$this$getPermissionFlags"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permissionName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1714
    invoke-virtual {p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-direct {p0, v0, p2, p3, p4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/AccessState;IILjava/lang/String;)I

    move-result v0

    return v0
.end method

.method public final getPermissionGroups(Lcom/android/server/permission/access/GetStateScope;)Lcom/android/server/permission/access/immutable/IndexedMap;
    .locals 1
    .param p1, "$this$getPermissionGroups"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/GetStateScope;",
            ")",
            "Lcom/android/server/permission/access/immutable/IndexedMap<",
            "Ljava/lang/String;",
            "Landroid/content/pm/PermissionGroupInfo;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation

    .line 1692
    invoke-virtual {p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/SystemState;->getPermissionGroups()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v0

    return-object v0
.end method

.method public final getPermissionTrees(Lcom/android/server/permission/access/GetStateScope;)Lcom/android/server/permission/access/immutable/IndexedMap;
    .locals 1
    .param p1, "$this$getPermissionTrees"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/GetStateScope;",
            ")",
            "Lcom/android/server/permission/access/immutable/IndexedMap<",
            "Ljava/lang/String;",
            "Lcom/android/server/permission/access/permission/Permission;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation

    .line 1668
    invoke-virtual {p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/SystemState;->getPermissionTrees()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v0

    return-object v0
.end method

.method public final getPermissions(Lcom/android/server/permission/access/GetStateScope;)Lcom/android/server/permission/access/immutable/IndexedMap;
    .locals 1
    .param p1, "$this$getPermissions"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/GetStateScope;",
            ")",
            "Lcom/android/server/permission/access/immutable/IndexedMap<",
            "Ljava/lang/String;",
            "Lcom/android/server/permission/access/permission/Permission;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation

    .line 1696
    invoke-virtual {p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v0

    return-object v0
.end method

.method public getSubjectScheme()Ljava/lang/String;
    .locals 1
    .annotation build Lorg/jetbrains/annotations/NotNull;
    .end annotation

    .line 71
    const-string/jumbo v0, "uid"

    return-object v0
.end method

.method public final getUidPermissionFlags(Lcom/android/server/permission/access/GetStateScope;II)Lcom/android/server/permission/access/immutable/IndexedMap;
    .locals 1
    .param p1, "$this$getUidPermissionFlags"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/GetStateScope;",
            "II)",
            "Lcom/android/server/permission/access/immutable/IndexedMap<",
            "Ljava/lang/String;",
            "Ljava/lang/Integer;",
            ">;"
        }
    .end annotation

    .annotation build Lorg/jetbrains/annotations/Nullable;
    .end annotation

    .line 1711
    invoke-virtual {p1}, Lcom/android/server/permission/access/GetStateScope;->getState()Lcom/android/server/permission/access/AccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, p3}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/UserState;

    if-eqz v0, :cond_0

    invoke-virtual {v0}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    if-eqz v0, :cond_0

    invoke-virtual {v0, p2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/immutable/IndexedMap;

    goto :goto_0

    :cond_0
    const/4 v0, 0x0

    :goto_0
    return-object v0
.end method

.method public final isSignaturePermissionAllowlistForceEnforced()Z
    .locals 1

    .line 68
    iget-boolean v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->isSignaturePermissionAllowlistForceEnforced:Z

    return v0
.end method

.method public migrateSystemState(Lcom/android/server/permission/access/MutableAccessState;)V
    .locals 1
    .param p1, "state"    # Lcom/android/server/permission/access/MutableAccessState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1788
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->migration:Lcom/android/server/permission/access/permission/AppIdPermissionMigration;

    invoke-virtual {v0, p1}, Lcom/android/server/permission/access/permission/AppIdPermissionMigration;->migrateSystemState$frameworks__base__services__permission__android_common__services_permission_pre_jarjar(Lcom/android/server/permission/access/MutableAccessState;)V

    .line 1789
    return-void
.end method

.method public migrateUserState(Lcom/android/server/permission/access/MutableAccessState;I)V
    .locals 1
    .param p1, "state"    # Lcom/android/server/permission/access/MutableAccessState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "userId"    # I

    .line 1792
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->migration:Lcom/android/server/permission/access/permission/AppIdPermissionMigration;

    invoke-virtual {v0, p1, p2}, Lcom/android/server/permission/access/permission/AppIdPermissionMigration;->migrateUserState$frameworks__base__services__permission__android_common__services_permission_pre_jarjar(Lcom/android/server/permission/access/MutableAccessState;I)V

    .line 1793
    return-void
.end method

.method public onAppIdRemoved(Lcom/android/server/permission/access/MutateStateScope;I)V
    .locals 11
    .param p1, "$this$onAppIdRemoved"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I

    .line 93
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/4 v1, 0x0

    .line 44
    .local v1, "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .local v2, "index$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v3

    :goto_0
    if-ge v2, v3, :cond_1

    .line 45
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v4

    check-cast v4, Lcom/android/server/permission/access/UserState;

    .local v4, "userState":Lcom/android/server/permission/access/UserState;
    move v5, v2

    .local v5, "userStateIndex":I
    const/4 v6, 0x0

    .line 94
    .local v6, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onAppIdRemoved$1":I
    invoke-virtual {v4}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v7

    invoke-virtual {v7, p2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->contains(I)Z

    move-result v7

    if-eqz v7, :cond_0

    .line 95
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v7

    const/4 v8, 0x2

    const/4 v9, 0x0

    const/4 v10, 0x0

    invoke-static {v7, v5, v10, v8, v9}, Lcom/android/server/permission/access/MutableAccessState;->mutateUserStateAt$default(Lcom/android/server/permission/access/MutableAccessState;IIILjava/lang/Object;)Lcom/android/server/permission/access/MutableUserState;

    move-result-object v7

    invoke-virtual {v7}, Lcom/android/server/permission/access/MutableUserState;->mutateAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;

    move-result-object v7

    invoke-static {v7, p2}, Lcom/android/server/permission/access/immutable/IntReferenceMapExtensionsKt;->minusAssign(Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;I)V

    .line 98
    :cond_0
    nop

    .line 45
    .end local v4    # "userState":Lcom/android/server/permission/access/UserState;
    .end local v5    # "userStateIndex":I
    .end local v6    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onAppIdRemoved$1":I
    nop

    .line 44
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_1
    nop

    .line 47
    .end local v2    # "index$iv":I
    nop

    .line 99
    .end local v0    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v1    # "$i$f$forEachIndexed":I
    return-void
.end method

.method public onPackageAdded(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;)V
    .locals 8
    .param p1, "$this$onPackageAdded"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 138
    new-instance v0, Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    const/4 v1, 0x1

    const/4 v2, 0x0

    invoke-direct {v0, v2, v1, v2}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;-><init>(Landroid/util/ArraySet;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    .line 139
    .local v0, "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->adoptPermissions(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 140
    invoke-direct {p0, p1, p2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->addPermissionGroups(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;)V

    .line 141
    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->addPermissions(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 142
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v1

    invoke-direct {p0, p1, v1, v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->trimPermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 143
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v1

    invoke-direct {p0, p1, v1}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->trimPermissionStates(Lcom/android/server/permission/access/MutateStateScope;I)V

    .line 144
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v1

    invoke-direct {p0, p1, v1}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->revokePermissionsOnPackageUpdate(Lcom/android/server/permission/access/MutateStateScope;I)V

    .line 145
    move-object v1, v0

    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    const/4 v3, 0x0

    .line 44
    .local v3, "$i$f$forEachIndexed":I
    const/4 v4, 0x0

    .local v4, "index$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/immutable/IndexedSet;->getSize()I

    move-result v5

    :goto_0
    if-ge v4, v5, :cond_0

    .line 45
    invoke-virtual {v1, v4}, Lcom/android/server/permission/access/immutable/IndexedSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    .local v6, "permissionName":Ljava/lang/String;
    const/4 v7, 0x0

    .line 146
    .local v7, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onPackageAdded$1":I
    invoke-direct {p0, p1, v6, v2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluatePermissionStateForAllPackages(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V

    .line 147
    nop

    .line 45
    .end local v6    # "permissionName":Ljava/lang/String;
    .end local v7    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onPackageAdded$1":I
    nop

    .line 44
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_0
    nop

    .line 47
    .end local v4    # "index$iv":I
    nop

    .line 148
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .end local v3    # "$i$f$forEachIndexed":I
    invoke-direct {p0, p1, p2, p2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluateAllPermissionStatesForPackage(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/pm/pkg/PackageState;)V

    .line 149
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v1

    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v2, 0x0

    .line 38
    .local v2, "$i$f$forEachIndexed":I
    const/4 v3, 0x0

    .local v3, "index$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v4

    :goto_1
    if-ge v3, v4, :cond_1

    .line 39
    invoke-virtual {v1, v3}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v5

    .local v5, "userId":I
    const/4 v6, 0x0

    .line 150
    .local v6, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onPackageAdded$2":I
    invoke-interface {p2}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v7

    invoke-direct {p0, p1, v7, v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->inheritImplicitPermissionStates(Lcom/android/server/permission/access/MutateStateScope;II)V

    .line 151
    nop

    .line 39
    .end local v5    # "userId":I
    .end local v6    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onPackageAdded$2":I
    nop

    .line 38
    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    :cond_1
    nop

    .line 41
    .end local v3    # "index$iv":I
    nop

    .line 152
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v2    # "$i$f$forEachIndexed":I
    return-void
.end method

.method public onPackageInstalled(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;I)V
    .locals 0
    .param p1, "$this$onPackageInstalled"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "userId"    # I

    .line 172
    invoke-direct {p0, p1, p2, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->clearRestrictedPermissionImplicitExemption(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;I)V

    .line 173
    return-void
.end method

.method public onPackageRemoved(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;I)V
    .locals 8
    .param p1, "$this$onPackageRemoved"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "packageName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "appId"    # I

    .line 155
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getDisabledSystemPackageStates()Ljava/util/Map;

    move-result-object v0

    invoke-interface {v0, p2}, Ljava/util/Map;->containsKey(Ljava/lang/Object;)Z

    move-result v0

    const/4 v1, 0x1

    xor-int/2addr v0, v1

    if-eqz v0, :cond_2

    .line 159
    new-instance v0, Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    const/4 v2, 0x0

    invoke-direct {v0, v2, v1, v2}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;-><init>(Landroid/util/ArraySet;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    .line 160
    .local v0, "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    invoke-direct {p0, p1, p2, v0}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->trimPermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 161
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v1

    invoke-virtual {v1, p3}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->contains(I)Z

    move-result v1

    if-eqz v1, :cond_0

    .line 162
    invoke-direct {p0, p1, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->trimPermissionStates(Lcom/android/server/permission/access/MutateStateScope;I)V

    .line 164
    :cond_0
    move-object v1, v0

    .local v1, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    const/4 v3, 0x0

    .line 44
    .local v3, "$i$f$forEachIndexed":I
    const/4 v4, 0x0

    .local v4, "index$iv":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/immutable/IndexedSet;->getSize()I

    move-result v5

    :goto_0
    if-ge v4, v5, :cond_1

    .line 45
    invoke-virtual {v1, v4}, Lcom/android/server/permission/access/immutable/IndexedSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    .local v6, "permissionName":Ljava/lang/String;
    const/4 v7, 0x0

    .line 165
    .local v7, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onPackageRemoved$2":I
    invoke-direct {p0, p1, v6, v2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluatePermissionStateForAllPackages(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V

    .line 166
    nop

    .line 45
    .end local v6    # "permissionName":Ljava/lang/String;
    .end local v7    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onPackageRemoved$2":I
    nop

    .line 44
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_1
    nop

    .line 47
    .end local v4    # "index$iv":I
    nop

    .line 167
    .end local v1    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .end local v3    # "$i$f$forEachIndexed":I
    return-void

    .line 155
    .end local v0    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    :cond_2
    const/4 v0, 0x0

    .line 156
    .local v0, "$i$a$-check-AppIdPermissionPolicy$onPackageRemoved$1":I
    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Package "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v2, " reported as removed before disabled system package is enabled"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    .line 155
    .end local v0    # "$i$a$-check-AppIdPermissionPolicy$onPackageRemoved$1":I
    new-instance v1, Ljava/lang/IllegalStateException;

    invoke-virtual {v0}, Ljava/lang/Object;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-direct {v1, v0}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public onPackageUninstalled(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;II)V
    .locals 0
    .param p1, "$this$onPackageUninstalled"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "packageName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "appId"    # I
    .param p4, "userId"    # I

    .line 274
    invoke-virtual {p0, p1, p2, p4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->resetRuntimePermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;I)V

    .line 275
    return-void
.end method

.method public onStateMutated(Lcom/android/server/permission/access/GetStateScope;)V
    .locals 6
    .param p1, "$this$onStateMutated"    # Lcom/android/server/permission/access/GetStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 77
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListeners:Lcom/android/server/permission/access/immutable/IndexedListSet;

    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v1, 0x0

    .line 38
    .local v1, "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .local v2, "index$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v3

    :goto_0
    if-ge v2, v3, :cond_0

    .line 39
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;

    .local v4, "it":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;
    const/4 v5, 0x0

    .line 77
    .local v5, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStateMutated$1":I
    invoke-interface {v4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;->onStateMutated()V

    .line 39
    .end local v4    # "it":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;
    .end local v5    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStateMutated$1":I
    nop

    .line 38
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_0
    nop

    .line 41
    .end local v2    # "index$iv":I
    nop

    .line 78
    .end local v0    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v1    # "$i$f$forEachIndexed":I
    return-void
.end method

.method public onStorageVolumeMounted(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Ljava/util/List;Z)V
    .locals 17
    .param p1, "$this$onStorageVolumeMounted"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "volumeUuid"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/Nullable;
        .end annotation
    .end param
    .param p3, "packageNames"    # Ljava/util/List;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p4, "isSystemUpdated"    # Z
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/android/server/permission/access/MutateStateScope;",
            "Ljava/lang/String;",
            "Ljava/util/List<",
            "Ljava/lang/String;",
            ">;Z)V"
        }
    .end annotation

    .line 106
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    new-instance v2, Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    const/4 v3, 0x1

    const/4 v4, 0x0

    invoke-direct {v2, v4, v3, v4}, Lcom/android/server/permission/access/immutable/MutableIndexedSet;-><init>(Landroid/util/ArraySet;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    .line 107
    .local v2, "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    move-object/from16 v3, p3

    .local v3, "$this$forEachIndexed$iv":Ljava/util/List;
    const/4 v5, 0x0

    .line 38
    .local v5, "$i$f$forEachIndexed":I
    const/4 v6, 0x0

    .local v6, "index$iv":I
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v7

    :goto_0
    if-ge v6, v7, :cond_1

    .line 39
    invoke-interface {v3, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    .local v8, "packageName":Ljava/lang/String;
    const/4 v9, 0x0

    .line 110
    .local v9, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$1":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v10

    invoke-interface {v10, v8}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/pkg/PackageState;

    if-nez v10, :cond_0

    goto :goto_1

    .line 109
    :cond_0
    nop

    .line 111
    .local v10, "packageState":Lcom/android/server/pm/pkg/PackageState;
    invoke-direct {v0, v1, v10, v2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->adoptPermissions(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 112
    invoke-direct {v0, v1, v10}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->addPermissionGroups(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;)V

    .line 113
    invoke-direct {v0, v1, v10, v2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->addPermissions(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 114
    invoke-interface {v10}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v11

    invoke-direct {v0, v1, v11, v2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->trimPermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/permission/access/immutable/MutableIndexedSet;)V

    .line 115
    invoke-interface {v10}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v11

    invoke-direct {v0, v1, v11}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->trimPermissionStates(Lcom/android/server/permission/access/MutateStateScope;I)V

    .line 116
    invoke-interface {v10}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v11

    invoke-direct {v0, v1, v11}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->revokePermissionsOnPackageUpdate(Lcom/android/server/permission/access/MutateStateScope;I)V

    .line 117
    nop

    .line 39
    .end local v8    # "packageName":Ljava/lang/String;
    .end local v9    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$1":I
    .end local v10    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_1
    nop

    .line 38
    add-int/lit8 v6, v6, 0x1

    goto :goto_0

    :cond_1
    nop

    .line 41
    .end local v6    # "index$iv":I
    nop

    .line 118
    .end local v3    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v5    # "$i$f$forEachIndexed":I
    move-object v3, v2

    .local v3, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    const/4 v5, 0x0

    .line 44
    .restart local v5    # "$i$f$forEachIndexed":I
    const/4 v6, 0x0

    .restart local v6    # "index$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/immutable/IndexedSet;->getSize()I

    move-result v7

    :goto_2
    if-ge v6, v7, :cond_2

    .line 45
    invoke-virtual {v3, v6}, Lcom/android/server/permission/access/immutable/IndexedSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    .local v8, "permissionName":Ljava/lang/String;
    const/4 v9, 0x0

    .line 119
    .local v9, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$2":I
    invoke-direct {v0, v1, v8, v4}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluatePermissionStateForAllPackages(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;Lcom/android/server/pm/pkg/PackageState;)V

    .line 120
    nop

    .line 45
    .end local v8    # "permissionName":Ljava/lang/String;
    .end local v9    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$2":I
    nop

    .line 44
    add-int/lit8 v6, v6, 0x1

    goto :goto_2

    :cond_2
    nop

    .line 47
    .end local v6    # "index$iv":I
    nop

    .line 122
    .end local v3    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedSet;
    .end local v5    # "$i$f$forEachIndexed":I
    move-object/from16 v3, p3

    .local v3, "$this$forEachIndexed$iv":Ljava/util/List;
    const/4 v5, 0x0

    .line 38
    .restart local v5    # "$i$f$forEachIndexed":I
    const/4 v6, 0x0

    .restart local v6    # "index$iv":I
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v7

    :goto_3
    if-ge v6, v7, :cond_5

    .line 39
    invoke-interface {v3, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    .local v8, "packageName":Ljava/lang/String;
    const/4 v9, 0x0

    .line 124
    .local v9, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$3":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v10

    invoke-interface {v10, v8}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/pm/pkg/PackageState;

    if-nez v10, :cond_3

    goto :goto_5

    .line 123
    :cond_3
    nop

    .line 125
    .restart local v10    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    if-eqz p4, :cond_4

    move-object v11, v10

    goto :goto_4

    :cond_4
    move-object v11, v4

    .line 126
    .local v11, "installedPackageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_4
    invoke-direct {v0, v1, v10, v11}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluateAllPermissionStatesForPackage(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;Lcom/android/server/pm/pkg/PackageState;)V

    .line 127
    nop

    .line 39
    .end local v8    # "packageName":Ljava/lang/String;
    .end local v9    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$3":I
    .end local v10    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v11    # "installedPackageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_5
    nop

    .line 38
    add-int/lit8 v6, v6, 0x1

    goto :goto_3

    :cond_5
    nop

    .line 41
    .end local v6    # "index$iv":I
    nop

    .line 128
    .end local v3    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v5    # "$i$f$forEachIndexed":I
    move-object/from16 v3, p3

    .restart local v3    # "$this$forEachIndexed$iv":Ljava/util/List;
    const/4 v4, 0x0

    .line 38
    .local v4, "$i$f$forEachIndexed":I
    const/4 v5, 0x0

    .local v5, "index$iv":I
    invoke-interface {v3}, Ljava/util/List;->size()I

    move-result v6

    :goto_6
    if-ge v5, v6, :cond_8

    .line 39
    invoke-interface {v3, v5}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/lang/String;

    .local v7, "packageName":Ljava/lang/String;
    const/4 v8, 0x0

    .line 130
    .local v8, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$4":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v9

    invoke-virtual {v9}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v9

    invoke-virtual {v9}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v9

    invoke-interface {v9, v7}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/pm/pkg/PackageState;

    if-nez v9, :cond_6

    move-object/from16 v16, v2

    goto :goto_8

    .line 129
    :cond_6
    nop

    .line 131
    .local v9, "packageState":Lcom/android/server/pm/pkg/PackageState;
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v10

    invoke-virtual {v10}, Lcom/android/server/permission/access/ExternalState;->getUserIds()Lcom/android/server/permission/access/immutable/IntSet;

    move-result-object v10

    .local v10, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    const/4 v11, 0x0

    .line 38
    .local v11, "$i$f$forEachIndexed":I
    const/4 v12, 0x0

    .local v12, "index$iv":I
    invoke-virtual {v10}, Lcom/android/server/permission/access/immutable/IntSet;->getSize()I

    move-result v13

    :goto_7
    if-ge v12, v13, :cond_7

    .line 39
    invoke-virtual {v10, v12}, Lcom/android/server/permission/access/immutable/IntSet;->elementAt(I)I

    move-result v14

    .local v14, "userId":I
    const/4 v15, 0x0

    .line 132
    .local v15, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$4$1":I
    move-object/from16 v16, v2

    .end local v2    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .local v16, "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    invoke-interface {v9}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v2

    invoke-direct {v0, v1, v2, v14}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->inheritImplicitPermissionStates(Lcom/android/server/permission/access/MutateStateScope;II)V

    .line 133
    nop

    .line 39
    .end local v14    # "userId":I
    .end local v15    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$4$1":I
    nop

    .line 38
    add-int/lit8 v12, v12, 0x1

    move-object/from16 v2, v16

    goto :goto_7

    .end local v16    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .restart local v2    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    :cond_7
    move-object/from16 v16, v2

    .line 41
    .end local v2    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .end local v12    # "index$iv":I
    .restart local v16    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    nop

    .line 134
    .end local v10    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntSet;
    .end local v11    # "$i$f$forEachIndexed":I
    nop

    .line 39
    .end local v7    # "packageName":Ljava/lang/String;
    .end local v8    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onStorageVolumeMounted$4":I
    .end local v9    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_8
    nop

    .line 38
    add-int/lit8 v5, v5, 0x1

    move-object/from16 v2, v16

    goto :goto_6

    .end local v16    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    .restart local v2    # "changedPermissionNames":Lcom/android/server/permission/access/immutable/MutableIndexedSet;
    :cond_8
    nop

    .line 41
    .end local v5    # "index$iv":I
    nop

    .line 135
    .end local v3    # "$this$forEachIndexed$iv":Ljava/util/List;
    .end local v4    # "$i$f$forEachIndexed":I
    return-void
.end method

.method public onSystemReady(Lcom/android/server/permission/access/MutateStateScope;)V
    .locals 4
    .param p1, "$this$onSystemReady"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1643
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->privilegedPermissionAllowlistViolations:Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IndexedSet;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_0

    .line 1649
    return-void

    .line 1644
    :cond_0
    new-instance v0, Ljava/lang/IllegalStateException;

    .line 1646
    iget-object v1, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->privilegedPermissionAllowlistViolations:Lcom/android/server/permission/access/immutable/MutableIndexedSet;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Signature|privileged permissions not in privileged permission allowlist: "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    .line 1644
    invoke-direct {v0, v1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw v0
.end method

.method public onUserAdded(Lcom/android/server/permission/access/MutateStateScope;I)V
    .locals 7
    .param p1, "$this$onUserAdded"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "userId"    # I

    .line 81
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v0

    .local v0, "$this$forEach$iv":Ljava/util/Map;
    const/4 v1, 0x0

    .line 1887
    .local v1, "$i$f$forEach":I
    invoke-interface {v0}, Ljava/util/Map;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_1

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/util/Map$Entry;

    .local v3, "element$iv":Ljava/util/Map$Entry;
    const/4 v4, 0x0

    .line 81
    .local v4, "$i$a$-forEach-AppIdPermissionPolicy$onUserAdded$1":I
    invoke-interface {v3}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/pm/pkg/PackageState;

    .line 82
    .local v5, "packageState":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v5}, Lcom/android/server/pm/pkg/PackageState;->isApex()Z

    move-result v6

    if-eqz v6, :cond_0

    .line 83
    goto :goto_1

    .line 85
    :cond_0
    const/4 v6, 0x0

    invoke-direct {p0, p1, v5, p2, v6}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->evaluateAllPermissionStatesForPackageAndUser(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;ILcom/android/server/pm/pkg/PackageState;)V

    .line 86
    nop

    .line 1887
    .end local v4    # "$i$a$-forEach-AppIdPermissionPolicy$onUserAdded$1":I
    .end local v5    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    :goto_1
    nop

    .end local v3    # "element$iv":Ljava/util/Map$Entry;
    goto :goto_0

    .line 1888
    :cond_1
    nop

    .line 87
    .end local v0    # "$this$forEach$iv":Ljava/util/Map;
    .end local v1    # "$i$f$forEach":I
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    .local v0, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    const/4 v1, 0x0

    .line 44
    .local v1, "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .local v2, "index$iv":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->getSize()I

    move-result v3

    :goto_2
    if-ge v2, v3, :cond_2

    .line 45
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->keyAt(I)I

    move-result v4

    .local v4, "appId":I
    invoke-virtual {v0, v2}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->valueAt(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    const/4 v5, 0x0

    .line 88
    .local v5, "$i$a$-forEachIndexed-AppIdPermissionPolicy$onUserAdded$2":I
    invoke-direct {p0, p1, v4, p2}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->inheritImplicitPermissionStates(Lcom/android/server/permission/access/MutateStateScope;II)V

    .line 89
    nop

    .line 45
    .end local v4    # "appId":I
    .end local v5    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$onUserAdded$2":I
    nop

    .line 44
    add-int/lit8 v2, v2, 0x1

    goto :goto_2

    :cond_2
    nop

    .line 47
    .end local v2    # "index$iv":I
    nop

    .line 90
    .end local v0    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IntReferenceMap;
    .end local v1    # "$i$f$forEachIndexed":I
    return-void
.end method

.method public parseSystemState(Lcom/android/modules/utils/BinaryXmlPullParser;Lcom/android/server/permission/access/MutableAccessState;)V
    .locals 2
    .param p1, "$this$parseSystemState"    # Lcom/android/modules/utils/BinaryXmlPullParser;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "state"    # Lcom/android/server/permission/access/MutableAccessState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1652
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->persistence:Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;

    .line 2578
    .local v0, "$this$parseSystemState_u24lambda_u2475":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    const/4 v1, 0x0

    .line 1652
    .local v1, "$i$a$-with-AppIdPermissionPolicy$parseSystemState$1":I
    invoke-virtual {v0, p1, p2}, Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;->parseSystemState(Lcom/android/modules/utils/BinaryXmlPullParser;Lcom/android/server/permission/access/MutableAccessState;)V

    .line 1653
    .end local v0    # "$this$parseSystemState_u24lambda_u2475":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    .end local v1    # "$i$a$-with-AppIdPermissionPolicy$parseSystemState$1":I
    return-void
.end method

.method public parseUserState(Lcom/android/modules/utils/BinaryXmlPullParser;Lcom/android/server/permission/access/MutableAccessState;I)V
    .locals 2
    .param p1, "$this$parseUserState"    # Lcom/android/modules/utils/BinaryXmlPullParser;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "state"    # Lcom/android/server/permission/access/MutableAccessState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "userId"    # I

    .line 1660
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->persistence:Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;

    .line 2578
    .local v0, "$this$parseUserState_u24lambda_u2477":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    const/4 v1, 0x0

    .line 1660
    .local v1, "$i$a$-with-AppIdPermissionPolicy$parseUserState$1":I
    invoke-virtual {v0, p1, p2, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;->parseUserState(Lcom/android/modules/utils/BinaryXmlPullParser;Lcom/android/server/permission/access/MutableAccessState;I)V

    .line 1661
    .end local v0    # "$this$parseUserState_u24lambda_u2477":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    .end local v1    # "$i$a$-with-AppIdPermissionPolicy$parseUserState$1":I
    return-void
.end method

.method public final removePermission(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/permission/access/permission/Permission;)V
    .locals 4
    .param p1, "$this$removePermission"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "permission"    # Lcom/android/server/permission/access/permission/Permission;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1707
    invoke-virtual {p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    const/4 v1, 0x1

    const/4 v2, 0x0

    const/4 v3, 0x0

    invoke-static {v0, v3, v1, v2}, Lcom/android/server/permission/access/MutableAccessState;->mutateSystemState$default(Lcom/android/server/permission/access/MutableAccessState;IILjava/lang/Object;)Lcom/android/server/permission/access/MutableSystemState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/MutableSystemState;->mutatePermissions()Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    move-result-object v0

    move-object v1, p2

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 33
    .local v2, "$i$f$getName":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v3

    iget-object v1, v3, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 1707
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$getName":I
    nop

    .local v0, "$this$minusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .local v1, "key$iv":Ljava/lang/Object;
    const/4 v2, 0x0

    .line 101
    .local v2, "$i$f$minusAssign":I
    invoke-virtual {v0, v1}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    .line 102
    nop

    .line 1708
    .end local v0    # "$this$minusAssign$iv":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    .end local v1    # "key$iv":Ljava/lang/Object;
    .end local v2    # "$i$f$minusAssign":I
    return-void
.end method

.method public final resetRuntimePermissions(Lcom/android/server/permission/access/MutateStateScope;Ljava/lang/String;I)V
    .locals 29
    .param p1, "$this$resetRuntimePermissions"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "packageName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "userId"    # I

    .line 280
    move-object/from16 v0, p2

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v1

    invoke-interface {v1, v0}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/pm/pkg/PackageState;

    if-nez v1, :cond_0

    return-void

    .line 281
    .local v1, "packageState":Lcom/android/server/pm/pkg/PackageState;
    :cond_0
    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v2

    if-nez v2, :cond_1

    return-void

    .line 282
    .local v2, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :cond_1
    invoke-interface {v1}, Lcom/android/server/pm/pkg/PackageState;->getAppId()I

    move-result v9

    .line 283
    .local v9, "appId":I
    invoke-interface {v2}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v3

    move-object v10, v3

    .local v10, "$this$forEach$iv":Ljava/lang/Iterable;
    const/4 v11, 0x0

    .line 2004
    .local v11, "$i$f$forEach":I
    invoke-interface {v10}, Ljava/lang/Iterable;->iterator()Ljava/util/Iterator;

    move-result-object v12

    :goto_0
    invoke-interface {v12}, Ljava/util/Iterator;->hasNext()Z

    move-result v3

    if-eqz v3, :cond_10

    invoke-interface {v12}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v13

    .local v13, "element$iv":Ljava/lang/Object;
    move-object v14, v13

    check-cast v14, Ljava/lang/String;

    .local v14, "permissionName":Ljava/lang/String;
    const/4 v15, 0x0

    .line 284
    .local v15, "$i$a$-forEach-AppIdPermissionPolicy$resetRuntimePermissions$1":I
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getSystemState()Lcom/android/server/permission/access/SystemState;

    move-result-object v3

    invoke-virtual {v3}, Lcom/android/server/permission/access/SystemState;->getPermissions()Lcom/android/server/permission/access/immutable/IndexedMap;

    move-result-object v3

    invoke-virtual {v3, v14}, Lcom/android/server/permission/access/immutable/IndexedMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/permission/access/permission/Permission;

    if-nez v3, :cond_2

    move-object/from16 v20, v1

    move-object/from16 v26, v2

    move-object/from16 v2, p0

    goto/16 :goto_a

    :cond_2
    move-object/from16 v16, v3

    .line 285
    .local v16, "permission":Lcom/android/server/permission/access/permission/Permission;
    nop

    .local v3, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 57
    .local v4, "$i$f$isRuntime":I
    move-object v5, v3

    .local v5, "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v6, 0x0

    .line 48
    .local v6, "$i$f$getProtection":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v7

    invoke-virtual {v7}, Landroid/content/pm/PermissionInfo;->getProtection()I

    move-result v5

    .line 57
    .end local v5    # "this_$iv$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v6    # "$i$f$getProtection":I
    const/4 v7, 0x1

    if-ne v5, v7, :cond_3

    move v3, v7

    goto :goto_1

    :cond_3
    const/4 v3, 0x0

    .line 285
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$isRuntime":I
    :goto_1
    if-eqz v3, :cond_f

    move-object/from16 v3, v16

    .restart local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v4, 0x0

    .line 135
    .local v4, "$i$f$isRemoved":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v5

    iget v5, v5, Landroid/content/pm/PermissionInfo;->flags:I

    const/4 v8, 0x2

    invoke-static {v5, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v3

    .line 285
    .end local v3    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v4    # "$i$f$isRemoved":I
    if-eqz v3, :cond_4

    move-object/from16 v20, v1

    move-object/from16 v26, v2

    move-object/from16 v2, p0

    goto/16 :goto_9

    .line 289
    :cond_4
    nop

    .line 1440
    nop

    .line 1442
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v3

    .line 1440
    .local v3, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v4, 0x0

    .line 1445
    .local v4, "$i$f$anyPackageInAppId":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v5

    invoke-virtual {v5, v9}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    invoke-static {v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .local v5, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v8, v5

    .local v8, "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v17, 0x0

    .line 29
    .local v17, "$i$f$anyIndexed":I
    move-object/from16 v18, v8

    .local v18, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v19, 0x0

    .line 38
    .local v19, "$i$f$forEachIndexed":I
    const/16 v20, 0x0

    .local v20, "index$iv$iv$iv":I
    invoke-virtual/range {v18 .. v18}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v6

    move/from16 v7, v20

    .end local v20    # "index$iv$iv$iv":I
    .local v7, "index$iv$iv$iv":I
    :goto_2
    if-ge v7, v6, :cond_9

    .line 39
    move-object/from16 v20, v1

    move-object/from16 v1, v18

    .end local v18    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v1, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v20, "packageState":Lcom/android/server/pm/pkg/PackageState;
    invoke-virtual {v1, v7}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v18

    .local v18, "element$iv$iv":Ljava/lang/Object;
    move/from16 v21, v7

    .local v21, "index$iv$iv":I
    const/16 v22, 0x0

    .line 30
    .local v22, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move-object/from16 v23, v1

    .end local v1    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v23, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object/from16 v1, v18

    check-cast v1, Ljava/lang/String;

    .local v1, "packageName$iv":Ljava/lang/String;
    const/16 v24, 0x0

    .line 1447
    .local v24, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v25

    move-object/from16 v26, v2

    .end local v2    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v26, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    invoke-virtual/range {v25 .. v25}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v2

    invoke-interface {v2, v1}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    invoke-static {v2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v2, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v2, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v25

    if-eqz v25, :cond_6

    move-object/from16 v25, v2

    .local v25, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v27, 0x0

    .line 290
    .local v27, "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$resetRuntimePermissions$1$isRequestedByOtherPackages$1":I
    move-object/from16 v28, v1

    .end local v1    # "packageName$iv":Ljava/lang/String;
    .local v28, "packageName$iv":Ljava/lang/String;
    invoke-interface/range {v25 .. v25}, Lcom/android/server/pm/pkg/PackageState;->getPackageName()Ljava/lang/String;

    move-result-object v1

    invoke-static {v1, v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->areEqual(Ljava/lang/Object;Ljava/lang/Object;)Z

    move-result v1

    if-nez v1, :cond_5

    .line 291
    invoke-interface/range {v25 .. v25}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v1}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1, v14}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_5

    const/4 v1, 0x1

    goto :goto_3

    :cond_5
    const/4 v1, 0x0

    .line 290
    :goto_3
    nop

    .line 1448
    .end local v25    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v27    # "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$resetRuntimePermissions$1$isRequestedByOtherPackages$1":I
    if-eqz v1, :cond_7

    const/4 v1, 0x1

    goto :goto_4

    .end local v28    # "packageName$iv":Ljava/lang/String;
    .restart local v1    # "packageName$iv":Ljava/lang/String;
    :cond_6
    move-object/from16 v28, v1

    .end local v1    # "packageName$iv":Ljava/lang/String;
    .restart local v28    # "packageName$iv":Ljava/lang/String;
    :cond_7
    const/4 v1, 0x0

    .line 30
    .end local v2    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v24    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    .end local v28    # "packageName$iv":Ljava/lang/String;
    :goto_4
    if-eqz v1, :cond_8

    .line 31
    const/4 v6, 0x1

    goto :goto_5

    .line 33
    :cond_8
    nop

    .line 39
    .end local v18    # "element$iv$iv":Ljava/lang/Object;
    .end local v21    # "index$iv$iv":I
    .end local v22    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v7, v7, 0x1

    move-object/from16 v1, v20

    move-object/from16 v18, v23

    move-object/from16 v2, v26

    goto :goto_2

    .end local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v23    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v26    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v1, "packageState":Lcom/android/server/pm/pkg/PackageState;
    .local v2, "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v18, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :cond_9
    move-object/from16 v20, v1

    move-object/from16 v26, v2

    move-object/from16 v23, v18

    .line 41
    .end local v1    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v2    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .end local v7    # "index$iv$iv$iv":I
    .end local v18    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v23    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v26    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    nop

    .line 34
    .end local v19    # "$i$f$forEachIndexed":I
    .end local v23    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v6, 0x0

    .line 1446
    .end local v8    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v17    # "$i$f$anyIndexed":I
    :goto_5
    nop

    .line 289
    .end local v3    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v4    # "$i$f$anyPackageInAppId":I
    .end local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    nop

    .line 288
    move v1, v6

    .line 293
    .local v1, "isRequestedByOtherPackages":Z
    if-eqz v1, :cond_a

    .line 294
    move-object/from16 v2, p0

    goto/16 :goto_a

    .line 296
    :cond_a
    move-object/from16 v2, p0

    move-object/from16 v8, p1

    move/from16 v7, p3

    invoke-virtual {v2, v8, v9, v7, v14}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I

    move-result v6

    .line 297
    .local v6, "oldFlags":I
    const/16 v3, 0x180

    invoke-static {v6, v3}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasAnyBit(II)Z

    move-result v3

    if-eqz v3, :cond_b

    .line 298
    goto :goto_a

    .line 300
    :cond_b
    move v3, v6

    .line 302
    .local v3, "newFlags":I
    nop

    .line 303
    const/16 v4, 0x8

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v4

    if-nez v4, :cond_d

    .line 304
    const/16 v4, 0x200

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v4

    if-eqz v4, :cond_c

    goto :goto_6

    .line 308
    :cond_c
    const/16 v4, 0x10

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v4

    goto :goto_7

    .line 306
    :cond_d
    :goto_6
    or-int/lit8 v4, v3, 0x10

    .line 301
    :goto_7
    move v3, v4

    .line 310
    const v4, 0xf00060

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v3

    .line 311
    const/16 v4, 0x400

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v4

    if-eqz v4, :cond_e

    .line 312
    or-int/lit16 v3, v3, 0x1000

    move/from16 v17, v3

    goto :goto_8

    .line 311
    :cond_e
    move/from16 v17, v3

    .line 314
    .end local v3    # "newFlags":I
    .local v17, "newFlags":I
    :goto_8
    move-object/from16 v3, p0

    move-object/from16 v4, p1

    move v5, v9

    move/from16 v18, v6

    .end local v6    # "oldFlags":I
    .local v18, "oldFlags":I
    move/from16 v6, p3

    move-object v7, v14

    move/from16 v8, v17

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 315
    goto :goto_a

    .line 285
    .end local v17    # "newFlags":I
    .end local v18    # "oldFlags":I
    .end local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v26    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .local v1, "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v2    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :cond_f
    move-object/from16 v20, v1

    move-object/from16 v26, v2

    move-object/from16 v2, p0

    .line 286
    .end local v1    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v2    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v26    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :goto_9
    nop

    .line 2004
    .end local v14    # "permissionName":Ljava/lang/String;
    .end local v15    # "$i$a$-forEach-AppIdPermissionPolicy$resetRuntimePermissions$1":I
    .end local v16    # "permission":Lcom/android/server/permission/access/permission/Permission;
    :goto_a
    move-object/from16 v1, v20

    move-object/from16 v2, v26

    .end local v13    # "element$iv":Ljava/lang/Object;
    goto/16 :goto_0

    .line 2030
    .end local v20    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v26    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    .restart local v1    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .restart local v2    # "androidPackage":Lcom/android/server/pm/pkg/AndroidPackage;
    :cond_10
    nop

    .line 316
    .end local v10    # "$this$forEach$iv":Ljava/lang/Iterable;
    .end local v11    # "$i$f$forEach":I
    return-void
.end method

.method public serializeSystemState(Lcom/android/modules/utils/BinaryXmlSerializer;Lcom/android/server/permission/access/AccessState;)V
    .locals 2
    .param p1, "$this$serializeSystemState"    # Lcom/android/modules/utils/BinaryXmlSerializer;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "state"    # Lcom/android/server/permission/access/AccessState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param

    .line 1656
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->persistence:Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;

    .line 2578
    .local v0, "$this$serializeSystemState_u24lambda_u2476":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    const/4 v1, 0x0

    .line 1656
    .local v1, "$i$a$-with-AppIdPermissionPolicy$serializeSystemState$1":I
    invoke-virtual {v0, p1, p2}, Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;->serializeSystemState(Lcom/android/modules/utils/BinaryXmlSerializer;Lcom/android/server/permission/access/AccessState;)V

    .line 1657
    .end local v0    # "$this$serializeSystemState_u24lambda_u2476":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    .end local v1    # "$i$a$-with-AppIdPermissionPolicy$serializeSystemState$1":I
    return-void
.end method

.method public serializeUserState(Lcom/android/modules/utils/BinaryXmlSerializer;Lcom/android/server/permission/access/AccessState;I)V
    .locals 2
    .param p1, "$this$serializeUserState"    # Lcom/android/modules/utils/BinaryXmlSerializer;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "state"    # Lcom/android/server/permission/access/AccessState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "userId"    # I

    .line 1664
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->persistence:Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;

    .line 2578
    .local v0, "$this$serializeUserState_u24lambda_u2478":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    const/4 v1, 0x0

    .line 1664
    .local v1, "$i$a$-with-AppIdPermissionPolicy$serializeUserState$1":I
    invoke-virtual {v0, p1, p2, p3}, Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;->serializeUserState(Lcom/android/modules/utils/BinaryXmlSerializer;Lcom/android/server/permission/access/AccessState;I)V

    .line 1665
    .end local v0    # "$this$serializeUserState_u24lambda_u2478":Lcom/android/server/permission/access/permission/AppIdPermissionPersistence;
    .end local v1    # "$i$a$-with-AppIdPermissionPolicy$serializeUserState$1":I
    return-void
.end method

.method public final setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z
    .locals 7
    .param p1, "$this$setPermissionFlags"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permissionName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p5, "flags"    # I

    .line 1739
    const/4 v5, -0x1

    move-object v0, p0

    move-object v1, p1

    move v2, p2

    move v3, p3

    move-object v4, p4

    move v6, p5

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->updatePermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;II)Z

    move-result v0

    return v0
.end method

.method public final setSignaturePermissionAllowlistForceEnforced(Z)V
    .locals 0
    .param p1, "<set-?>"    # Z

    .line 68
    iput-boolean p1, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->isSignaturePermissionAllowlistForceEnforced:Z

    return-void
.end method

.method public final updatePermissionExemptFlags(Lcom/android/server/permission/access/MutateStateScope;IILcom/android/server/permission/access/permission/Permission;II)V
    .locals 33
    .param p1, "$this$updatePermissionExemptFlags"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permission"    # Lcom/android/server/permission/access/permission/Permission;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p5, "exemptFlagMask"    # I
    .param p6, "exemptFlagValues"    # I

    .line 214
    move-object/from16 v6, p0

    move/from16 v7, p2

    move/from16 v8, p5

    move-object/from16 v0, p4

    .local v0, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v1, 0x0

    .line 33
    .local v1, "$i$f$getName":I
    invoke-virtual {v0}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v2

    iget-object v0, v2, Landroid/content/pm/PermissionInfo;->name:Ljava/lang/String;

    .line 214
    .end local v0    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v1    # "$i$f$getName":I
    move-object v9, v0

    .line 215
    .local v9, "permissionName":Ljava/lang/String;
    move-object/from16 v10, p1

    move/from16 v11, p3

    invoke-virtual {v6, v10, v7, v11, v9}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->getPermissionFlags(Lcom/android/server/permission/access/GetStateScope;IILjava/lang/String;)I

    move-result v12

    .line 216
    .local v12, "oldFlags":I
    invoke-static {v12, v8}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    and-int v1, p6, v8

    or-int/2addr v0, v1

    .line 217
    .local v0, "newFlags":I
    if-ne v12, v0, :cond_0

    .line 218
    return-void

    .line 220
    :cond_0
    const v1, 0x38000

    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasAnyBit(II)Z

    move-result v13

    .line 221
    .local v13, "isExempt":Z
    move-object/from16 v1, p4

    .local v1, "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 132
    .local v2, "$i$f$isHardRestricted":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v3

    iget v3, v3, Landroid/content/pm/PermissionInfo;->flags:I

    const/4 v4, 0x4

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 221
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isHardRestricted":I
    const/high16 v2, 0x40000

    if-eqz v1, :cond_1

    if-nez v13, :cond_1

    .line 222
    or-int/2addr v0, v2

    .line 226
    sget-object v1, Lcom/android/server/permission/access/permission/PermissionFlags;->INSTANCE:Lcom/android/server/permission/access/permission/PermissionFlags;

    invoke-virtual {v1, v12}, Lcom/android/server/permission/access/permission/PermissionFlags;->isPermissionGranted(I)Z

    move-result v1

    if-eqz v1, :cond_2

    .line 227
    const/16 v1, 0x80

    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    goto :goto_0

    .line 230
    :cond_1
    invoke-static {v0, v2}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    .line 233
    :cond_2
    :goto_0
    move-object/from16 v1, p4

    .restart local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    const/4 v2, 0x0

    .line 138
    .local v2, "$i$f$isSoftRestricted":I
    invoke-virtual {v1}, Lcom/android/server/permission/access/permission/Permission;->getPermissionInfo()Landroid/content/pm/PermissionInfo;

    move-result-object v3

    iget v3, v3, Landroid/content/pm/PermissionInfo;->flags:I

    const/16 v4, 0x8

    invoke-static {v3, v4}, Lcom/android/server/permission/access/util/IntExtensionsKt;->hasBits(II)Z

    move-result v1

    .line 233
    .end local v1    # "this_$iv":Lcom/android/server/permission/access/permission/Permission;
    .end local v2    # "$i$f$isSoftRestricted":I
    if-eqz v1, :cond_d

    if-nez v13, :cond_d

    .line 235
    const/16 v1, 0x2710

    .line 1467
    .local v1, "initialValue$iv":I
    nop

    .line 1470
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v3

    .line 1467
    .local v3, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v4, 0x0

    .line 1473
    .local v4, "$i$f$reducePackageInAppId":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v5

    invoke-virtual {v5}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v5

    invoke-virtual {v5, v7}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v5

    invoke-static {v5}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v5, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1474
    .local v5, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v14, v5

    .local v14, "$this$reduceIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v15, 0x0

    .line 72
    .local v15, "$i$f$reduceIndexed":I
    new-instance v16, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;

    invoke-direct/range {v16 .. v16}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;-><init>()V

    move-object/from16 v17, v16

    move-object/from16 v2, v17

    .local v2, "value$iv$iv":Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;
    iput v1, v2, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 73
    move-object/from16 v17, v14

    .local v17, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v18, 0x0

    .line 38
    .local v18, "$i$f$forEachIndexed":I
    const/16 v19, 0x0

    move/from16 v20, v1

    .end local v1    # "initialValue$iv":I
    .local v19, "index$iv$iv$iv":I
    .local v20, "initialValue$iv":I
    invoke-virtual/range {v17 .. v17}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v1

    move/from16 v21, v4

    move/from16 v4, v19

    .end local v19    # "index$iv$iv$iv":I
    .local v4, "index$iv$iv$iv":I
    .local v21, "$i$f$reducePackageInAppId":I
    :goto_1
    if-ge v4, v1, :cond_5

    .line 39
    move/from16 v19, v1

    move-object/from16 v1, v17

    .end local v17    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v1, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    invoke-virtual {v1, v4}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v17

    .local v17, "element$iv$iv":Ljava/lang/Object;
    move/from16 v22, v4

    .local v22, "index$iv$iv":I
    const/16 v23, 0x0

    .line 73
    .local v23, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$reduceIndexed$1$iv$iv":I
    move-object/from16 v24, v1

    .end local v1    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v24, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    iget v1, v2, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    move-object/from16 v25, v5

    .end local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v1, "value$iv":I
    .local v25, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object/from16 v5, v17

    check-cast v5, Ljava/lang/String;

    .local v5, "packageName$iv":Ljava/lang/String;
    const/16 v26, 0x0

    .line 1475
    .local v26, "$i$a$-reduceIndexed-AppIdPermissionPolicy$reducePackageInAppId$1$iv":I
    invoke-virtual {v3}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v27

    move-object/from16 v28, v3

    .end local v3    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v28, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v27 .. v27}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v3

    invoke-interface {v3, v5}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v3, Lcom/android/server/pm/pkg/PackageState;

    .line 1476
    .local v3, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v3}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v27

    if-eqz v27, :cond_4

    .line 1477
    move/from16 v27, v1

    .local v27, "targetSdkVersion":I
    move-object/from16 v29, v3

    .local v29, "packageState":Lcom/android/server/pm/pkg/PackageState;
    const/16 v30, 0x0

    .line 238
    .local v30, "$i$a$-reducePackageInAppId$default-AppIdPermissionPolicy$updatePermissionExemptFlags$isSoftRestricted$targetSdkVersion$1":I
    invoke-interface/range {v29 .. v29}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v31

    invoke-static/range {v31 .. v31}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move/from16 v32, v1

    .end local v1    # "value$iv":I
    .local v32, "value$iv":I
    invoke-interface/range {v31 .. v31}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1, v9}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v1

    if-eqz v1, :cond_3

    .line 239
    nop

    .line 240
    invoke-interface/range {v29 .. v29}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-interface {v1}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I

    move-result v1

    .line 239
    move-object/from16 v31, v3

    move/from16 v3, v27

    .end local v27    # "targetSdkVersion":I
    .local v3, "targetSdkVersion":I
    .local v31, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-static {v3, v1}, Lcom/android/server/permission/jarjar/kotlin/ranges/RangesKt;->coerceAtMost(II)I

    move-result v27

    goto :goto_2

    .line 243
    .end local v31    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .local v3, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v27    # "targetSdkVersion":I
    :cond_3
    move-object/from16 v31, v3

    move/from16 v3, v27

    .line 238
    .end local v27    # "targetSdkVersion":I
    .local v3, "targetSdkVersion":I
    .restart local v31    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :goto_2
    nop

    .line 1477
    .end local v3    # "targetSdkVersion":I
    .end local v29    # "packageState":Lcom/android/server/pm/pkg/PackageState;
    .end local v30    # "$i$a$-reducePackageInAppId$default-AppIdPermissionPolicy$updatePermissionExemptFlags$isSoftRestricted$targetSdkVersion$1":I
    goto :goto_3

    .line 1479
    .end local v31    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v32    # "value$iv":I
    .restart local v1    # "value$iv":I
    .local v3, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_4
    move/from16 v32, v1

    move-object/from16 v31, v3

    .end local v1    # "value$iv":I
    .end local v3    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v31    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v32    # "value$iv":I
    move/from16 v27, v32

    .line 1476
    :goto_3
    nop

    .end local v5    # "packageName$iv":Ljava/lang/String;
    .end local v26    # "$i$a$-reduceIndexed-AppIdPermissionPolicy$reducePackageInAppId$1$iv":I
    .end local v31    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .end local v32    # "value$iv":I
    invoke-static/range {v27 .. v27}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v1

    .line 73
    invoke-virtual {v1}, Ljava/lang/Number;->intValue()I

    move-result v1

    iput v1, v2, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 39
    .end local v17    # "element$iv$iv":Ljava/lang/Object;
    .end local v22    # "index$iv$iv":I
    .end local v23    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$reduceIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v4, v4, 0x1

    move/from16 v1, v19

    move-object/from16 v17, v24

    move-object/from16 v5, v25

    move-object/from16 v3, v28

    goto/16 :goto_1

    .end local v24    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v25    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v28    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v3, "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v5, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v17, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :cond_5
    move-object/from16 v28, v3

    move-object/from16 v25, v5

    move-object/from16 v24, v17

    .line 41
    .end local v3    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v4    # "index$iv$iv$iv":I
    .end local v5    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v17    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v24    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v25    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v28    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 74
    .end local v18    # "$i$f$forEachIndexed":I
    .end local v24    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    iget v1, v2, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;->element:I

    .line 1474
    .end local v2    # "value$iv$iv":Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Ref$IntRef;
    .end local v14    # "$this$reduceIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v15    # "$i$f$reduceIndexed":I
    nop

    .line 235
    .end local v20    # "initialValue$iv":I
    .end local v21    # "$i$f$reducePackageInAppId":I
    .end local v25    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v28    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 234
    nop

    .line 246
    .local v1, "targetSdkVersion":I
    nop

    .line 1440
    nop

    .line 1442
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v2

    .line 1440
    .local v2, "state$iv":Lcom/android/server/permission/access/AccessState;
    const/4 v3, 0x0

    .line 1445
    .local v3, "$i$f$anyPackageInAppId":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v4

    invoke-virtual {v4}, Lcom/android/server/permission/access/ExternalState;->getAppIdPackageNames()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v4

    invoke-virtual {v4, v7}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v4

    invoke-static {v4}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v4, Lcom/android/server/permission/access/immutable/IndexedListSet;

    .line 1446
    .local v4, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move-object v5, v4

    .local v5, "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/4 v14, 0x0

    .line 29
    .local v14, "$i$f$anyIndexed":I
    move-object v15, v5

    .local v15, "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v17, 0x0

    .line 38
    .local v17, "$i$f$forEachIndexed":I
    const/16 v18, 0x0

    move/from16 v19, v3

    .end local v3    # "$i$f$anyPackageInAppId":I
    .local v18, "index$iv$iv$iv":I
    .local v19, "$i$f$anyPackageInAppId":I
    invoke-virtual {v15}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v3

    move-object/from16 v20, v4

    move/from16 v4, v18

    .end local v18    # "index$iv$iv$iv":I
    .local v4, "index$iv$iv$iv":I
    .local v20, "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :goto_4
    const/16 v18, 0x1

    if-ge v4, v3, :cond_b

    .line 39
    invoke-virtual {v15, v4}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v21

    .local v21, "element$iv$iv":Ljava/lang/Object;
    move/from16 v22, v4

    .restart local v22    # "index$iv$iv":I
    const/16 v23, 0x0

    .line 30
    .local v23, "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    move/from16 v24, v3

    move-object/from16 v3, v21

    check-cast v3, Ljava/lang/String;

    .local v3, "packageName$iv":Ljava/lang/String;
    const/16 v25, 0x0

    .line 1447
    .local v25, "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    invoke-virtual {v2}, Lcom/android/server/permission/access/AccessState;->getExternalState()Lcom/android/server/permission/access/ExternalState;

    move-result-object v26

    move-object/from16 v27, v2

    .end local v2    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v27, "state$iv":Lcom/android/server/permission/access/AccessState;
    invoke-virtual/range {v26 .. v26}, Lcom/android/server/permission/access/ExternalState;->getPackageStates()Ljava/util/Map;

    move-result-object v2

    invoke-interface {v2, v3}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v2

    invoke-static {v2}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v2, Lcom/android/server/pm/pkg/PackageState;

    .line 1448
    .local v2, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface {v2}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v26

    if-eqz v26, :cond_8

    move-object/from16 v26, v2

    .local v26, "it":Lcom/android/server/pm/pkg/PackageState;
    const/16 v28, 0x0

    .line 247
    .local v28, "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$updatePermissionExemptFlags$isSoftRestricted$1":I
    invoke-interface/range {v26 .. v26}, Lcom/android/server/pm/pkg/PackageState;->getAndroidPackage()Lcom/android/server/pm/pkg/AndroidPackage;

    move-result-object v29

    invoke-static/range {v29 .. v29}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    move-object/from16 v30, v2

    .end local v2    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .local v30, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    invoke-interface/range {v29 .. v29}, Lcom/android/server/pm/pkg/AndroidPackage;->getRequestedPermissions()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2, v9}, Ljava/util/Set;->contains(Ljava/lang/Object;)Z

    move-result v2

    if-eqz v2, :cond_6

    .line 248
    nop

    .line 249
    nop

    .line 250
    nop

    .line 251
    nop

    .line 248
    move-object/from16 v2, v26

    .end local v26    # "it":Lcom/android/server/pm/pkg/PackageState;
    .local v2, "it":Lcom/android/server/pm/pkg/PackageState;
    invoke-direct {v6, v2, v1, v9}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->isSoftRestrictedPermissionExemptForPackage(Lcom/android/server/pm/pkg/PackageState;ILjava/lang/String;)Z

    move-result v26

    if-eqz v26, :cond_7

    move/from16 v26, v18

    goto :goto_5

    .line 247
    .end local v2    # "it":Lcom/android/server/pm/pkg/PackageState;
    .restart local v26    # "it":Lcom/android/server/pm/pkg/PackageState;
    :cond_6
    move-object/from16 v2, v26

    .line 248
    .end local v26    # "it":Lcom/android/server/pm/pkg/PackageState;
    .restart local v2    # "it":Lcom/android/server/pm/pkg/PackageState;
    :cond_7
    const/16 v26, 0x0

    .line 247
    :goto_5
    nop

    .line 1448
    .end local v2    # "it":Lcom/android/server/pm/pkg/PackageState;
    .end local v28    # "$i$a$-anyPackageInAppId$default-AppIdPermissionPolicy$updatePermissionExemptFlags$isSoftRestricted$1":I
    if-eqz v26, :cond_9

    move/from16 v2, v18

    goto :goto_6

    .end local v30    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .local v2, "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_8
    move-object/from16 v30, v2

    .end local v2    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    .restart local v30    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :cond_9
    const/4 v2, 0x0

    .line 30
    .end local v3    # "packageName$iv":Ljava/lang/String;
    .end local v25    # "$i$a$-anyIndexed-AppIdPermissionPolicy$anyPackageInAppId$1$iv":I
    .end local v30    # "packageState$iv":Lcom/android/server/pm/pkg/PackageState;
    :goto_6
    if-eqz v2, :cond_a

    .line 31
    move/from16 v2, v18

    goto :goto_7

    .line 33
    :cond_a
    nop

    .line 39
    .end local v21    # "element$iv$iv":Ljava/lang/Object;
    .end local v22    # "index$iv$iv":I
    .end local v23    # "$i$a$-forEachIndexed-IndexedListSetExtensionsKt$anyIndexed$1$iv$iv":I
    nop

    .line 38
    add-int/lit8 v4, v4, 0x1

    move/from16 v3, v24

    move-object/from16 v2, v27

    goto :goto_4

    .end local v27    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .local v2, "state$iv":Lcom/android/server/permission/access/AccessState;
    :cond_b
    move-object/from16 v27, v2

    .line 41
    .end local v2    # "state$iv":Lcom/android/server/permission/access/AccessState;
    .end local v4    # "index$iv$iv$iv":I
    .restart local v27    # "state$iv":Lcom/android/server/permission/access/AccessState;
    nop

    .line 34
    .end local v15    # "$this$forEachIndexed$iv$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v17    # "$i$f$forEachIndexed":I
    const/4 v2, 0x0

    .line 1446
    .end local v5    # "$this$anyIndexed$iv$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v14    # "$i$f$anyIndexed":I
    :goto_7
    nop

    .end local v19    # "$i$f$anyPackageInAppId":I
    .end local v20    # "packageNames$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v27    # "state$iv":Lcom/android/server/permission/access/AccessState;
    if-nez v2, :cond_c

    move/from16 v2, v18

    goto :goto_8

    :cond_c
    const/4 v2, 0x0

    .end local v1    # "targetSdkVersion":I
    goto :goto_8

    .line 255
    :cond_d
    const/4 v2, 0x0

    .line 233
    :goto_8
    nop

    .line 232
    move v14, v2

    .line 258
    .local v14, "isSoftRestricted":Z
    const/high16 v1, 0x80000

    if-eqz v14, :cond_e

    .line 259
    or-int/2addr v1, v0

    goto :goto_9

    .line 261
    :cond_e
    invoke-static {v0, v1}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v1

    .line 257
    :goto_9
    move v15, v1

    .line 263
    .end local v0    # "newFlags":I
    .local v15, "newFlags":I
    if-ne v12, v15, :cond_f

    .line 264
    return-void

    .line 266
    :cond_f
    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move/from16 v2, p2

    move/from16 v3, p3

    move-object v4, v9

    move v5, v15

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->setPermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;I)Z

    .line 267
    return-void
.end method

.method public final updatePermissionFlags(Lcom/android/server/permission/access/MutateStateScope;IILjava/lang/String;II)Z
    .locals 22
    .param p1, "$this$updatePermissionFlags"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "appId"    # I
    .param p3, "userId"    # I
    .param p4, "permissionName"    # Ljava/lang/String;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p5, "flagMask"    # I
    .param p6, "flagValues"    # I

    .line 1748
    move/from16 v6, p2

    move/from16 v7, p3

    move-object/from16 v8, p4

    move/from16 v9, p5

    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, v7}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->contains(I)Z

    move-result v0

    const/4 v1, 0x0

    .line 1758
    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    .line 1748
    if-nez v0, :cond_0

    .line 1752
    sget-object v0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->LOG_TAG:Ljava/lang/String;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Unable to update permission flags for missing user "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-static {v0, v2}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    .line 1753
    return v1

    .line 1756
    :cond_0
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    invoke-virtual {v0}, Lcom/android/server/permission/access/AccessState;->getUserStates()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    invoke-virtual {v0, v7}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    check-cast v0, Lcom/android/server/permission/access/UserState;

    .line 1757
    invoke-virtual {v0}, Lcom/android/server/permission/access/UserState;->getAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/IntReferenceMap;

    move-result-object v0

    .line 1756
    invoke-virtual {v0, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMap;->get(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v0

    check-cast v0, Lcom/android/server/permission/access/immutable/IndexedMap;

    .line 1758
    invoke-static {v0, v8, v2}, Lcom/android/server/permission/access/immutable/IndexedMapExtensionsKt;->getWithDefault(Lcom/android/server/permission/access/immutable/IndexedMap;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Ljava/lang/Number;

    invoke-virtual {v0}, Ljava/lang/Number;->intValue()I

    move-result v0

    .line 1755
    move v10, v0

    .line 1759
    .local v10, "oldFlags":I
    invoke-static {v10, v9}, Lcom/android/server/permission/access/util/IntExtensionsKt;->andInv(II)I

    move-result v0

    and-int v3, p6, v9

    or-int v11, v0, v3

    .line 1760
    .local v11, "newFlags":I
    if-ne v10, v11, :cond_1

    .line 1761
    return v1

    .line 1763
    :cond_1
    invoke-virtual/range {p1 .. p1}, Lcom/android/server/permission/access/MutateStateScope;->getNewState()Lcom/android/server/permission/access/MutableAccessState;

    move-result-object v0

    const/4 v3, 0x2

    const/4 v4, 0x0

    invoke-static {v0, v7, v1, v3, v4}, Lcom/android/server/permission/access/MutableAccessState;->mutateUserState$default(Lcom/android/server/permission/access/MutableAccessState;IIILjava/lang/Object;)Lcom/android/server/permission/access/MutableUserState;

    move-result-object v0

    invoke-static {v0}, Lcom/android/server/permission/jarjar/kotlin/jvm/internal/Intrinsics;->checkNotNull(Ljava/lang/Object;)V

    invoke-virtual {v0}, Lcom/android/server/permission/access/MutableUserState;->mutateAppIdPermissionFlags()Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;

    move-result-object v12

    .line 1764
    .local v12, "appIdPermissionFlags":Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;
    move-object v0, v12

    .local v0, "$this$mutateOrPut$iv":Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;
    const/4 v1, 0x0

    .line 75
    .local v1, "$i$f$mutateOrPut":I
    invoke-virtual {v0, v6}, Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;->mutate(I)Lcom/android/server/permission/access/immutable/Immutable;

    move-result-object v3

    const/4 v13, 0x1

    if-eqz v3, :cond_2

    .local v3, "it$iv":Lcom/android/server/permission/access/immutable/Immutable;
    const/4 v4, 0x0

    .line 76
    .local v4, "$i$a$-let-IntReferenceMapExtensionsKt$mutateOrPut$1$iv":I
    goto :goto_0

    .line 78
    .end local v3    # "it$iv":Lcom/android/server/permission/access/immutable/Immutable;
    .end local v4    # "$i$a$-let-IntReferenceMapExtensionsKt$mutateOrPut$1$iv":I
    :cond_2
    const/4 v3, 0x0

    .line 1764
    .local v3, "$i$a$-mutateOrPut-AppIdPermissionPolicy$updatePermissionFlags$permissionFlags$1":I
    new-instance v5, Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    invoke-direct {v5, v4, v13, v4}, Lcom/android/server/permission/access/immutable/MutableIndexedMap;-><init>(Landroid/util/ArrayMap;ILcom/android/server/permission/jarjar/kotlin/jvm/internal/DefaultConstructorMarker;)V

    .line 78
    .end local v3    # "$i$a$-mutateOrPut-AppIdPermissionPolicy$updatePermissionFlags$permissionFlags$1":I
    move-object v3, v5

    .line 2605
    .local v3, "it$iv":Lcom/android/server/permission/access/immutable/Immutable;
    const/4 v4, 0x0

    .line 78
    .local v4, "$i$a$-also-IntReferenceMapExtensionsKt$mutateOrPut$2$iv":I
    invoke-virtual {v0, v6, v3}, Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;->put(ILcom/android/server/permission/access/immutable/Immutable;)Lcom/android/server/permission/access/immutable/Immutable;

    .line 1764
    .end local v0    # "$this$mutateOrPut$iv":Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;
    .end local v1    # "$i$f$mutateOrPut":I
    .end local v3    # "it$iv":Lcom/android/server/permission/access/immutable/Immutable;
    .end local v4    # "$i$a$-also-IntReferenceMapExtensionsKt$mutateOrPut$2$iv":I
    :goto_0
    move-object v14, v3

    check-cast v14, Lcom/android/server/permission/access/immutable/MutableIndexedMap;

    .line 1765
    .local v14, "permissionFlags":Lcom/android/server/permission/access/immutable/MutableIndexedMap;
    invoke-static {v11}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v0

    invoke-static {v14, v8, v0, v2}, Lcom/android/server/permission/access/immutable/IndexedMapExtensionsKt;->putWithDefault(Lcom/android/server/permission/access/immutable/MutableIndexedMap;Ljava/lang/Object;Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    .line 1766
    invoke-virtual {v14}, Lcom/android/server/permission/access/immutable/IndexedMap;->isEmpty()Z

    move-result v0

    if-eqz v0, :cond_3

    .line 1767
    invoke-static {v12, v6}, Lcom/android/server/permission/access/immutable/IntReferenceMapExtensionsKt;->minusAssign(Lcom/android/server/permission/access/immutable/MutableIntReferenceMap;I)V

    .line 1769
    :cond_3
    move-object/from16 v15, p0

    iget-object v5, v15, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->onPermissionFlagsChangedListeners:Lcom/android/server/permission/access/immutable/IndexedListSet;

    .local v5, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    const/16 v16, 0x0

    .line 38
    .local v16, "$i$f$forEachIndexed":I
    const/4 v0, 0x0

    .local v0, "index$iv":I
    invoke-virtual {v5}, Lcom/android/server/permission/access/immutable/IndexedListSet;->getSize()I

    move-result v4

    move v3, v0

    .end local v0    # "index$iv":I
    .local v3, "index$iv":I
    :goto_1
    if-ge v3, v4, :cond_4

    .line 39
    invoke-virtual {v5, v3}, Lcom/android/server/permission/access/immutable/IndexedListSet;->elementAt(I)Ljava/lang/Object;

    move-result-object v0

    move-object/from16 v17, v0

    check-cast v17, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;

    .local v17, "it":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;
    const/16 v18, 0x0

    .line 1770
    .local v18, "$i$a$-forEachIndexed-AppIdPermissionPolicy$updatePermissionFlags$1":I
    move-object/from16 v0, v17

    move/from16 v1, p2

    move/from16 v2, p3

    move/from16 v19, v3

    .end local v3    # "index$iv":I
    .local v19, "index$iv":I
    move-object/from16 v3, p4

    move/from16 v20, v4

    move v4, v10

    move-object/from16 v21, v5

    .end local v5    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .local v21, "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    move v5, v11

    invoke-interface/range {v0 .. v5}, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;->onPermissionFlagsChanged(IILjava/lang/String;II)V

    .line 1771
    nop

    .line 39
    .end local v17    # "it":Lcom/android/server/permission/access/permission/AppIdPermissionPolicy$OnPermissionFlagsChangedListener;
    .end local v18    # "$i$a$-forEachIndexed-AppIdPermissionPolicy$updatePermissionFlags$1":I
    nop

    .line 38
    add-int/lit8 v3, v19, 0x1

    move/from16 v4, v20

    move-object/from16 v5, v21

    .end local v19    # "index$iv":I
    .restart local v3    # "index$iv":I
    goto :goto_1

    .end local v21    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .restart local v5    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    :cond_4
    nop

    .line 41
    .end local v3    # "index$iv":I
    nop

    .line 1772
    .end local v5    # "$this$forEachIndexed$iv":Lcom/android/server/permission/access/immutable/IndexedListSet;
    .end local v16    # "$i$f$forEachIndexed":I
    return v13
.end method

.method public upgradePackageState(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;II)V
    .locals 2
    .param p1, "$this$upgradePackageState"    # Lcom/android/server/permission/access/MutateStateScope;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p2, "packageState"    # Lcom/android/server/pm/pkg/PackageState;
        .annotation build Lorg/jetbrains/annotations/NotNull;
        .end annotation
    .end param
    .param p3, "userId"    # I
    .param p4, "version"    # I

    .line 1800
    iget-object v0, p0, Lcom/android/server/permission/access/permission/AppIdPermissionPolicy;->upgrade:Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;

    .line 2578
    .local v0, "$this$upgradePackageState_u24lambda_u2484":Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;
    const/4 v1, 0x0

    .line 1800
    .local v1, "$i$a$-with-AppIdPermissionPolicy$upgradePackageState$1":I
    invoke-virtual {v0, p1, p2, p3, p4}, Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;->upgradePackageState(Lcom/android/server/permission/access/MutateStateScope;Lcom/android/server/pm/pkg/PackageState;II)V

    .line 1801
    .end local v0    # "$this$upgradePackageState_u24lambda_u2484":Lcom/android/server/permission/access/permission/AppIdPermissionUpgrade;
    .end local v1    # "$i$a$-with-AppIdPermissionPolicy$upgradePackageState$1":I
    return-void
.end method
